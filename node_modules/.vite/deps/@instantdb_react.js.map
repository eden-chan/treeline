{
  "version": 3,
  "sources": ["../../object-hash/dist/object_hash.js", "../../@instantdb/core/src/utils/log.ts", "../../@instantdb/core/src/utils/weakHash.ts", "../../mutative/src/interface.ts", "../../mutative/src/constant.ts", "../../mutative/src/internal.ts", "../../mutative/src/utils/proto.ts", "../../mutative/src/utils/draft.ts", "../../mutative/src/utils/copy.ts", "../../mutative/src/utils/mark.ts", "../../mutative/src/utils/deepFreeze.ts", "../../mutative/src/utils/forEach.ts", "../../mutative/src/utils/finalize.ts", "../../mutative/src/patch.ts", "../../mutative/src/unsafe.ts", "../../mutative/src/map.ts", "../../mutative/src/set.ts", "../../mutative/src/draft.ts", "../../mutative/src/draftify.ts", "../../mutative/src/current.ts", "../../mutative/src/makeCreator.ts", "../../mutative/src/create.ts", "../../mutative/src/apply.ts", "../../mutative/src/original.ts", "../../mutative/src/rawReturn.ts", "../../mutative/src/utils/marker.ts", "../../mutative/src/utils/cast.ts", "../../@instantdb/core/src/utils/object.js", "../../@instantdb/core/src/store.js", "../../@instantdb/core/src/datalog.js", "../../uuid/dist/esm-browser/rng.js", "../../uuid/dist/esm-browser/regex.js", "../../uuid/dist/esm-browser/validate.js", "../../uuid/dist/esm-browser/stringify.js", "../../uuid/dist/esm-browser/parse.js", "../../uuid/dist/esm-browser/v35.js", "../../uuid/dist/esm-browser/md5.js", "../../uuid/dist/esm-browser/v3.js", "../../uuid/dist/esm-browser/native.js", "../../uuid/dist/esm-browser/v4.js", "../../uuid/dist/esm-browser/sha1.js", "../../uuid/dist/esm-browser/v5.js", "../../@instantdb/core/src/utils/uuid.ts", "../../@instantdb/core/src/instatx.ts", "../../@instantdb/core/src/instaml.js", "../../@instantdb/core/src/instaql.js", "../../@instantdb/core/src/IndexedDBStorage.js", "../../@instantdb/core/src/WindowNetworkListener.js", "../../@instantdb/core/src/utils/fetch.ts", "../../@instantdb/core/src/authAPI.js", "../../@instantdb/core/src/StorageAPI.ts", "../../@instantdb/core/src/utils/pick.js", "../../@instantdb/core/src/presence.ts", "../../@instantdb/core/src/utils/Deferred.js", "../../@instantdb/core/src/utils/PersistedObject.js", "../../@instantdb/core/src/model/instaqlResult.js", "../../@instantdb/core/src/utils/linkIndex.ts", "../../@instantdb/core/src/Reactor.js", "../../@instantdb/core/src/schemaTypes.ts", "../../@instantdb/core/src/schema.ts", "../../@instantdb/core/src/devtool.ts", "../../@instantdb/core/src/index.ts", "../../@instantdb/react/src/InstantReact.ts", "../../@instantdb/react/src/useQuery.ts", "../../@instantdb/react/src/useTimeout.ts", "../../@instantdb/react/src/InstantReactWeb.ts", "../../@instantdb/react/src/init.ts", "../../@instantdb/react/src/Cursors.tsx"],
  "sourcesContent": ["!function(e){var t;\"object\"==typeof exports?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(\"undefined\"!=typeof window?t=window:\"undefined\"!=typeof global?t=global:\"undefined\"!=typeof self&&(t=self),t.objectHash=e())}(function(){return function r(o,i,u){function s(n,e){if(!i[n]){if(!o[n]){var t=\"function\"==typeof require&&require;if(!e&&t)return t(n,!0);if(a)return a(n,!0);throw new Error(\"Cannot find module '\"+n+\"'\")}e=i[n]={exports:{}};o[n][0].call(e.exports,function(e){var t=o[n][1][e];return s(t||e)},e,e.exports,r,o,i,u)}return i[n].exports}for(var a=\"function\"==typeof require&&require,e=0;e<u.length;e++)s(u[e]);return s}({1:[function(w,b,m){!function(e,n,s,c,d,h,p,g,y){\"use strict\";var r=w(\"crypto\");function t(e,t){t=u(e,t);var n;return void 0===(n=\"passthrough\"!==t.algorithm?r.createHash(t.algorithm):new l).write&&(n.write=n.update,n.end=n.update),f(t,n).dispatch(e),n.update||n.end(\"\"),n.digest?n.digest(\"buffer\"===t.encoding?void 0:t.encoding):(e=n.read(),\"buffer\"!==t.encoding?e.toString(t.encoding):e)}(m=b.exports=t).sha1=function(e){return t(e)},m.keys=function(e){return t(e,{excludeValues:!0,algorithm:\"sha1\",encoding:\"hex\"})},m.MD5=function(e){return t(e,{algorithm:\"md5\",encoding:\"hex\"})},m.keysMD5=function(e){return t(e,{algorithm:\"md5\",encoding:\"hex\",excludeValues:!0})};var o=r.getHashes?r.getHashes().slice():[\"sha1\",\"md5\"],i=(o.push(\"passthrough\"),[\"buffer\",\"hex\",\"binary\",\"base64\"]);function u(e,t){var n={};if(n.algorithm=(t=t||{}).algorithm||\"sha1\",n.encoding=t.encoding||\"hex\",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error(\"Object argument required.\");for(var r=0;r<o.length;++r)o[r].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=o[r]);if(-1===o.indexOf(n.algorithm))throw new Error('Algorithm \"'+n.algorithm+'\"  not supported. supported values: '+o.join(\", \"));if(-1===i.indexOf(n.encoding)&&\"passthrough\"!==n.algorithm)throw new Error('Encoding \"'+n.encoding+'\"  not supported. supported values: '+i.join(\", \"));return n}function a(e){if(\"function\"==typeof e)return null!=/^function\\s+\\w*\\s*\\(\\s*\\)\\s*{\\s+\\[native code\\]\\s+}$/i.exec(Function.prototype.toString.call(e))}function f(o,t,i){i=i||[];function u(e){return t.update?t.update(e,\"utf8\"):t.write(e,\"utf8\")}return{dispatch:function(e){return this[\"_\"+(null===(e=o.replacer?o.replacer(e):e)?\"null\":typeof e)](e)},_object:function(t){var n,e=Object.prototype.toString.call(t),r=/\\[object (.*)\\]/i.exec(e);r=(r=r?r[1]:\"unknown:[\"+e+\"]\").toLowerCase();if(0<=(e=i.indexOf(t)))return this.dispatch(\"[CIRCULAR:\"+e+\"]\");if(i.push(t),void 0!==s&&s.isBuffer&&s.isBuffer(t))return u(\"buffer:\"),u(t);if(\"object\"===r||\"function\"===r||\"asyncfunction\"===r)return e=Object.keys(t),o.unorderedObjects&&(e=e.sort()),!1===o.respectType||a(t)||e.splice(0,0,\"prototype\",\"__proto__\",\"constructor\"),o.excludeKeys&&(e=e.filter(function(e){return!o.excludeKeys(e)})),u(\"object:\"+e.length+\":\"),n=this,e.forEach(function(e){n.dispatch(e),u(\":\"),o.excludeValues||n.dispatch(t[e]),u(\",\")});if(!this[\"_\"+r]){if(o.ignoreUnknown)return u(\"[\"+r+\"]\");throw new Error('Unknown object type \"'+r+'\"')}this[\"_\"+r](t)},_array:function(e,t){t=void 0!==t?t:!1!==o.unorderedArrays;var n=this;if(u(\"array:\"+e.length+\":\"),!t||e.length<=1)return e.forEach(function(e){return n.dispatch(e)});var r=[],t=e.map(function(e){var t=new l,n=i.slice();return f(o,t,n).dispatch(e),r=r.concat(n.slice(i.length)),t.read().toString()});return i=i.concat(r),t.sort(),this._array(t,!1)},_date:function(e){return u(\"date:\"+e.toJSON())},_symbol:function(e){return u(\"symbol:\"+e.toString())},_error:function(e){return u(\"error:\"+e.toString())},_boolean:function(e){return u(\"bool:\"+e.toString())},_string:function(e){u(\"string:\"+e.length+\":\"),u(e.toString())},_function:function(e){u(\"fn:\"),a(e)?this.dispatch(\"[native]\"):this.dispatch(e.toString()),!1!==o.respectFunctionNames&&this.dispatch(\"function-name:\"+String(e.name)),o.respectFunctionProperties&&this._object(e)},_number:function(e){return u(\"number:\"+e.toString())},_xml:function(e){return u(\"xml:\"+e.toString())},_null:function(){return u(\"Null\")},_undefined:function(){return u(\"Undefined\")},_regexp:function(e){return u(\"regex:\"+e.toString())},_uint8array:function(e){return u(\"uint8array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return u(\"uint8clampedarray:\"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return u(\"int8array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return u(\"uint16array:\"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return u(\"int16array:\"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return u(\"uint32array:\"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return u(\"int32array:\"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return u(\"float32array:\"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return u(\"float64array:\"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return u(\"arraybuffer:\"),this.dispatch(new Uint8Array(e))},_url:function(e){return u(\"url:\"+e.toString())},_map:function(e){u(\"map:\");e=Array.from(e);return this._array(e,!1!==o.unorderedSets)},_set:function(e){u(\"set:\");e=Array.from(e);return this._array(e,!1!==o.unorderedSets)},_file:function(e){return u(\"file:\"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(o.ignoreUnknown)return u(\"[blob]\");throw Error('Hashing Blob objects is currently not supported\\n(see https://github.com/puleos/object-hash/issues/26)\\nUse \"options.replacer\" or \"options.ignoreUnknown\"\\n')},_domwindow:function(){return u(\"domwindow\")},_bigint:function(e){return u(\"bigint:\"+e.toString())},_process:function(){return u(\"process\")},_timer:function(){return u(\"timer\")},_pipe:function(){return u(\"pipe\")},_tcp:function(){return u(\"tcp\")},_udp:function(){return u(\"udp\")},_tty:function(){return u(\"tty\")},_statwatcher:function(){return u(\"statwatcher\")},_securecontext:function(){return u(\"securecontext\")},_connection:function(){return u(\"connection\")},_zlib:function(){return u(\"zlib\")},_context:function(){return u(\"context\")},_nodescript:function(){return u(\"nodescript\")},_httpparser:function(){return u(\"httpparser\")},_dataview:function(){return u(\"dataview\")},_signal:function(){return u(\"signal\")},_fsevent:function(){return u(\"fsevent\")},_tlswrap:function(){return u(\"tlswrap\")}}}function l(){return{buf:\"\",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}m.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),f(t=u(e,t),n).dispatch(e)}}.call(this,w(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},w(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/fake_9a5aa49d.js\",\"/\")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,f){!function(e,t,n,r,o,i,u,s,a){!function(e){\"use strict\";var a=\"undefined\"!=typeof Uint8Array?Uint8Array:Array,t=\"+\".charCodeAt(0),n=\"/\".charCodeAt(0),r=\"0\".charCodeAt(0),o=\"a\".charCodeAt(0),i=\"A\".charCodeAt(0),u=\"-\".charCodeAt(0),s=\"_\".charCodeAt(0);function f(e){e=e.charCodeAt(0);return e===t||e===u?62:e===n||e===s?63:e<r?-1:e<r+10?e-r+26+26:e<i+26?e-i:e<o+26?e-o+26:void 0}e.toByteArray=function(e){var t,n;if(0<e.length%4)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.length,r=\"=\"===e.charAt(r-2)?2:\"=\"===e.charAt(r-1)?1:0,o=new a(3*e.length/4-r),i=0<r?e.length-4:e.length,u=0;function s(e){o[u++]=e}for(t=0;t<i;t+=4,0)s((16711680&(n=f(e.charAt(t))<<18|f(e.charAt(t+1))<<12|f(e.charAt(t+2))<<6|f(e.charAt(t+3))))>>16),s((65280&n)>>8),s(255&n);return 2==r?s(255&(n=f(e.charAt(t))<<2|f(e.charAt(t+1))>>4)):1==r&&(s((n=f(e.charAt(t))<<10|f(e.charAt(t+1))<<4|f(e.charAt(t+2))>>2)>>8&255),s(255&n)),o},e.fromByteArray=function(e){var t,n,r,o,i=e.length%3,u=\"\";function s(e){return\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt(e)}for(t=0,r=e.length-i;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],u+=s((o=n)>>18&63)+s(o>>12&63)+s(o>>6&63)+s(63&o);switch(i){case 1:u=(u+=s((n=e[e.length-1])>>2))+s(n<<4&63)+\"==\";break;case 2:u=(u=(u+=s((n=(e[e.length-2]<<8)+e[e.length-1])>>10))+s(n>>4&63))+s(n<<2&63)+\"=\"}return u}}(void 0===f?this.base64js={}:f)}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js\",\"/node_modules/gulp-browserify/node_modules/base64-js/lib\")},{buffer:3,lYpoI2:11}],3:[function(O,e,H){!function(e,n,f,r,h,p,g,y,w){var a=O(\"base64-js\"),i=O(\"ieee754\");function f(e,t,n){if(!(this instanceof f))return new f(e,t,n);var r,o,i,u,s=typeof e;if(\"base64\"===t&&\"string\"==s)for(e=(u=e).trim?u.trim():u.replace(/^\\s+|\\s+$/g,\"\");e.length%4!=0;)e+=\"=\";if(\"number\"==s)r=j(e);else if(\"string\"==s)r=f.byteLength(e,t);else{if(\"object\"!=s)throw new Error(\"First argument needs to be a number, array or string.\");r=j(e.length)}if(f._useTypedArrays?o=f._augment(new Uint8Array(r)):((o=this).length=r,o._isBuffer=!0),f._useTypedArrays&&\"number\"==typeof e.byteLength)o._set(e);else if(C(u=e)||f.isBuffer(u)||u&&\"object\"==typeof u&&\"number\"==typeof u.length)for(i=0;i<r;i++)f.isBuffer(e)?o[i]=e.readUInt8(i):o[i]=e[i];else if(\"string\"==s)o.write(e,0,t);else if(\"number\"==s&&!f._useTypedArrays&&!n)for(i=0;i<r;i++)o[i]=0;return o}function b(e,t,n,r){return f._charsWritten=c(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return f._charsWritten=c(function(e){for(var t,n,r=[],o=0;o<e.length;o++)n=e.charCodeAt(o),t=n>>8,n=n%256,r.push(n),r.push(t);return r}(t),e,n,r)}function v(e,t,n){var r=\"\";n=Math.min(e.length,n);for(var o=t;o<n;o++)r+=String.fromCharCode(e[o]);return r}function o(e,t,n,r){r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+1<e.length,\"Trying to read beyond buffer length\"));var o,r=e.length;if(!(r<=t))return n?(o=e[t],t+1<r&&(o|=e[t+1]<<8)):(o=e[t]<<8,t+1<r&&(o|=e[t+1])),o}function u(e,t,n,r){r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+3<e.length,\"Trying to read beyond buffer length\"));var o,r=e.length;if(!(r<=t))return n?(t+2<r&&(o=e[t+2]<<16),t+1<r&&(o|=e[t+1]<<8),o|=e[t],t+3<r&&(o+=e[t+3]<<24>>>0)):(t+1<r&&(o=e[t+1]<<16),t+2<r&&(o|=e[t+2]<<8),t+3<r&&(o|=e[t+3]),o+=e[t]<<24>>>0),o}function _(e,t,n,r){if(r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+1<e.length,\"Trying to read beyond buffer length\")),!(e.length<=t))return r=o(e,t,n,!0),32768&r?-1*(65535-r+1):r}function E(e,t,n,r){if(r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(null!=t,\"missing offset\"),d(t+3<e.length,\"Trying to read beyond buffer length\")),!(e.length<=t))return r=u(e,t,n,!0),2147483648&r?-1*(4294967295-r+1):r}function I(e,t,n,r){return r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(t+3<e.length,\"Trying to read beyond buffer length\")),i.read(e,t,n,23,4)}function A(e,t,n,r){return r||(d(\"boolean\"==typeof n,\"missing or invalid endian\"),d(t+7<e.length,\"Trying to read beyond buffer length\")),i.read(e,t,n,52,8)}function s(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+1<e.length,\"trying to write beyond buffer length\"),Y(t,65535));o=e.length;if(!(o<=n))for(var i=0,u=Math.min(o-n,2);i<u;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function l(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"trying to write beyond buffer length\"),Y(t,4294967295));o=e.length;if(!(o<=n))for(var i=0,u=Math.min(o-n,4);i<u;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function B(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+1<e.length,\"Trying to write beyond buffer length\"),F(t,32767,-32768)),e.length<=n||s(e,0<=t?t:65535+t+1,n,r,o)}function L(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"Trying to write beyond buffer length\"),F(t,2147483647,-2147483648)),e.length<=n||l(e,0<=t?t:4294967295+t+1,n,r,o)}function U(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+3<e.length,\"Trying to write beyond buffer length\"),D(t,34028234663852886e22,-34028234663852886e22)),e.length<=n||i.write(e,t,n,r,23,4)}function x(e,t,n,r,o){o||(d(null!=t,\"missing value\"),d(\"boolean\"==typeof r,\"missing or invalid endian\"),d(null!=n,\"missing offset\"),d(n+7<e.length,\"Trying to write beyond buffer length\"),D(t,17976931348623157e292,-17976931348623157e292)),e.length<=n||i.write(e,t,n,r,52,8)}H.Buffer=f,H.SlowBuffer=f,H.INSPECT_MAX_BYTES=50,f.poolSize=8192,f._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&\"function\"==typeof t.subarray}catch(e){return!1}}(),f.isEncoding=function(e){switch(String(e).toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"binary\":case\"base64\":case\"raw\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},f.isBuffer=function(e){return!(null==e||!e._isBuffer)},f.byteLength=function(e,t){var n;switch(e+=\"\",t||\"utf8\"){case\"hex\":n=e.length/2;break;case\"utf8\":case\"utf-8\":n=T(e).length;break;case\"ascii\":case\"binary\":case\"raw\":n=e.length;break;case\"base64\":n=M(e).length;break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":n=2*e.length;break;default:throw new Error(\"Unknown encoding\")}return n},f.concat=function(e,t){if(d(C(e),\"Usage: Buffer.concat(list, [totalLength])\\nlist should be an Array.\"),0===e.length)return new f(0);if(1===e.length)return e[0];if(\"number\"!=typeof t)for(o=t=0;o<e.length;o++)t+=e[o].length;for(var n=new f(t),r=0,o=0;o<e.length;o++){var i=e[o];i.copy(n,r),r+=i.length}return n},f.prototype.write=function(e,t,n,r){isFinite(t)?isFinite(n)||(r=n,n=void 0):(a=r,r=t,t=n,n=a),t=Number(t)||0;var o,i,u,s,a=this.length-t;switch((!n||a<(n=Number(n)))&&(n=a),r=String(r||\"utf8\").toLowerCase()){case\"hex\":o=function(e,t,n,r){n=Number(n)||0;var o=e.length-n;(!r||o<(r=Number(r)))&&(r=o),d((o=t.length)%2==0,\"Invalid hex string\"),o/2<r&&(r=o/2);for(var i=0;i<r;i++){var u=parseInt(t.substr(2*i,2),16);d(!isNaN(u),\"Invalid hex string\"),e[n+i]=u}return f._charsWritten=2*i,i}(this,e,t,n);break;case\"utf8\":case\"utf-8\":i=this,u=t,s=n,o=f._charsWritten=c(T(e),i,u,s);break;case\"ascii\":case\"binary\":o=b(this,e,t,n);break;case\"base64\":i=this,u=t,s=n,o=f._charsWritten=c(M(e),i,u,s);break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":o=m(this,e,t,n);break;default:throw new Error(\"Unknown encoding\")}return o},f.prototype.toString=function(e,t,n){var r,o,i,u,s=this;if(e=String(e||\"utf8\").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):s.length)===t)return\"\";switch(e){case\"hex\":r=function(e,t,n){var r=e.length;(!t||t<0)&&(t=0);(!n||n<0||r<n)&&(n=r);for(var o=\"\",i=t;i<n;i++)o+=k(e[i]);return o}(s,t,n);break;case\"utf8\":case\"utf-8\":r=function(e,t,n){var r=\"\",o=\"\";n=Math.min(e.length,n);for(var i=t;i<n;i++)e[i]<=127?(r+=N(o)+String.fromCharCode(e[i]),o=\"\"):o+=\"%\"+e[i].toString(16);return r+N(o)}(s,t,n);break;case\"ascii\":case\"binary\":r=v(s,t,n);break;case\"base64\":o=s,u=n,r=0===(i=t)&&u===o.length?a.fromByteArray(o):a.fromByteArray(o.slice(i,u));break;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":r=function(e,t,n){for(var r=e.slice(t,n),o=\"\",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(s,t,n);break;default:throw new Error(\"Unknown encoding\")}return r},f.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.copy=function(e,t,n,r){if(t=t||0,(r=r||0===r?r:this.length)!==(n=n||0)&&0!==e.length&&0!==this.length){d(n<=r,\"sourceEnd < sourceStart\"),d(0<=t&&t<e.length,\"targetStart out of bounds\"),d(0<=n&&n<this.length,\"sourceStart out of bounds\"),d(0<=r&&r<=this.length,\"sourceEnd out of bounds\"),r>this.length&&(r=this.length);var o=(r=e.length-t<r-n?e.length-t+n:r)-n;if(o<100||!f._useTypedArrays)for(var i=0;i<o;i++)e[i+t]=this[i+n];else e._set(this.subarray(n,n+o),t)}},f.prototype.slice=function(e,t){var n=this.length;if(e=S(e,n,0),t=S(t,n,n),f._useTypedArrays)return f._augment(this.subarray(e,t));for(var r=t-e,o=new f(r,void 0,!0),i=0;i<r;i++)o[i]=this[i+e];return o},f.prototype.get=function(e){return console.log(\".get() is deprecated. Access using array indexes instead.\"),this.readUInt8(e)},f.prototype.set=function(e,t){return console.log(\".set() is deprecated. Access using array indexes instead.\"),this.writeUInt8(e,t)},f.prototype.readUInt8=function(e,t){if(t||(d(null!=e,\"missing offset\"),d(e<this.length,\"Trying to read beyond buffer length\")),!(e>=this.length))return this[e]},f.prototype.readUInt16LE=function(e,t){return o(this,e,!0,t)},f.prototype.readUInt16BE=function(e,t){return o(this,e,!1,t)},f.prototype.readUInt32LE=function(e,t){return u(this,e,!0,t)},f.prototype.readUInt32BE=function(e,t){return u(this,e,!1,t)},f.prototype.readInt8=function(e,t){if(t||(d(null!=e,\"missing offset\"),d(e<this.length,\"Trying to read beyond buffer length\")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){return _(this,e,!0,t)},f.prototype.readInt16BE=function(e,t){return _(this,e,!1,t)},f.prototype.readInt32LE=function(e,t){return E(this,e,!0,t)},f.prototype.readInt32BE=function(e,t){return E(this,e,!1,t)},f.prototype.readFloatLE=function(e,t){return I(this,e,!0,t)},f.prototype.readFloatBE=function(e,t){return I(this,e,!1,t)},f.prototype.readDoubleLE=function(e,t){return A(this,e,!0,t)},f.prototype.readDoubleBE=function(e,t){return A(this,e,!1,t)},f.prototype.writeUInt8=function(e,t,n){n||(d(null!=e,\"missing value\"),d(null!=t,\"missing offset\"),d(t<this.length,\"trying to write beyond buffer length\"),Y(e,255)),t>=this.length||(this[t]=e)},f.prototype.writeUInt16LE=function(e,t,n){s(this,e,t,!0,n)},f.prototype.writeUInt16BE=function(e,t,n){s(this,e,t,!1,n)},f.prototype.writeUInt32LE=function(e,t,n){l(this,e,t,!0,n)},f.prototype.writeUInt32BE=function(e,t,n){l(this,e,t,!1,n)},f.prototype.writeInt8=function(e,t,n){n||(d(null!=e,\"missing value\"),d(null!=t,\"missing offset\"),d(t<this.length,\"Trying to write beyond buffer length\"),F(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},f.prototype.writeInt16LE=function(e,t,n){B(this,e,t,!0,n)},f.prototype.writeInt16BE=function(e,t,n){B(this,e,t,!1,n)},f.prototype.writeInt32LE=function(e,t,n){L(this,e,t,!0,n)},f.prototype.writeInt32BE=function(e,t,n){L(this,e,t,!1,n)},f.prototype.writeFloatLE=function(e,t,n){U(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){U(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){x(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){x(this,e,t,!1,n)},f.prototype.fill=function(e,t,n){if(t=t||0,n=n||this.length,d(\"number\"==typeof(e=\"string\"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),\"value is not a number\"),d(t<=n,\"end < start\"),n!==t&&0!==this.length){d(0<=t&&t<this.length,\"start out of bounds\"),d(0<=n&&n<=this.length,\"end out of bounds\");for(var r=t;r<n;r++)this[r]=e}},f.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=k(this[n]),n===H.INSPECT_MAX_BYTES){e[n+1]=\"...\";break}return\"<Buffer \"+e.join(\" \")+\">\"},f.prototype.toArrayBuffer=function(){if(\"undefined\"==typeof Uint8Array)throw new Error(\"Buffer.toArrayBuffer not supported in this browser\");if(f._useTypedArrays)return new f(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var t=f.prototype;function S(e,t,n){return\"number\"!=typeof e?n:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function j(e){return(e=~~Math.ceil(+e))<0?0:e}function C(e){return(Array.isArray||function(e){return\"[object Array]\"===Object.prototype.toString.call(e)})(e)}function k(e){return e<16?\"0\"+e.toString(16):e.toString(16)}function T(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else for(var o=n,i=(55296<=r&&r<=57343&&n++,encodeURIComponent(e.slice(o,n+1)).substr(1).split(\"%\")),u=0;u<i.length;u++)t.push(parseInt(i[u],16))}return t}function M(e){return a.toByteArray(e)}function c(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}function N(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function Y(e,t){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(0<=e,\"specified a negative value for writing an unsigned value\"),d(e<=t,\"value is larger than maximum value for type\"),d(Math.floor(e)===e,\"value has a fractional component\")}function F(e,t,n){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(e<=t,\"value larger than maximum allowed value\"),d(n<=e,\"value smaller than minimum allowed value\"),d(Math.floor(e)===e,\"value has a fractional component\")}function D(e,t,n){d(\"number\"==typeof e,\"cannot write a non-number as a number\"),d(e<=t,\"value larger than maximum allowed value\"),d(n<=e,\"value smaller than minimum allowed value\")}function d(e,t){if(!e)throw new Error(t||\"Failed assertion\")}f._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=t.get,e.set=t.set,e.write=t.write,e.toString=t.toString,e.toLocaleString=t.toString,e.toJSON=t.toJSON,e.copy=t.copy,e.slice=t.slice,e.readUInt8=t.readUInt8,e.readUInt16LE=t.readUInt16LE,e.readUInt16BE=t.readUInt16BE,e.readUInt32LE=t.readUInt32LE,e.readUInt32BE=t.readUInt32BE,e.readInt8=t.readInt8,e.readInt16LE=t.readInt16LE,e.readInt16BE=t.readInt16BE,e.readInt32LE=t.readInt32LE,e.readInt32BE=t.readInt32BE,e.readFloatLE=t.readFloatLE,e.readFloatBE=t.readFloatBE,e.readDoubleLE=t.readDoubleLE,e.readDoubleBE=t.readDoubleBE,e.writeUInt8=t.writeUInt8,e.writeUInt16LE=t.writeUInt16LE,e.writeUInt16BE=t.writeUInt16BE,e.writeUInt32LE=t.writeUInt32LE,e.writeUInt32BE=t.writeUInt32BE,e.writeInt8=t.writeInt8,e.writeInt16LE=t.writeInt16LE,e.writeInt16BE=t.writeInt16BE,e.writeInt32LE=t.writeInt32LE,e.writeInt32BE=t.writeInt32BE,e.writeFloatLE=t.writeFloatLE,e.writeFloatBE=t.writeFloatBE,e.writeDoubleLE=t.writeDoubleLE,e.writeDoubleBE=t.writeDoubleBE,e.fill=t.fill,e.inspect=t.inspect,e.toArrayBuffer=t.toArrayBuffer,e}}.call(this,O(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},O(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/buffer/index.js\",\"/node_modules/gulp-browserify/node_modules/buffer\")},{\"base64-js\":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(c,d,e){!function(e,t,a,n,r,o,i,u,s){var a=c(\"buffer\").Buffer,f=4,l=new a(f);l.fill(0);d.exports={hash:function(e,t,n,r){for(var o=t(function(e,t){e.length%f!=0&&(n=e.length+(f-e.length%f),e=a.concat([e,l],n));for(var n,r=[],o=t?e.readInt32BE:e.readInt32LE,i=0;i<e.length;i+=f)r.push(o.call(e,i));return r}(e=a.isBuffer(e)?e:new a(e),r),8*e.length),t=r,i=new a(n),u=t?i.writeInt32BE:i.writeInt32LE,s=0;s<o.length;s++)u.call(i,o[s],4*s,!0);return i}}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{buffer:3,lYpoI2:11}],5:[function(v,e,_){!function(l,c,u,d,h,p,g,y,w){var u=v(\"buffer\").Buffer,e=v(\"./sha\"),t=v(\"./sha256\"),n=v(\"./rng\"),b={sha1:e,sha256:t,md5:v(\"./md5\")},s=64,a=new u(s);function r(e,n){var r=b[e=e||\"sha1\"],o=[];return r||i(\"algorithm:\",e,\"is not yet supported\"),{update:function(e){return u.isBuffer(e)||(e=new u(e)),o.push(e),e.length,this},digest:function(e){var t=u.concat(o),t=n?function(e,t,n){u.isBuffer(t)||(t=new u(t)),u.isBuffer(n)||(n=new u(n)),t.length>s?t=e(t):t.length<s&&(t=u.concat([t,a],s));for(var r=new u(s),o=new u(s),i=0;i<s;i++)r[i]=54^t[i],o[i]=92^t[i];return n=e(u.concat([r,n])),e(u.concat([o,n]))}(r,n,t):r(t);return o=null,e?t.toString(e):t}}}function i(){var e=[].slice.call(arguments).join(\" \");throw new Error([e,\"we accept pull requests\",\"http://github.com/dominictarr/crypto-browserify\"].join(\"\\n\"))}a.fill(0),_.createHash=function(e){return r(e)},_.createHmac=r,_.randomBytes=function(e,t){if(!t||!t.call)return new u(n(e));try{t.call(this,void 0,new u(n(e)))}catch(e){t(e)}};var o,f=[\"createCredentials\",\"createCipher\",\"createCipheriv\",\"createDecipher\",\"createDecipheriv\",\"createSign\",\"createVerify\",\"createDiffieHellman\",\"pbkdf2\"],m=function(e){_[e]=function(){i(\"sorry,\",e,\"is not implemented yet\")}};for(o in f)m(f[o],o)}.call(this,v(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},v(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./md5\":6,\"./rng\":7,\"./sha\":8,\"./sha256\":9,buffer:3,lYpoI2:11}],6:[function(w,b,e){!function(e,r,o,i,u,a,f,l,y){var t=w(\"./helpers\");function n(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,u=0;u<e.length;u+=16){var s=n,a=r,f=o,l=i,n=c(n,r,o,i,e[u+0],7,-680876936),i=c(i,n,r,o,e[u+1],12,-389564586),o=c(o,i,n,r,e[u+2],17,606105819),r=c(r,o,i,n,e[u+3],22,-1044525330);n=c(n,r,o,i,e[u+4],7,-176418897),i=c(i,n,r,o,e[u+5],12,1200080426),o=c(o,i,n,r,e[u+6],17,-1473231341),r=c(r,o,i,n,e[u+7],22,-45705983),n=c(n,r,o,i,e[u+8],7,1770035416),i=c(i,n,r,o,e[u+9],12,-1958414417),o=c(o,i,n,r,e[u+10],17,-42063),r=c(r,o,i,n,e[u+11],22,-1990404162),n=c(n,r,o,i,e[u+12],7,1804603682),i=c(i,n,r,o,e[u+13],12,-40341101),o=c(o,i,n,r,e[u+14],17,-1502002290),n=d(n,r=c(r,o,i,n,e[u+15],22,1236535329),o,i,e[u+1],5,-165796510),i=d(i,n,r,o,e[u+6],9,-1069501632),o=d(o,i,n,r,e[u+11],14,643717713),r=d(r,o,i,n,e[u+0],20,-373897302),n=d(n,r,o,i,e[u+5],5,-701558691),i=d(i,n,r,o,e[u+10],9,38016083),o=d(o,i,n,r,e[u+15],14,-660478335),r=d(r,o,i,n,e[u+4],20,-405537848),n=d(n,r,o,i,e[u+9],5,568446438),i=d(i,n,r,o,e[u+14],9,-1019803690),o=d(o,i,n,r,e[u+3],14,-187363961),r=d(r,o,i,n,e[u+8],20,1163531501),n=d(n,r,o,i,e[u+13],5,-1444681467),i=d(i,n,r,o,e[u+2],9,-51403784),o=d(o,i,n,r,e[u+7],14,1735328473),n=h(n,r=d(r,o,i,n,e[u+12],20,-1926607734),o,i,e[u+5],4,-378558),i=h(i,n,r,o,e[u+8],11,-2022574463),o=h(o,i,n,r,e[u+11],16,1839030562),r=h(r,o,i,n,e[u+14],23,-35309556),n=h(n,r,o,i,e[u+1],4,-1530992060),i=h(i,n,r,o,e[u+4],11,1272893353),o=h(o,i,n,r,e[u+7],16,-155497632),r=h(r,o,i,n,e[u+10],23,-1094730640),n=h(n,r,o,i,e[u+13],4,681279174),i=h(i,n,r,o,e[u+0],11,-358537222),o=h(o,i,n,r,e[u+3],16,-722521979),r=h(r,o,i,n,e[u+6],23,76029189),n=h(n,r,o,i,e[u+9],4,-640364487),i=h(i,n,r,o,e[u+12],11,-421815835),o=h(o,i,n,r,e[u+15],16,530742520),n=p(n,r=h(r,o,i,n,e[u+2],23,-995338651),o,i,e[u+0],6,-198630844),i=p(i,n,r,o,e[u+7],10,1126891415),o=p(o,i,n,r,e[u+14],15,-1416354905),r=p(r,o,i,n,e[u+5],21,-57434055),n=p(n,r,o,i,e[u+12],6,1700485571),i=p(i,n,r,o,e[u+3],10,-1894986606),o=p(o,i,n,r,e[u+10],15,-1051523),r=p(r,o,i,n,e[u+1],21,-2054922799),n=p(n,r,o,i,e[u+8],6,1873313359),i=p(i,n,r,o,e[u+15],10,-30611744),o=p(o,i,n,r,e[u+6],15,-1560198380),r=p(r,o,i,n,e[u+13],21,1309151649),n=p(n,r,o,i,e[u+4],6,-145523070),i=p(i,n,r,o,e[u+11],10,-1120210379),o=p(o,i,n,r,e[u+2],15,718787259),r=p(r,o,i,n,e[u+9],21,-343485551),n=g(n,s),r=g(r,a),o=g(o,f),i=g(i,l)}return Array(n,r,o,i)}function s(e,t,n,r,o,i){return g((t=g(g(t,e),g(r,i)))<<o|t>>>32-o,n)}function c(e,t,n,r,o,i,u){return s(t&n|~t&r,e,t,o,i,u)}function d(e,t,n,r,o,i,u){return s(t&r|n&~r,e,t,o,i,u)}function h(e,t,n,r,o,i,u){return s(t^n^r,e,t,o,i,u)}function p(e,t,n,r,o,i,u){return s(n^(t|~r),e,t,o,i,u)}function g(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}b.exports=function(e){return t.hash(e,n,16)}}.call(this,w(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},w(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],7:[function(e,l,t){!function(e,t,n,r,o,i,u,s,f){var a;l.exports=a||function(e){for(var t,n=new Array(e),r=0;r<e;r++)0==(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{buffer:3,lYpoI2:11}],8:[function(c,d,e){!function(e,t,n,r,o,s,a,f,l){var i=c(\"./helpers\");function u(l,c){l[c>>5]|=128<<24-c%32,l[15+(c+64>>9<<4)]=c;for(var e,t,n,r=Array(80),o=1732584193,i=-271733879,u=-1732584194,s=271733878,d=-1009589776,h=0;h<l.length;h+=16){for(var p=o,g=i,y=u,w=s,b=d,a=0;a<80;a++){r[a]=a<16?l[h+a]:v(r[a-3]^r[a-8]^r[a-14]^r[a-16],1);var f=m(m(v(o,5),(f=i,t=u,n=s,(e=a)<20?f&t|~f&n:!(e<40)&&e<60?f&t|f&n|t&n:f^t^n)),m(m(d,r[a]),(e=a)<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514)),d=s,s=u,u=v(i,30),i=o,o=f}o=m(o,p),i=m(i,g),u=m(u,y),s=m(s,w),d=m(d,b)}return Array(o,i,u,s,d)}function m(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function v(e,t){return e<<t|e>>>32-t}d.exports=function(e){return i.hash(e,u,20,!0)}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],9:[function(c,d,e){!function(e,t,n,r,u,s,a,f,l){function b(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,l){var c,d=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),t=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),n=new Array(64);e[l>>5]|=128<<24-l%32,e[15+(l+64>>9<<4)]=l;for(var r,o,h=0;h<e.length;h+=16){for(var i=t[0],u=t[1],s=t[2],p=t[3],a=t[4],g=t[5],y=t[6],w=t[7],f=0;f<64;f++)n[f]=f<16?e[f+h]:b(b(b((o=n[f-2],m(o,17)^m(o,19)^v(o,10)),n[f-7]),(o=n[f-15],m(o,7)^m(o,18)^v(o,3))),n[f-16]),c=b(b(b(b(w,m(o=a,6)^m(o,11)^m(o,25)),a&g^~a&y),d[f]),n[f]),r=b(m(r=i,2)^m(r,13)^m(r,22),i&u^i&s^u&s),w=y,y=g,g=a,a=b(p,c),p=s,s=u,u=i,i=b(c,r);t[0]=b(i,t[0]),t[1]=b(u,t[1]),t[2]=b(s,t[2]),t[3]=b(p,t[3]),t[4]=b(a,t[4]),t[5]=b(g,t[5]),t[6]=b(y,t[6]),t[7]=b(w,t[7])}return t}var i=c(\"./helpers\"),m=function(e,t){return e>>>t|e<<32-t},v=function(e,t){return e>>>t};d.exports=function(e){return i.hash(e,o,32,!0)}}.call(this,c(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},c(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js\",\"/node_modules/gulp-browserify/node_modules/crypto-browserify\")},{\"./helpers\":4,buffer:3,lYpoI2:11}],10:[function(e,t,f){!function(e,t,n,r,o,i,u,s,a){f.read=function(e,t,n,r,o){var i,u,l=8*o-r-1,c=(1<<l)-1,d=c>>1,s=-7,a=n?o-1:0,f=n?-1:1,o=e[t+a];for(a+=f,i=o&(1<<-s)-1,o>>=-s,s+=l;0<s;i=256*i+e[t+a],a+=f,s-=8);for(u=i&(1<<-s)-1,i>>=-s,s+=r;0<s;u=256*u+e[t+a],a+=f,s-=8);if(0===i)i=1-d;else{if(i===c)return u?NaN:1/0*(o?-1:1);u+=Math.pow(2,r),i-=d}return(o?-1:1)*u*Math.pow(2,i-r)},f.write=function(e,t,l,n,r,c){var o,i,u=8*c-r-1,s=(1<<u)-1,a=s>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:c-1,h=n?1:-1,c=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(i=isNaN(t)?1:0,o=s):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+a?d/n:d*Math.pow(2,1-a))*n&&(o++,n/=2),s<=o+a?(i=0,o=s):1<=o+a?(i=(t*n-1)*Math.pow(2,r),o+=a):(i=t*Math.pow(2,a-1)*Math.pow(2,r),o=0));8<=r;e[l+f]=255&i,f+=h,i/=256,r-=8);for(o=o<<r|i,u+=r;0<u;e[l+f]=255&o,f+=h,o/=256,u-=8);e[l+f-h]|=128*c}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/ieee754/index.js\",\"/node_modules/gulp-browserify/node_modules/ieee754\")},{buffer:3,lYpoI2:11}],11:[function(e,h,t){!function(e,t,n,r,o,f,l,c,d){var i,u,s;function a(){}(e=h.exports={}).nextTick=(u=\"undefined\"!=typeof window&&window.setImmediate,s=\"undefined\"!=typeof window&&window.postMessage&&window.addEventListener,u?function(e){return window.setImmediate(e)}:s?(i=[],window.addEventListener(\"message\",function(e){var t=e.source;t!==window&&null!==t||\"process-tick\"!==e.data||(e.stopPropagation(),0<i.length&&i.shift()())},!0),function(e){i.push(e),window.postMessage(\"process-tick\",\"*\")}):function(e){setTimeout(e,0)}),e.title=\"browser\",e.browser=!0,e.env={},e.argv=[],e.on=a,e.addListener=a,e.once=a,e.off=a,e.removeListener=a,e.removeAllListeners=a,e.emit=a,e.binding=function(e){throw new Error(\"process.binding is not supported\")},e.cwd=function(){return\"/\"},e.chdir=function(e){throw new Error(\"process.chdir is not supported\")}}.call(this,e(\"lYpoI2\"),\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{},e(\"buffer\").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],\"/node_modules/gulp-browserify/node_modules/process/browser.js\",\"/node_modules/gulp-browserify/node_modules/process\")},{buffer:3,lYpoI2:11}]},{},[1])(1)});", "const log = (() => {\n  let isEnabled = false;\n  if (\n    typeof window !== \"undefined\" &&\n    typeof window.localStorage !== \"undefined\"\n  ) {\n    isEnabled = !!window.localStorage.getItem(\"loggingEnabled\");\n  } else {\n    isEnabled = false;\n  }\n  function makeLogger(fnName: \"info\" | \"debug\" | \"error\") {\n    return (...args: any[]) => {\n      if (!isEnabled) return;\n      console[fnName](...args);\n    };\n  }\n  return {\n    info: makeLogger(\"info\"),\n    debug: makeLogger(\"debug\"),\n    error: makeLogger(\"error\"),\n  };\n})();\n\nexport default log;\n", "/**\n * Wrapper for a fast hash function, where we want consistent, unique hashing\n * and are not concerned with the hash being decoded\n * */\nimport { MD5 } from \"object-hash\";\n\nconst weakHash = MD5;\n\nexport default weakHash;\n", "import { dataTypes } from './constant';\n\nexport const enum DraftType {\n  Object,\n  Array,\n  Map,\n  Set,\n}\n\nexport const Operation = {\n  Remove: 'remove',\n  Replace: 'replace',\n  Add: 'add',\n} as const;\n\nexport type DataType = keyof typeof dataTypes;\n\nexport type PatchesOptions =\n  | boolean\n  | {\n      /**\n       * The default value is `true`. If it's `true`, the path will be an array, otherwise it is a string.\n       */\n      pathAsArray?: boolean;\n      /**\n       * The default value is `true`. If it's `true`, the array length will be included in the patches, otherwise no include array length.\n       */\n      arrayLengthAssignment?: boolean;\n    };\n\nexport interface Finalities {\n  draft: ((patches?: Patches, inversePatches?: Patches) => void)[];\n  revoke: (() => void)[];\n  handledSet: WeakSet<any>;\n}\n\nexport interface ProxyDraft<T = any> {\n  type: DraftType;\n  operated?: boolean;\n  finalized: boolean;\n  original: T;\n  copy: T | null;\n  proxy: T | null;\n  finalities: Finalities;\n  options: Options<any, any> & { updatedValues?: WeakMap<any, any> };\n  parent?: ProxyDraft | null;\n  key?: string | number | symbol;\n  setMap?: Map<any, ProxyDraft>;\n  assignedMap?: Map<any, boolean>;\n  callbacks?: ((patches?: Patches, inversePatches?: Patches) => void)[];\n}\n\ninterface IPatch {\n  op: (typeof Operation)[keyof typeof Operation];\n  value?: any;\n}\n\nexport type Patch<P extends PatchesOptions = any> = P extends {\n  pathAsArray: false;\n}\n  ? IPatch & {\n      path: string;\n    }\n  : P extends true | object\n  ? IPatch & {\n      path: (string | number)[];\n    }\n  : IPatch & {\n      path: string | (string | number)[];\n    };\n\nexport type Patches<P extends PatchesOptions = any> = Patch<P>[];\n\nexport type Result<\n  T extends any,\n  O extends PatchesOptions,\n  F extends boolean\n> = O extends true | object\n  ? [F extends true ? Immutable<T> : T, Patches<O>, Patches<O>]\n  : F extends true\n  ? Immutable<T>\n  : T;\n\nexport type CreateResult<\n  T extends any,\n  O extends PatchesOptions,\n  F extends boolean,\n  R extends void | Promise<void> | T | Promise<T>\n> = R extends Promise<void> | Promise<T>\n  ? Promise<Result<T, O, F>>\n  : Result<T, O, F>;\n\ntype BaseMark = null | undefined | DataType;\ntype MarkWithCopy = BaseMark | (() => any);\n\nexport type Mark<O extends PatchesOptions, F extends boolean> = (\n  target: any,\n  types: typeof dataTypes\n) => O extends true | object\n  ? BaseMark\n  : F extends true\n  ? BaseMark\n  : MarkWithCopy;\n\nexport interface Options<O extends PatchesOptions, F extends boolean> {\n  /**\n   * In strict mode, Forbid accessing non-draftable values and forbid returning a non-draft value.\n   */\n  strict?: boolean;\n  /**\n   * Enable patch, and return the patches and inversePatches.\n   */\n  enablePatches?: O;\n  /**\n   * Enable autoFreeze, and return frozen state.\n   */\n  enableAutoFreeze?: F;\n  /**\n   * Set a mark to determine if the object is mutable or if an instance is an immutable.\n   * And it can also return a shallow copy function(AutoFreeze and Patches should both be disabled).\n   */\n  mark?: Mark<O, F>;\n}\n\nexport interface ExternalOptions<O extends PatchesOptions, F extends boolean> {\n  /**\n   * In strict mode, Forbid accessing non-draftable values and forbid returning a non-draft value.\n   */\n  strict?: boolean;\n  /**\n   * Enable patch, and return the patches and inversePatches.\n   */\n  enablePatches?: O;\n  /**\n   * Enable autoFreeze, and return frozen state.\n   */\n  enableAutoFreeze?: F;\n  /**\n   * Set a mark to determine if the object is mutable or if an instance is an immutable.\n   * And it can also return a shallow copy function(AutoFreeze and Patches should both be disabled).\n   */\n  mark?: Mark<O, F>[] | Mark<O, F>;\n}\n\n// Exclude `symbol`\ntype Primitive = string | number | bigint | boolean | null | undefined;\n\ntype ImmutableMap<K, V> = ReadonlyMap<Immutable<K>, Immutable<V>>;\ntype ImmutableSet<T> = ReadonlySet<Immutable<T>>;\ntype ImmutableObject<T> = { readonly [K in keyof T]: Immutable<T[K]> };\n\nexport type IfAvailable<T, Fallback = void> = true | false extends (\n  T extends never ? true : false\n)\n  ? Fallback\n  : keyof T extends never\n  ? Fallback\n  : T;\ntype WeakReferences =\n  | IfAvailable<WeakMap<any, any>>\n  | IfAvailable<WeakSet<any>>;\ntype AtomicObject = Function | Promise<any> | Date | RegExp;\n\nexport type Immutable<T> = T extends Primitive | AtomicObject\n  ? T\n  : T extends IfAvailable<ReadonlyMap<infer K, infer V>>\n  ? ImmutableMap<K, V>\n  : T extends IfAvailable<ReadonlySet<infer V>>\n  ? ImmutableSet<V>\n  : T extends WeakReferences\n  ? T\n  : T extends object\n  ? ImmutableObject<T>\n  : T;\n\ntype DraftedMap<K, V> = Map<K, Draft<V>>;\ntype DraftedSet<T> = Set<Draft<T>>;\ntype DraftedObject<T> = {\n  -readonly [K in keyof T]: Draft<T[K]>;\n};\n\nexport type Draft<T> = T extends Primitive | AtomicObject\n  ? T\n  : T extends IfAvailable<ReadonlyMap<infer K, infer V>>\n  ? DraftedMap<K, V>\n  : T extends IfAvailable<ReadonlySet<infer V>>\n  ? DraftedSet<V>\n  : T extends WeakReferences\n  ? T\n  : T extends object\n  ? DraftedObject<T>\n  : T;\n", "// Don't use `Symbol()` just for 3rd party access the draft\nexport const PROXY_DRAFT = Symbol.for('__MUTATIVE_PROXY_DRAFT__');\nexport const RAW_RETURN_SYMBOL = Symbol('__MUTATIVE_RAW_RETURN_SYMBOL__');\n\nexport const iteratorSymbol: typeof Symbol.iterator = Symbol.iterator;\n\nexport const dataTypes = {\n  mutable: 'mutable',\n  immutable: 'immutable',\n} as const;\n", "import { createDraft } from './draft';\n\nexport const internal = {} as {\n  createDraft: typeof createDraft;\n};\n", "export function has(target: object, key: PropertyKey) {\n  return target instanceof Map\n    ? target.has(key)\n    : Object.prototype.hasOwnProperty.call(target, key);\n}\n\nexport function getDescriptor(target: object, key: PropertyKey) {\n  if (key in target) {\n    let prototype = Reflect.getPrototypeOf(target);\n    while (prototype) {\n      const descriptor = Reflect.getOwnPropertyDescriptor(prototype, key);\n      if (descriptor) return descriptor;\n      prototype = Reflect.getPrototypeOf(prototype);\n    }\n  }\n  return;\n}\n", "import { DraftType, Mark, ProxyDraft } from '../interface';\nimport { dataTypes, PROXY_DRAFT } from '../constant';\nimport { has } from './proto';\n\nexport function latest<T = any>(proxyDraft: ProxyDraft): T {\n  return proxyDraft.copy ?? proxyDraft.original;\n}\n\n/**\n * Check if the value is a draft\n */\nexport function isDraft(target: any) {\n  return !!getProxyDraft(target);\n}\n\nexport function getProxyDraft<T extends any>(value: T): ProxyDraft | null {\n  if (typeof value !== 'object') return null;\n  return (value as { [PROXY_DRAFT]: any })?.[PROXY_DRAFT];\n}\n\nexport function getValue<T extends object>(value: T): T {\n  const proxyDraft = getProxyDraft(value);\n  return proxyDraft ? proxyDraft.copy ?? proxyDraft.original : value;\n}\n\n/**\n * Check if a value is draftable\n */\nexport function isDraftable(value: any, options?: { mark?: Mark<any, any> }) {\n  if (!value || typeof value !== 'object') return false;\n  let markResult: any;\n  return (\n    Object.getPrototypeOf(value) === Object.prototype ||\n    Array.isArray(value) ||\n    value instanceof Map ||\n    value instanceof Set ||\n    (!!options?.mark &&\n      ((markResult = options.mark(value, dataTypes)) === dataTypes.immutable ||\n        typeof markResult === 'function'))\n  );\n}\n\nexport function getPath(\n  target: ProxyDraft,\n  path: any[] = []\n): (string | number | object)[] | null {\n  if (Object.hasOwnProperty.call(target, 'key')) {\n    // check if the parent is a draft and the original value is not equal to the current value\n    const parentCopy = target.parent!.copy;\n    const proxyDraft = getProxyDraft(get(parentCopy, target.key!));\n    if (proxyDraft !== null && proxyDraft?.original !== target.original) {\n      return null;\n    }\n    const isSet = target.parent!.type === DraftType.Set;\n    const key = isSet\n      ? Array.from(target.parent!.setMap!.keys()).indexOf(target.key)\n      : target.key;\n    // check if the key is still in the next state parent\n    if (\n      !((isSet && parentCopy.size > (key as number)) || has(parentCopy, key!))\n    )\n      return null;\n    path.push(key);\n  }\n  if (target.parent) {\n    return getPath(target.parent, path);\n  }\n  // `target` is root draft.\n  path.reverse();\n  try {\n    // check if the path is valid\n    resolvePath(target.copy, path);\n  } catch (e) {\n    return null;\n  }\n  return path;\n}\n\nexport function getType(target: any) {\n  if (Array.isArray(target)) return DraftType.Array;\n  if (target instanceof Map) return DraftType.Map;\n  if (target instanceof Set) return DraftType.Set;\n  return DraftType.Object;\n}\n\nexport function get(target: any, key: PropertyKey) {\n  return getType(target) === DraftType.Map ? target.get(key) : target[key];\n}\n\nexport function set(target: any, key: PropertyKey, value: any) {\n  const type = getType(target);\n  if (type === DraftType.Map) {\n    target.set(key, value);\n  } else {\n    target[key] = value;\n  }\n}\n\nexport function peek(target: any, key: PropertyKey) {\n  const state = getProxyDraft(target);\n  const source = state ? latest(state) : target;\n  return source[key];\n}\n\nexport function isEqual(x: any, y: any) {\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\n\nexport function revokeProxy(proxyDraft: ProxyDraft | null) {\n  if (!proxyDraft) return;\n  while (proxyDraft.finalities.revoke.length > 0) {\n    const revoke = proxyDraft.finalities.revoke.pop()!;\n    revoke();\n  }\n}\n\n// handle JSON Pointer path with spec https://www.rfc-editor.org/rfc/rfc6901\nexport function escapePath(path: string[], pathAsArray: boolean) {\n  return pathAsArray\n    ? path\n    : ['']\n        .concat(path)\n        .map((_item) => {\n          const item = `${_item}`;\n          if (item.indexOf('/') === -1 && item.indexOf('~') === -1) return item;\n          return item.replace(/~/g, '~0').replace(/\\//g, '~1');\n        })\n        .join('/');\n}\n\nexport function unescapePath(path: string | (string | number)[]) {\n  if (Array.isArray(path)) return path;\n  return path\n    .split('/')\n    .map((_item) => _item.replace(/~1/g, '/').replace(/~0/g, '~'))\n    .slice(1);\n}\n\nexport function resolvePath(base: any, path: (string | number)[]) {\n  for (let index = 0; index < path.length - 1; index += 1) {\n    const key = path[index];\n    // use `index` in Set draft\n    base = get(getType(base) === DraftType.Set ? Array.from(base) : base, key);\n    if (typeof base !== 'object') {\n      throw new Error(`Cannot resolve patch at '${path.join('/')}'.`);\n    }\n  }\n  return base;\n}\n", "import type { Options, ProxyDraft } from '../interface';\nimport { dataTypes } from '../constant';\nimport { getValue, isDraft, isDraftable } from './draft';\n\nfunction strictCopy(target: any) {\n  const copy = Object.create(Object.getPrototypeOf(target));\n  Reflect.ownKeys(target).forEach((key: any) => {\n    let desc = Reflect.getOwnPropertyDescriptor(target, key)!;\n    if (desc.enumerable && desc.configurable && desc.writable) {\n      copy[key] = target[key];\n      return;\n    }\n    // for freeze\n    if (!desc.writable) {\n      desc.writable = true;\n      desc.configurable = true;\n    }\n    if (desc.get || desc.set)\n      desc = {\n        configurable: true,\n        writable: true,\n        enumerable: desc.enumerable,\n        value: target[key],\n      };\n    Reflect.defineProperty(copy, key, desc);\n  });\n  return copy;\n}\n\nconst propIsEnum = Object.prototype.propertyIsEnumerable;\n\nexport function shallowCopy(original: any, options?: Options<any, any>) {\n  let markResult: any;\n  if (Array.isArray(original)) {\n    return Array.prototype.concat.call(original);\n  } else if (original instanceof Set) {\n    return new Set(original.values());\n  } else if (original instanceof Map) {\n    return new Map(original);\n  } else if (\n    options?.mark &&\n    ((markResult = options.mark(original, dataTypes)),\n    markResult !== undefined) &&\n    markResult !== dataTypes.mutable\n  ) {\n    if (markResult === dataTypes.immutable) {\n      return strictCopy(original);\n    } else if (typeof markResult === 'function') {\n      if (__DEV__ && (options.enablePatches || options.enableAutoFreeze)) {\n        throw new Error(\n          `You can't use mark and patches or auto freeze together.`\n        );\n      }\n      return markResult();\n    }\n    throw new Error(`Unsupported mark result: ${markResult}`);\n  } else if (\n    typeof original === 'object' &&\n    Object.getPrototypeOf(original) === Object.prototype\n  ) {\n    // For best performance with shallow copies,\n    // don't use `Object.create(Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj));` by default.\n    const copy: Record<string | symbol, any> = {};\n    Object.keys(original).forEach((key) => {\n      copy[key] = original[key];\n    });\n    Object.getOwnPropertySymbols(original).forEach((key) => {\n      if (propIsEnum.call(original, key)) {\n        copy[key] = original[key];\n      }\n    });\n    return copy;\n  } else {\n    throw new Error(\n      `Please check mark() to ensure that it is a stable marker draftable function.`\n    );\n  }\n}\n\nexport function ensureShallowCopy(target: ProxyDraft) {\n  if (target.copy) return;\n  target.copy = shallowCopy(target.original, target.options)!;\n}\n\nfunction deepClone<T>(target: T): T;\nfunction deepClone(target: any) {\n  if (!isDraftable(target)) return getValue(target);\n  if (Array.isArray(target)) return target.map(deepClone);\n  if (target instanceof Map)\n    return new Map(\n      Array.from(target.entries()).map(([k, v]) => [k, deepClone(v)])\n    );\n  if (target instanceof Set) return new Set(Array.from(target).map(deepClone));\n  const copy = Object.create(Object.getPrototypeOf(target));\n  for (const key in target) copy[key] = deepClone(target[key]);\n  return copy;\n}\n\nexport function cloneIfNeeded<T>(target: T): T {\n  return isDraft(target) ? deepClone(target) : target;\n}\n\nexport { deepClone };\n", "import { ProxyDraft } from '../interface';\n\nexport function markChanged(proxyDraft: ProxyDraft) {\n  proxyDraft.assignedMap = proxyDraft.assignedMap ?? new Map();\n  if (!proxyDraft.operated) {\n    proxyDraft.operated = true;\n    if (proxyDraft.parent) {\n      markChanged(proxyDraft.parent);\n    }\n  }\n}\n", "import { DraftType } from '../interface';\nimport { getType, isDraft } from './draft';\n\nfunction throwFrozenError() {\n  throw new Error('Cannot modify frozen object');\n}\n\nfunction isFreezable(value: any) {\n  return (\n    __DEV__ || (value && typeof value === 'object' && !Object.isFrozen(value))\n  );\n}\n\nexport function deepFreeze(\n  target: any,\n  subKey?: any,\n  updatedValues?: WeakMap<any, any>,\n  stack?: any[],\n  keys?: any[]\n) {\n  if (__DEV__) {\n    updatedValues = updatedValues ?? new WeakMap();\n    stack = stack ?? [];\n    keys = keys ?? [];\n    const value = updatedValues.has(target)\n      ? updatedValues.get(target)\n      : target;\n    if (stack.length > 0) {\n      const index = stack.indexOf(value);\n      if (value && typeof value === 'object' && index !== -1) {\n        if (stack[0] === value) {\n          throw new Error(`Forbids circular reference`);\n        }\n        throw new Error(\n          `Forbids circular reference: ~/${keys\n            .slice(0, index)\n            .map((key, index) => {\n              if (typeof key === 'symbol') return `[${key.toString()}]`;\n              const parent = stack![index];\n              if (\n                typeof key === 'object' &&\n                (parent instanceof Map || parent instanceof Set)\n              )\n                return Array.from(parent.keys()).indexOf(key);\n              return key;\n            })\n            .join('/')}`\n        );\n      }\n      stack.push(value);\n      keys.push(subKey);\n    } else {\n      stack.push(value);\n    }\n  }\n  if (Object.isFrozen(target) || isDraft(target)) {\n    if (__DEV__) {\n      stack!.pop();\n      keys!.pop();\n    }\n    return;\n  }\n  const type = getType(target);\n  switch (type) {\n    case DraftType.Map:\n      for (const [key, value] of target) {\n        if (isFreezable(key)) deepFreeze(key, key, updatedValues, stack, keys);\n        if (isFreezable(value))\n          deepFreeze(value, key, updatedValues, stack, keys);\n      }\n      target.set = target.clear = target.delete = throwFrozenError;\n      break;\n    case DraftType.Set:\n      for (const value of target) {\n        if (isFreezable(value))\n          deepFreeze(value, value, updatedValues, stack, keys);\n      }\n      target.add = target.clear = target.delete = throwFrozenError;\n      break;\n    case DraftType.Array:\n      Object.freeze(target);\n      let index = 0;\n      for (const value of target) {\n        if (isFreezable(value))\n          deepFreeze(value, index, updatedValues, stack, keys);\n        index += 1;\n      }\n      break;\n    default:\n      Object.freeze(target);\n      // ignore non-enumerable or symbol properties\n      Object.keys(target).forEach((name) => {\n        const value = target[name];\n        if (isFreezable(value))\n          deepFreeze(value, name, updatedValues, stack, keys);\n      });\n  }\n  if (__DEV__) {\n    stack!.pop();\n    keys!.pop();\n  }\n}\n", "import { DraftType } from '../interface';\nimport { getType } from './draft';\n\nexport function forEach<T extends object>(\n  target: T,\n  iter: (key: string | number | symbol, value: any, source: T) => void\n) {\n  const type = getType(target);\n  if (type === DraftType.Object) {\n    Reflect.ownKeys(target).forEach((key) => {\n      iter(key, (target as any)[key], target);\n    });\n  } else if (type === DraftType.Array) {\n    let index = 0;\n    for (const entry of target as any[]) {\n      iter(index, entry, target);\n      index += 1;\n    }\n  } else {\n    (target as Map<any, any> | Set<any>).forEach((entry: any, index: any) =>\n      iter(index, entry, target)\n    );\n  }\n}\n", "import { DraftType, Patches, ProxyDraft } from '../interface';\nimport { ensureShallowCopy } from './copy';\nimport {\n  get,\n  getPath,\n  getProxyDraft,\n  getValue,\n  isDraft,\n  isDraftable,\n  isEqual,\n  set,\n} from './draft';\nimport { forEach } from './forEach';\n\nexport function handleValue(\n  target: any,\n  handledSet: WeakSet<any>,\n  options?: ProxyDraft['options']\n) {\n  if (\n    isDraft(target) ||\n    !isDraftable(target, options) ||\n    handledSet.has(target) ||\n    Object.isFrozen(target)\n  )\n    return;\n  const isSet = target instanceof Set;\n  const setMap: Map<any, any> | undefined = isSet ? new Map() : undefined;\n  handledSet.add(target);\n  forEach(target, (key, value) => {\n    if (isDraft(value)) {\n      const proxyDraft = getProxyDraft(value)!;\n      ensureShallowCopy(proxyDraft);\n      // A draft where a child node has been changed, or assigned a value\n      const updatedValue =\n        proxyDraft.assignedMap?.size || proxyDraft.operated\n          ? proxyDraft.copy\n          : proxyDraft.original;\n      // final update value\n      set(isSet ? setMap! : target, key, updatedValue);\n    } else {\n      handleValue(value, handledSet, options);\n    }\n  });\n  if (setMap) {\n    const set = target as Set<any>;\n    const values = Array.from(set);\n    set.clear();\n    values.forEach((value) => {\n      set.add(setMap!.has(value) ? setMap!.get(value) : value);\n    });\n  }\n}\n\nexport function finalizeAssigned(proxyDraft: ProxyDraft, key: PropertyKey) {\n  // handle the draftable assigned values， and the value is not a draft\n  const copy =\n    proxyDraft.type === DraftType.Set ? proxyDraft.setMap : proxyDraft.copy;\n  if (\n    proxyDraft.finalities.revoke.length > 1 &&\n    proxyDraft.assignedMap!.get(key) &&\n    copy\n  ) {\n    handleValue(\n      get(copy, key),\n      proxyDraft.finalities.handledSet,\n      proxyDraft.options\n    );\n  }\n}\n\nexport type GeneratePatches = (\n  proxyState: ProxyDraft,\n  basePath: any[],\n  patches: Patches,\n  inversePatches: Patches\n) => void;\n\nexport function finalizeSetValue(target: ProxyDraft) {\n  if (target.type === DraftType.Set && target.copy) {\n    target.copy.clear();\n    target.setMap!.forEach((value) => {\n      target.copy!.add(getValue(value));\n    });\n  }\n}\n\nexport function finalizePatches(\n  target: ProxyDraft,\n  generatePatches: GeneratePatches,\n  patches?: Patches,\n  inversePatches?: Patches\n) {\n  const shouldFinalize =\n    target.operated &&\n    target.assignedMap &&\n    target.assignedMap.size > 0 &&\n    !target.finalized;\n  if (shouldFinalize) {\n    if (patches && inversePatches) {\n      const basePath = getPath(target);\n      if (basePath) {\n        generatePatches(target, basePath, patches, inversePatches);\n      }\n    }\n    target.finalized = true;\n  }\n}\n\nexport function markFinalization(\n  target: ProxyDraft,\n  key: any,\n  value: any,\n  generatePatches: GeneratePatches\n) {\n  const proxyDraft = getProxyDraft(value);\n  if (proxyDraft) {\n    // !case: assign the draft value\n    if (!proxyDraft.callbacks) {\n      proxyDraft.callbacks = [];\n    }\n    proxyDraft.callbacks.push((patches, inversePatches) => {\n      const copy = target.type === DraftType.Set ? target.setMap : target.copy;\n      if (isEqual(get(copy, key), value)) {\n        let updatedValue = proxyDraft.original;\n        if (proxyDraft.copy) {\n          updatedValue = proxyDraft.copy;\n        }\n        finalizeSetValue(target);\n        finalizePatches(target, generatePatches, patches, inversePatches);\n        if (__DEV__ && target.options.enableAutoFreeze) {\n          target.options.updatedValues =\n            target.options.updatedValues ?? new WeakMap();\n          target.options.updatedValues.set(updatedValue, proxyDraft.original);\n        }\n        // final update value\n        set(copy, key, updatedValue);\n      }\n    });\n    if (target.options.enableAutoFreeze) {\n      // !case: assign the draft value in cross draft tree\n      if (proxyDraft.finalities !== target.finalities) {\n        target.options.enableAutoFreeze = false;\n      }\n    }\n  }\n  if (isDraftable(value, target.options)) {\n    // !case: assign the non-draft value\n    target.finalities.draft.push(() => {\n      const copy = target.type === DraftType.Set ? target.setMap : target.copy;\n      if (isEqual(get(copy, key), value)) {\n        finalizeAssigned(target, key);\n      }\n    });\n  }\n}\n", "import { DraftType, Operation, Patches, ProxyDraft } from './interface';\nimport { cloneIfNeeded, escapePath, get, has, isEqual } from './utils';\n\nfunction generateArrayPatches(\n  proxyState: ProxyDraft<Array<any>>,\n  basePath: any[],\n  patches: Patches,\n  inversePatches: Patches,\n  pathAsArray: boolean\n) {\n  let { original, assignedMap, options } = proxyState;\n  let copy = proxyState.copy!;\n  if (copy.length < original.length) {\n    [original, copy] = [copy, original];\n    [patches, inversePatches] = [inversePatches, patches];\n  }\n  for (let index = 0; index < original.length; index += 1) {\n    if (assignedMap!.get(index.toString()) && copy[index] !== original[index]) {\n      const _path = basePath.concat([index]);\n      const path = escapePath(_path, pathAsArray);\n      patches.push({\n        op: Operation.Replace,\n        path,\n        // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n        value: cloneIfNeeded(copy[index]),\n      });\n      inversePatches.push({\n        op: Operation.Replace,\n        path,\n        // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n        value: cloneIfNeeded(original[index]),\n      });\n    }\n  }\n  for (let index = original.length; index < copy.length; index += 1) {\n    const _path = basePath.concat([index]);\n    const path = escapePath(_path, pathAsArray);\n    patches.push({\n      op: Operation.Add,\n      path,\n      // If it is a draft, it needs to be deep cloned, and it may also be non-draft.\n      value: cloneIfNeeded(copy[index]),\n    });\n  }\n  if (original.length < copy.length) {\n    // https://www.rfc-editor.org/rfc/rfc6902#appendix-A.4\n    // For performance, here we only generate an operation that replaces the length of the array,\n    // which is inconsistent with JSON Patch specification\n    const { arrayLengthAssignment = true } = options.enablePatches;\n    if (arrayLengthAssignment) {\n      const _path = basePath.concat(['length']);\n      const path = escapePath(_path, pathAsArray);\n      inversePatches.push({\n        op: Operation.Replace,\n        path,\n        value: original.length,\n      });\n    } else {\n      for (let index = copy.length; original.length < index; index -= 1) {\n        const _path = basePath.concat([index - 1]);\n        const path = escapePath(_path, pathAsArray);\n        inversePatches.push({\n          op: Operation.Remove,\n          path,\n        });\n      }\n    }\n  }\n}\n\nfunction generatePatchesFromAssigned(\n  { original, copy, assignedMap }: ProxyDraft<Record<string, any>>,\n  basePath: any[],\n  patches: Patches,\n  inversePatches: Patches,\n  pathAsArray: boolean\n) {\n  assignedMap!.forEach((assignedValue, key) => {\n    const originalValue = get(original, key);\n    const value = cloneIfNeeded(get(copy, key));\n    const op = !assignedValue\n      ? Operation.Remove\n      : has(original, key)\n      ? Operation.Replace\n      : Operation.Add;\n    if (isEqual(originalValue, value) && op === Operation.Replace) return;\n    const _path = basePath.concat(key);\n    const path = escapePath(_path, pathAsArray);\n    patches.push(op === Operation.Remove ? { op, path } : { op, path, value });\n    inversePatches.push(\n      op === Operation.Add\n        ? { op: Operation.Remove, path }\n        : op === Operation.Remove\n        ? { op: Operation.Add, path, value: originalValue }\n        : { op: Operation.Replace, path, value: originalValue }\n    );\n  });\n}\n\nfunction generateSetPatches(\n  { original, copy }: ProxyDraft<Set<any>>,\n  basePath: any[],\n  patches: Patches,\n  inversePatches: Patches,\n  pathAsArray: boolean\n) {\n  let index = 0;\n  original.forEach((value: any) => {\n    if (!copy!.has(value)) {\n      const _path = basePath.concat([index]);\n      const path = escapePath(_path, pathAsArray);\n      patches.push({\n        op: Operation.Remove,\n        path,\n        value,\n      });\n      inversePatches.unshift({\n        op: Operation.Add,\n        path,\n        value,\n      });\n    }\n    index += 1;\n  });\n  index = 0;\n  copy!.forEach((value: any) => {\n    if (!original.has(value)) {\n      const _path = basePath.concat([index]);\n      const path = escapePath(_path, pathAsArray);\n      patches.push({\n        op: Operation.Add,\n        path,\n        value,\n      });\n      inversePatches.unshift({\n        op: Operation.Remove,\n        path,\n        value,\n      });\n    }\n    index += 1;\n  });\n}\n\nexport function generatePatches(\n  proxyState: ProxyDraft,\n  basePath: any[],\n  patches: Patches,\n  inversePatches: Patches\n) {\n  const { pathAsArray = true } = proxyState.options.enablePatches;\n  switch (proxyState.type) {\n    case DraftType.Object:\n    case DraftType.Map:\n      return generatePatchesFromAssigned(\n        proxyState,\n        basePath,\n        patches,\n        inversePatches,\n        pathAsArray\n      );\n    case DraftType.Array:\n      return generateArrayPatches(\n        proxyState,\n        basePath,\n        patches,\n        inversePatches,\n        pathAsArray\n      );\n    case DraftType.Set:\n      return generateSetPatches(\n        proxyState,\n        basePath,\n        patches,\n        inversePatches,\n        pathAsArray\n      );\n  }\n}\n", "import { Options } from './interface';\nimport { isDraftable } from './utils';\n\nlet readable = false;\n\nexport const checkReadable = (\n  value: any,\n  options: Options<any, any>,\n  ignoreCheckDraftable = false\n) => {\n  if (\n    typeof value === 'object' &&\n    value !== null &&\n    (!isDraftable(value, options) || ignoreCheckDraftable) &&\n    !readable\n  ) {\n    throw new Error(\n      `Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.`\n    );\n  }\n};\n\n/**\n * `unsafe(callback)` to access mutable data directly in strict mode.\n *\n * ## Example\n *\n * ```ts\n * import { create, unsafe } from '../index';\n *\n * class Foobar {\n *   bar = 1;\n * }\n *\n * const baseState = { foobar: new Foobar() };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *    unsafe(() => {\n *      draft.foobar.bar = 2;\n *    });\n *   },\n *   {\n *     strict: true,\n *   }\n * );\n *\n * expect(state).toBe(baseState);\n * expect(state.foobar).toBe(baseState.foobar);\n * expect(state.foobar.bar).toBe(2);\n * ```\n */\nexport function unsafe<T>(callback: () => T): T {\n  readable = true;\n  let result: T;\n  try {\n    result = callback();\n  } finally {\n    readable = false;\n  }\n  return result;\n}\n", "import { dataTypes, iteratorSymbol } from './constant';\nimport { internal } from './internal';\nimport { generatePatches } from './patch';\nimport { checkReadable } from './unsafe';\nimport {\n  ensureShallowCopy,\n  getProxyDraft,\n  isDraftable,\n  isEqual,\n  latest,\n  markChanged,\n  markFinalization,\n} from './utils';\n\nexport const mapHandler = {\n  get size() {\n    const current: Map<any, any> = latest(getProxyDraft(this)!);\n    return current.size;\n  },\n  has(key: any): boolean {\n    return latest(getProxyDraft(this)!).has(key);\n  },\n  set(key: any, value: any) {\n    const target = getProxyDraft(this)!;\n    const source = latest(target);\n    if (!source.has(key) || !isEqual(source.get(key), value)) {\n      ensureShallowCopy(target);\n      markChanged(target);\n      target.assignedMap!.set(key, true);\n      target.copy.set(key, value);\n      markFinalization(target, key, value, generatePatches);\n    }\n    return this;\n  },\n  delete(key: any): boolean {\n    if (!this.has(key)) {\n      return false;\n    }\n    const target = getProxyDraft(this)!;\n    ensureShallowCopy(target);\n    markChanged(target);\n    if (target.original.has(key)) {\n      target.assignedMap!.set(key, false);\n    } else {\n      target.assignedMap!.delete(key);\n    }\n    target.copy.delete(key);\n    return true;\n  },\n  clear() {\n    const target = getProxyDraft(this)!;\n    if (!this.size) return;\n    ensureShallowCopy(target);\n    markChanged(target);\n    target.assignedMap = new Map();\n    for (const [key] of target.original) {\n      target.assignedMap.set(key, false);\n    }\n    target.copy!.clear();\n  },\n  forEach(callback: (value: any, key: any, self: any) => void, thisArg?: any) {\n    const target = getProxyDraft(this)!;\n    latest(target).forEach((_value: any, _key: any) => {\n      callback.call(thisArg, this.get(_key), _key, this);\n    });\n  },\n  get(key: any): any {\n    const target = getProxyDraft(this)!;\n    const value = latest(target).get(key);\n    const mutable =\n      target.options.mark?.(value, dataTypes) === dataTypes.mutable;\n    if (target.options.strict) {\n      checkReadable(value, target.options, mutable);\n    }\n    if (mutable) {\n      return value;\n    }\n    if (target.finalized || !isDraftable(value, target.options)) {\n      return value;\n    }\n    // drafted or reassigned\n    if (value !== target.original.get(key)) {\n      return value;\n    }\n    const draft = internal.createDraft({\n      original: value,\n      parentDraft: target,\n      key,\n      finalities: target.finalities,\n      options: target.options,\n    });\n    ensureShallowCopy(target);\n    target.copy.set(key, draft);\n    return draft;\n  },\n  keys(): IterableIterator<any> {\n    return latest(getProxyDraft(this)!).keys();\n  },\n  values(): IterableIterator<any> {\n    const iterator = this.keys();\n    return {\n      [iteratorSymbol]: () => this.values(),\n      next: () => {\n        const result = iterator.next();\n        if (result.done) return result;\n        const value = this.get(result.value);\n        return {\n          done: false,\n          value,\n        };\n      },\n    } as any;\n  },\n  entries(): IterableIterator<[any, any]> {\n    const iterator = this.keys();\n    return {\n      [iteratorSymbol]: () => this.entries(),\n      next: () => {\n        const result = iterator.next();\n        if (result.done) return result;\n        const value = this.get(result.value);\n        return {\n          done: false,\n          value: [result.value, value],\n        };\n      },\n    } as any;\n  },\n  [iteratorSymbol]() {\n    return this.entries();\n  },\n};\n\nexport const mapHandlerKeys = Reflect.ownKeys(mapHandler);\n", "import { ProxyDraft } from './interface';\nimport { dataTypes, iteratorSymbol } from './constant';\nimport { internal } from './internal';\nimport {\n  ensureShallowCopy,\n  getProxyDraft,\n  isDraftable,\n  markChanged,\n  markFinalization,\n} from './utils';\nimport { checkReadable } from './unsafe';\nimport { generatePatches } from './patch';\n\nconst getNextIterator =\n  (\n    target: ProxyDraft<any>,\n    iterator: IterableIterator<any>,\n    { isValuesIterator }: { isValuesIterator: boolean }\n  ) =>\n  () => {\n    const result = iterator.next();\n    if (result.done) return result;\n    const key = result.value as any;\n    let value = target.setMap!.get(key);\n    const currentDraft = getProxyDraft(value);\n    const mutable =\n      target.options.mark?.(value, dataTypes) === dataTypes.mutable;\n    if (target.options.strict) {\n      checkReadable(key, target.options, mutable);\n    }\n    if (\n      !mutable &&\n      !currentDraft &&\n      isDraftable(key, target.options) &&\n      !target.finalized &&\n      target.original!.has(key)\n    ) {\n      // draft a draftable original set item\n      const proxy = internal.createDraft({\n        original: key,\n        parentDraft: target,\n        key,\n        finalities: target.finalities,\n        options: target.options,\n      });\n      target.setMap!.set(key, proxy);\n      value = proxy;\n    } else if (currentDraft) {\n      // drafted\n      value = currentDraft.proxy;\n    }\n    return {\n      done: false,\n      value: isValuesIterator ? value : [value, value],\n    };\n  };\n\nexport const setHandler = {\n  get size() {\n    const target: ProxyDraft<any> = getProxyDraft(this)!;\n    return target.setMap!.size;\n  },\n  has(value: any) {\n    const target = getProxyDraft(this)!;\n    // reassigned or non-draftable values\n    if (target.setMap!.has(value)) return true;\n    ensureShallowCopy(target);\n    const valueProxyDraft = getProxyDraft(value)!;\n    // drafted\n    if (valueProxyDraft && target.setMap!.has(valueProxyDraft.original))\n      return true;\n    return false;\n  },\n  add(value: any) {\n    const target = getProxyDraft(this)!;\n    if (!this.has(value)) {\n      ensureShallowCopy(target);\n      markChanged(target);\n      target.assignedMap!.set(value, true);\n      target.setMap!.set(value, value);\n      markFinalization(target, value, value, generatePatches);\n    }\n    return this;\n  },\n  delete(value: any): boolean {\n    if (!this.has(value)) {\n      return false;\n    }\n    const target = getProxyDraft(this)!;\n    ensureShallowCopy(target);\n    markChanged(target);\n    const valueProxyDraft = getProxyDraft(value)!;\n    if (valueProxyDraft && target.setMap!.has(valueProxyDraft.original)) {\n      // delete drafted\n      target.assignedMap!.set(valueProxyDraft.original, false);\n      return target.setMap!.delete(valueProxyDraft.original);\n    }\n    if (!valueProxyDraft && target.setMap!.has(value)) {\n      // non-draftable values\n      target.assignedMap!.set(value, false);\n    } else {\n      // reassigned\n      target.assignedMap!.delete(value);\n    }\n    // delete reassigned or non-draftable values\n    return target.setMap!.delete(value);\n  },\n  clear() {\n    if (!this.size) return;\n    const target = getProxyDraft(this)!;\n    ensureShallowCopy(target);\n    markChanged(target);\n    for (const value of target.original) {\n      target.assignedMap!.set(value, false);\n    }\n    target.setMap!.clear();\n  },\n  values(): IterableIterator<any> {\n    const target = getProxyDraft(this)!;\n    ensureShallowCopy(target);\n    const iterator = target.setMap!.keys();\n    return {\n      [Symbol.iterator]: () => this.values(),\n      next: getNextIterator(target, iterator, { isValuesIterator: true }),\n    };\n  },\n  entries(): IterableIterator<[any, any]> {\n    const target = getProxyDraft(this)!;\n    ensureShallowCopy(target);\n    const iterator = target.setMap!.keys();\n    return {\n      [Symbol.iterator]: () => this.entries(),\n      next: getNextIterator(target, iterator, {\n        isValuesIterator: false,\n      }) as () => IteratorReturnResult<any>,\n    };\n  },\n  keys(): IterableIterator<any> {\n    return this.values();\n  },\n  [iteratorSymbol]() {\n    return this.values();\n  },\n  forEach(callback: any, thisArg?: any) {\n    const iterator = this.values();\n    let result = iterator.next();\n    while (!result.done) {\n      callback.call(thisArg, result.value, result.value, this);\n      result = iterator.next();\n    }\n  },\n};\n\nexport const setHandlerKeys = Reflect.ownKeys(setHandler);\n", "import {\n  DraftType,\n  Finalities,\n  Patches,\n  ProxyDraft,\n  Options,\n  Operation,\n} from './interface';\nimport { dataTypes, PROXY_DRAFT } from './constant';\nimport { mapHandler, mapHandlerKeys } from './map';\nimport { setHandler, setHandlerKeys } from './set';\nimport { internal } from './internal';\nimport {\n  deepFreeze,\n  ensureShallowCopy,\n  getDescriptor,\n  getProxyDraft,\n  getType,\n  getValue,\n  has,\n  isEqual,\n  isDraftable,\n  latest,\n  markChanged,\n  peek,\n  get,\n  set,\n  revokeProxy,\n  finalizeSetValue,\n  markFinalization,\n  finalizePatches,\n} from './utils';\nimport { checkReadable } from './unsafe';\nimport { generatePatches } from './patch';\n\nconst draftsCache = new WeakSet<object>();\n\nconst proxyHandler: ProxyHandler<ProxyDraft> = {\n  get(target: ProxyDraft, key: string | number | symbol, receiver: any) {\n    const copy = target.copy?.[key];\n    // Improve draft reading performance by caching the draft copy.\n    if (copy && draftsCache.has(copy)) {\n      return copy;\n    }\n    if (key === PROXY_DRAFT) return target;\n    let markResult: any;\n    if (target.options.mark) {\n      // handle `Uncaught TypeError: Method get Map.prototype.size called on incompatible receiver #<Map>`\n      // or `Uncaught TypeError: Method get Set.prototype.size called on incompatible receiver #<Set>`\n      const value =\n        key === 'size' &&\n        (target.original instanceof Map || target.original instanceof Set)\n          ? Reflect.get(target.original, key)\n          : Reflect.get(target.original, key, receiver);\n      markResult = target.options.mark(value, dataTypes);\n      if (markResult === dataTypes.mutable) {\n        if (target.options.strict) {\n          checkReadable(value, target.options, true);\n        }\n        return value;\n      }\n    }\n    const source = latest(target);\n\n    if (source instanceof Map && mapHandlerKeys.includes(key as any)) {\n      if (key === 'size') {\n        return Object.getOwnPropertyDescriptor(mapHandler, 'size')!.get!.call(\n          target.proxy\n        );\n      }\n      const handle = mapHandler[key as keyof typeof mapHandler] as Function;\n      if (handle) {\n        return handle.bind(target.proxy);\n      }\n    }\n\n    if (source instanceof Set && setHandlerKeys.includes(key as any)) {\n      if (key === 'size') {\n        return Object.getOwnPropertyDescriptor(setHandler, 'size')!.get!.call(\n          target.proxy\n        );\n      }\n      const handle = setHandler[key as keyof typeof setHandler] as Function;\n      if (handle) {\n        return handle.bind(target.proxy);\n      }\n    }\n\n    if (!has(source, key)) {\n      const desc = getDescriptor(source, key);\n      return desc\n        ? `value` in desc\n          ? desc.value\n          : // !case: support for getter\n            desc.get?.call(target.proxy)\n        : undefined;\n    }\n    const value = source[key];\n    if (target.options.strict) {\n      checkReadable(value, target.options);\n    }\n    if (target.finalized || !isDraftable(value, target.options)) {\n      return value;\n    }\n    // Ensure that the assigned values are not drafted\n    if (value === peek(target.original, key)) {\n      ensureShallowCopy(target);\n      target.copy![key] = createDraft({\n        original: target.original[key],\n        parentDraft: target,\n        key: target.type === DraftType.Array ? Number(key) : key,\n        finalities: target.finalities,\n        options: target.options,\n      });\n      // !case: support for custom shallow copy function\n      if (typeof markResult === 'function') {\n        const subProxyDraft = getProxyDraft(target.copy![key])!;\n        ensureShallowCopy(subProxyDraft);\n        // Trigger a custom shallow copy to update to a new copy\n        markChanged(subProxyDraft);\n        return subProxyDraft.copy;\n      }\n      return target.copy![key];\n    }\n    return value;\n  },\n  set(target: ProxyDraft, key: string | number | symbol, value: any) {\n    if (target.type === DraftType.Set || target.type === DraftType.Map) {\n      throw new Error(\n        `Map/Set draft does not support any property assignment.`\n      );\n    }\n    let _key: number;\n    if (\n      target.type === DraftType.Array &&\n      key !== 'length' &&\n      !(\n        Number.isInteger((_key = Number(key))) &&\n        _key >= 0 &&\n        (key === 0 || _key === 0 || String(_key) === String(key))\n      )\n    ) {\n      throw new Error(\n        `Only supports setting array indices and the 'length' property.`\n      );\n    }\n    const desc = getDescriptor(latest(target), key);\n    if (desc?.set) {\n      // !case: cover the case of setter\n      desc.set.call(target.proxy, value);\n      return true;\n    }\n    const current = peek(latest(target), key);\n    const currentProxyDraft = getProxyDraft(current);\n    if (currentProxyDraft && isEqual(currentProxyDraft.original, value)) {\n      // !case: ignore the case of assigning the original draftable value to a draft\n      target.copy![key] = value;\n      target.assignedMap = target.assignedMap ?? new Map();\n      target.assignedMap.set(key, false);\n      return true;\n    }\n    // !case: handle new props with value 'undefined'\n    if (\n      isEqual(value, current) &&\n      (value !== undefined || has(target.original, key))\n    )\n      return true;\n    ensureShallowCopy(target);\n    markChanged(target);\n    if (has(target.original, key) && isEqual(value, target.original[key])) {\n      // !case: handle the case of assigning the original non-draftable value to a draft\n      target.assignedMap!.delete(key);\n    } else {\n      target.assignedMap!.set(key, true);\n    }\n    target.copy![key] = value;\n    markFinalization(target, key, value, generatePatches);\n    return true;\n  },\n  has(target: ProxyDraft, key: string | symbol) {\n    return key in latest(target);\n  },\n  ownKeys(target: ProxyDraft) {\n    return Reflect.ownKeys(latest(target));\n  },\n  getOwnPropertyDescriptor(target: ProxyDraft, key: string | symbol) {\n    const source = latest(target);\n    const descriptor = Reflect.getOwnPropertyDescriptor(source, key);\n    if (!descriptor) return descriptor;\n    return {\n      writable: true,\n      configurable: target.type !== DraftType.Array || key !== 'length',\n      enumerable: descriptor.enumerable,\n      value: source[key],\n    };\n  },\n  getPrototypeOf(target: ProxyDraft) {\n    return Reflect.getPrototypeOf(target.original);\n  },\n  setPrototypeOf() {\n    throw new Error(`Cannot call 'setPrototypeOf()' on drafts`);\n  },\n  defineProperty() {\n    throw new Error(`Cannot call 'defineProperty()' on drafts`);\n  },\n  deleteProperty(target: ProxyDraft, key: string | symbol) {\n    if (target.type === DraftType.Array) {\n      return proxyHandler.set!.call(this, target, key, undefined, target.proxy);\n    }\n    if (peek(target.original, key) !== undefined || key in target.original) {\n      // !case: delete an existing key\n      ensureShallowCopy(target);\n      markChanged(target);\n      target.assignedMap!.set(key, false);\n    } else {\n      target.assignedMap = target.assignedMap ?? new Map();\n      // The original non-existent key has been deleted\n      target.assignedMap.delete(key);\n    }\n    if (target.copy) delete target.copy[key];\n    return true;\n  },\n};\n\nexport function createDraft<T extends object>(createDraftOptions: {\n  original: T;\n  parentDraft?: ProxyDraft | null;\n  key?: string | number | symbol;\n  finalities: Finalities;\n  options: Options<any, any>;\n}): T {\n  const { original, parentDraft, key, finalities, options } =\n    createDraftOptions;\n  const type = getType(original);\n  const proxyDraft: ProxyDraft = {\n    type,\n    finalized: false,\n    parent: parentDraft,\n    original,\n    copy: null,\n    proxy: null,\n    finalities,\n    options,\n    // Mapping of draft Set items to their corresponding draft values.\n    setMap:\n      type === DraftType.Set\n        ? new Map((original as Set<any>).entries())\n        : undefined,\n  };\n  // !case: undefined as a draft map key\n  if (key || 'key' in createDraftOptions) {\n    proxyDraft.key = key;\n  }\n  const { proxy, revoke } = Proxy.revocable<any>(\n    type === DraftType.Array ? Object.assign([], proxyDraft) : proxyDraft,\n    proxyHandler\n  );\n  finalities.revoke.push(revoke);\n  draftsCache.add(proxy);\n  proxyDraft.proxy = proxy;\n  if (parentDraft) {\n    const target = parentDraft;\n    target.finalities.draft.push((patches, inversePatches) => {\n      const oldProxyDraft = getProxyDraft(proxy)!;\n      // if target is a Set draft, `setMap` is the real Set copies proxy mapping.\n      let copy = target.type === DraftType.Set ? target.setMap : target.copy;\n      const draft = get(copy, key!);\n      const proxyDraft = getProxyDraft(draft);\n      if (proxyDraft) {\n        // assign the updated value to the copy object\n        let updatedValue = proxyDraft.original;\n        if (proxyDraft.operated) {\n          updatedValue = getValue(draft);\n        }\n        finalizeSetValue(proxyDraft);\n        finalizePatches(proxyDraft, generatePatches, patches, inversePatches);\n        if (__DEV__ && target.options.enableAutoFreeze) {\n          target.options.updatedValues =\n            target.options.updatedValues ?? new WeakMap();\n          target.options.updatedValues.set(updatedValue, proxyDraft.original);\n        }\n        // final update value\n        set(copy, key!, updatedValue);\n      }\n      // !case: handle the deleted key\n      oldProxyDraft.callbacks?.forEach((callback) => {\n        callback(patches, inversePatches);\n      });\n    });\n  } else {\n    // !case: handle the root draft\n    const target = getProxyDraft(proxy)!;\n    target.finalities.draft.push((patches, inversePatches) => {\n      finalizeSetValue(target);\n      finalizePatches(target, generatePatches, patches, inversePatches);\n    });\n  }\n  return proxy;\n}\n\ninternal.createDraft = createDraft;\n\nexport function finalizeDraft<T>(\n  result: T,\n  returnedValue: [T] | [],\n  patches?: Patches,\n  inversePatches?: Patches,\n  enableAutoFreeze?: boolean\n) {\n  const proxyDraft = getProxyDraft(result);\n  const original = proxyDraft?.original ?? result;\n  const hasReturnedValue = !!returnedValue.length;\n  if (proxyDraft?.operated) {\n    while (proxyDraft.finalities.draft.length > 0) {\n      const finalize = proxyDraft.finalities.draft.pop()!;\n      finalize(patches, inversePatches);\n    }\n  }\n  const state = hasReturnedValue\n    ? returnedValue[0]\n    : proxyDraft\n    ? proxyDraft.operated\n      ? proxyDraft.copy\n      : proxyDraft.original\n    : result;\n  if (proxyDraft) revokeProxy(proxyDraft);\n  if (enableAutoFreeze) {\n    deepFreeze(state, state, proxyDraft?.options.updatedValues);\n  }\n  return [\n    state,\n    patches && hasReturnedValue\n      ? [{ op: Operation.Replace, path: [], value: returnedValue[0] }]\n      : patches,\n    inversePatches && hasReturnedValue\n      ? [{ op: Operation.Replace, path: [], value: original }]\n      : inversePatches,\n  ] as [T, Patches | undefined, Patches | undefined];\n}\n", "import {\n  Finalities,\n  Options,\n  Patches,\n  PatchesOptions,\n  Result,\n} from './interface';\nimport { createDraft, finalizeDraft } from './draft';\nimport { isDraftable } from './utils';\nimport { dataTypes } from './constant';\n\nexport function draftify<\n  T extends object,\n  O extends PatchesOptions = false,\n  F extends boolean = false\n>(\n  baseState: T,\n  options: Options<O, F>\n): [T, (returnedValue: [T] | []) => Result<T, O, F>] {\n  const finalities: Finalities = {\n    draft: [],\n    revoke: [],\n    handledSet: new WeakSet<any>(),\n  };\n  let patches: Patches | undefined;\n  let inversePatches: Patches | undefined;\n  if (options.enablePatches) {\n    patches = [];\n    inversePatches = [];\n  }\n  const isMutable =\n    options.mark?.(baseState, dataTypes) === dataTypes.mutable ||\n    !isDraftable(baseState, options);\n  const draft = isMutable\n    ? baseState\n    : createDraft({\n        original: baseState,\n        parentDraft: null,\n        finalities,\n        options,\n      });\n  return [\n    draft,\n    (returnedValue: [T] | [] = []) => {\n      const [finalizedState, finalizedPatches, finalizedInversePatches] =\n        finalizeDraft(\n          draft,\n          returnedValue,\n          patches,\n          inversePatches,\n          options.enableAutoFreeze\n        );\n      return (\n        options.enablePatches\n          ? [finalizedState, finalizedPatches, finalizedInversePatches]\n          : finalizedState\n      ) as Result<T, O, F>;\n    },\n  ];\n}\n", "import { DraftType, ProxyDraft } from './interface';\nimport {\n  forEach,\n  get,\n  getProxyDraft,\n  getType,\n  isDraft,\n  isDraftable,\n  isEqual,\n  set,\n  shallowCopy,\n} from './utils';\n\nexport function handleReturnValue<T extends object>(options: {\n  rootDraft: ProxyDraft<any> | undefined;\n  value: T;\n  useRawReturn?: boolean;\n  isContainDraft?: boolean;\n  isRoot?: boolean;\n}) {\n  const { rootDraft, value, useRawReturn = false, isRoot = true } = options;\n  forEach(value, (key, item, source) => {\n    const proxyDraft = getProxyDraft(item);\n    // just handle the draft which is created by the same rootDraft\n    if (\n      proxyDraft &&\n      rootDraft &&\n      proxyDraft.finalities === rootDraft.finalities\n    ) {\n      options.isContainDraft = true;\n      const currentValue = proxyDraft.original;\n      // final update value, but just handle return value\n      if (source instanceof Set) {\n        const arr = Array.from(source);\n        source.clear();\n        arr.forEach((_item) =>\n          source.add(key === _item ? currentValue : _item)\n        );\n      } else {\n        set(source, key, currentValue);\n      }\n    } else if (typeof item === 'object' && item !== null) {\n      options.value = item;\n      options.isRoot = false;\n      handleReturnValue(options);\n    }\n  });\n  if (__DEV__ && isRoot) {\n    if (!options.isContainDraft)\n      console.warn(\n        `The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance.`\n      );\n\n    if (useRawReturn) {\n      console.warn(\n        `The return value contains drafts, please don't use 'rawReturn()' to wrap the return value.`\n      );\n    }\n  }\n}\n\nfunction getCurrent(target: any) {\n  const proxyDraft = getProxyDraft(target);\n  if (!isDraftable(target, proxyDraft?.options)) return target;\n  const type = getType(target);\n  if (proxyDraft && !proxyDraft.operated) return proxyDraft.original;\n  let currentValue: any;\n  function ensureShallowCopy() {\n    currentValue =\n      type === DraftType.Map\n        ? new Map(target)\n        : type === DraftType.Set\n        ? Array.from(proxyDraft!.setMap!.values()!)\n        : shallowCopy(target, proxyDraft?.options);\n  }\n\n  if (proxyDraft) {\n    // It's a proxy draft, let's create a shallow copy eagerly\n    proxyDraft.finalized = true;\n    try {\n      ensureShallowCopy();\n    } finally {\n      proxyDraft.finalized = false;\n    }\n  } else {\n    // It's not a proxy draft, let's use the target directly and let's see\n    // lazily if we need to create a shallow copy\n    currentValue = target;\n  }\n\n  forEach(currentValue, (key, value) => {\n    if (proxyDraft && isEqual(get(proxyDraft.original, key), value)) return;\n    const newValue = getCurrent(value);\n    if (newValue !== value) {\n      if (currentValue === target) ensureShallowCopy();\n      set(currentValue, key, newValue);\n    }\n  });\n  return type === DraftType.Set ? new Set(currentValue) : currentValue;\n}\n\n/**\n * `current(draft)` to get current state in the draft mutation function.\n *\n * ## Example\n *\n * ```ts\n * import { create, current } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *     expect(current(draft.foo)).toEqual({ bar: 'str2' });\n *   },\n * );\n * ```\n */\nexport function current<T extends object>(target: T): T {\n  if (!isDraft(target)) {\n    throw new Error(`current() is only used for Draft, parameter: ${target}`);\n  }\n  return getCurrent(target);\n}\n", "import {\n  CreateResult,\n  Draft,\n  Mark,\n  Options,\n  ExternalOptions,\n  PatchesOptions,\n  Result,\n} from './interface';\nimport { draftify } from './draftify';\nimport {\n  getProxyDraft,\n  isDraft,\n  isDraftable,\n  isEqual,\n  revokeProxy,\n} from './utils';\nimport { current, handleReturnValue } from './current';\nimport { RAW_RETURN_SYMBOL, dataTypes } from './constant';\n\ntype MakeCreator = <\n  _F extends boolean = false,\n  _O extends PatchesOptions = false\n>(\n  options?: ExternalOptions<_O, _F>\n) => {\n  <\n    T extends any,\n    F extends boolean = _F,\n    O extends PatchesOptions = _O,\n    R extends void | Promise<void> | T | Promise<T> = void\n  >(\n    base: T,\n    mutate: (draft: Draft<T>) => R,\n    options?: ExternalOptions<O, F>\n  ): CreateResult<T, O, F, R>;\n  <\n    T extends any,\n    F extends boolean = _F,\n    O extends PatchesOptions = _O,\n    R extends void | Promise<void> = void\n  >(\n    base: T,\n    mutate: (draft: T) => R,\n    options?: ExternalOptions<O, F>\n  ): CreateResult<T, O, F, R>;\n  <\n    T extends any,\n    P extends any[] = [],\n    F extends boolean = _F,\n    O extends PatchesOptions = _O,\n    R extends void | Promise<void> = void\n  >(\n    mutate: (draft: Draft<T>, ...args: P) => R,\n    options?: ExternalOptions<O, F>\n  ): (base: T, ...args: P) => CreateResult<T, O, F, R>;\n  <T extends any, O extends PatchesOptions = _O, F extends boolean = _F>(\n    base: T,\n    options?: ExternalOptions<O, F>\n  ): [Draft<T>, () => Result<T, O, F>];\n};\n\n/**\n * `makeCreator(options)` to make a creator function.\n *\n * ## Example\n *\n * ```ts\n * import { makeCreator } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const create = makeCreator({ enableAutoFreeze: true });\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n * );\n *\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(state).not.toBe(baseState);\n * expect(state.foo).not.toBe(baseState.foo);\n * expect(state.arr).toBe(baseState.arr);\n * expect(Object.isFrozen(state)).toBeTruthy();\n * ```\n */\nexport const makeCreator: MakeCreator = (arg) => {\n  if (\n    __DEV__ &&\n    arg !== undefined &&\n    Object.prototype.toString.call(arg) !== '[object Object]'\n  ) {\n    throw new Error(\n      `Invalid options: ${String(arg)}, 'options' should be an object.`\n    );\n  }\n  return function create(arg0: any, arg1: any, arg2?: any): any {\n    if (typeof arg0 === 'function' && typeof arg1 !== 'function') {\n      return function (this: any, base: any, ...args: any[]) {\n        return create(\n          base,\n          (draft: any) => arg0.call(this, draft, ...args),\n          arg1\n        );\n      };\n    }\n    const base = arg0;\n    const mutate = arg1 as (...args: any[]) => any;\n    let options = arg2;\n    if (typeof arg1 !== 'function') {\n      options = arg1;\n    }\n    if (\n      __DEV__ &&\n      options !== undefined &&\n      Object.prototype.toString.call(options) !== '[object Object]'\n    ) {\n      throw new Error(\n        `Invalid options: ${options}, 'options' should be an object.`\n      );\n    }\n    options = {\n      ...arg,\n      ...options,\n    };\n    const state = isDraft(base) ? current(base) : base;\n    const mark = Array.isArray(options.mark)\n      ? (((value: unknown, types: typeof dataTypes) => {\n          for (const mark of options.mark as Mark<any, any>[]) {\n            if (__DEV__ && typeof mark !== 'function') {\n              throw new Error(\n                `Invalid mark: ${mark}, 'mark' should be a function.`\n              );\n            }\n            const result = mark(value, types);\n            if (result) {\n              return result;\n            }\n          }\n          return;\n        }) as Mark<any, any>)\n      : options.mark;\n    const enablePatches = options.enablePatches ?? false;\n    const strict = options.strict ?? false;\n    const enableAutoFreeze = options.enableAutoFreeze ?? false;\n    const _options: Options<any, any> = {\n      enableAutoFreeze,\n      mark,\n      strict,\n      enablePatches,\n    };\n    if (\n      !isDraftable(state, _options) &&\n      typeof state === 'object' &&\n      state !== null\n    ) {\n      throw new Error(\n        `Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.`\n      );\n    }\n    const [draft, finalize] = draftify(state, _options);\n    if (typeof arg1 !== 'function') {\n      if (!isDraftable(state, _options)) {\n        throw new Error(\n          `Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.`\n        );\n      }\n      return [draft, finalize];\n    }\n    let result: any;\n    try {\n      result = mutate(draft);\n    } catch (error) {\n      revokeProxy(getProxyDraft(draft));\n      throw error;\n    }\n    const returnValue = (value: any) => {\n      const proxyDraft = getProxyDraft(draft)!;\n      if (!isDraft(value)) {\n        if (\n          value !== undefined &&\n          !isEqual(value, draft) &&\n          proxyDraft?.operated\n        ) {\n          throw new Error(\n            `Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.`\n          );\n        }\n        const rawReturnValue = value?.[RAW_RETURN_SYMBOL] as [any] | undefined;\n        if (rawReturnValue) {\n          const _value = rawReturnValue[0];\n          if (_options.strict && typeof value === 'object' && value !== null) {\n            handleReturnValue({\n              rootDraft: proxyDraft,\n              value,\n              useRawReturn: true,\n            });\n          }\n          return finalize([_value]);\n        }\n        if (value !== undefined) {\n          if (typeof value === 'object' && value !== null) {\n            handleReturnValue({ rootDraft: proxyDraft, value });\n          }\n          return finalize([value]);\n        }\n      }\n      if (value === draft || value === undefined) {\n        return finalize([]);\n      }\n      const returnedProxyDraft = getProxyDraft(value)!;\n      if (_options === returnedProxyDraft.options) {\n        if (returnedProxyDraft.operated) {\n          throw new Error(`Cannot return a modified child draft.`);\n        }\n        return finalize([current(value)]);\n      }\n      return finalize([value]);\n    };\n    if (result instanceof Promise) {\n      return result.then(returnValue, (error) => {\n        revokeProxy(getProxyDraft(draft)!);\n        throw error;\n      });\n    }\n    return returnValue(result);\n  };\n};\n", "import { makeCreator } from './makeCreator';\n\n/**\n * `create(baseState, callback, options)` to create the next state\n *\n * ## Example\n *\n * ```ts\n * import { create } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n * );\n *\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(state).not.toBe(baseState);\n * expect(state.foo).not.toBe(baseState.foo);\n * expect(state.arr).toBe(baseState.arr);\n * ```\n */\nconst create = makeCreator();\n\nexport { create };\n", "import { Draft, Options, Patches, DraftType, Operation } from './interface';\nimport { deepClone, get, getType, isDraft, unescapePath } from './utils';\nimport { create } from './create';\n\n/**\n * `apply(state, patches)` to apply patches to state\n *\n * ## Example\n *\n * ```ts\n * import { create, apply } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const [state, patches] = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *   },\n *   { enablePatches: true }\n * );\n * expect(state).toEqual({ foo: { bar: 'str2' }, arr: [] });\n * expect(patches).toEqual([{ op: 'replace', path: ['foo', 'bar'], value: 'str2' }]);\n * expect(state).toEqual(apply(baseState, patches));\n * ```\n */\nexport function apply<T extends object, F extends boolean = false>(\n  state: T,\n  patches: Patches,\n  applyOptions?: Pick<\n    Options<boolean, F>,\n    Exclude<keyof Options<boolean, F>, 'enablePatches'>\n  >\n) {\n  let i: number;\n  for (i = patches.length - 1; i >= 0; i -= 1) {\n    const { value, op, path } = patches[i];\n    if (\n      (!path.length && op === Operation.Replace) ||\n      (path === '' && op === Operation.Add)\n    ) {\n      state = value;\n      break;\n    }\n  }\n  if (i > -1) {\n    patches = patches.slice(i + 1);\n  }\n  const mutate = (draft: Draft<T>) => {\n    patches.forEach((patch) => {\n      const { path: _path, op } = patch;\n      const path = unescapePath(_path);\n      let base: any = draft;\n      for (let index = 0; index < path.length - 1; index += 1) {\n        const parentType = getType(base);\n        let key = path[index];\n        if (typeof key !== 'string' && typeof key !== 'number') {\n          key = String(key);\n        }\n        if (\n          ((parentType === DraftType.Object ||\n            parentType === DraftType.Array) &&\n            (key === '__proto__' || key === 'constructor')) ||\n          (typeof base === 'function' && key === 'prototype')\n        ) {\n          throw new Error(\n            `Patching reserved attributes like __proto__ and constructor is not allowed.`\n          );\n        }\n        // use `index` in Set draft\n        base = get(parentType === DraftType.Set ? Array.from(base) : base, key);\n        if (typeof base !== 'object') {\n          throw new Error(`Cannot apply patch at '${path.join('/')}'.`);\n        }\n      }\n\n      const type = getType(base);\n      // ensure the original patch is not modified.\n      const value = deepClone(patch.value);\n      const key = path[path.length - 1];\n      switch (op) {\n        case Operation.Replace:\n          switch (type) {\n            case DraftType.Map:\n              return base.set(key, value);\n            case DraftType.Set:\n              throw new Error(`Cannot apply replace patch to set.`);\n            default:\n              return (base[key] = value);\n          }\n        case Operation.Add:\n          switch (type) {\n            case DraftType.Array:\n              // If the \"-\" character is used to\n              // index the end of the array (see [RFC6901](https://datatracker.ietf.org/doc/html/rfc6902)),\n              // this has the effect of appending the value to the array.\n              return key === '-'\n                ? base.push(value)\n                : base.splice(key as number, 0, value);\n            case DraftType.Map:\n              return base.set(key, value);\n            case DraftType.Set:\n              return base.add(value);\n            default:\n              return (base[key] = value);\n          }\n        case Operation.Remove:\n          switch (type) {\n            case DraftType.Array:\n              return base.splice(key as number, 1);\n            case DraftType.Map:\n              return base.delete(key);\n            case DraftType.Set:\n              return base.delete(patch.value);\n            default:\n              return delete base[key];\n          }\n        default:\n          throw new Error(`Unsupported patch operation: ${op}.`);\n      }\n    });\n  };\n  if (isDraft(state)) {\n    if (applyOptions !== undefined) {\n      throw new Error(`Cannot apply patches with options to a draft.`);\n    }\n    mutate(state as Draft<T>);\n    return state;\n  }\n  return create<T, F>(state, mutate, {\n    ...applyOptions,\n    enablePatches: false,\n  });\n}\n", "import { getProxyDraft } from './utils';\n\n/**\n * `original(draft)` to get original state in the draft mutation function.\n *\n * ## Example\n *\n * ```ts\n * import { create, original } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     draft.foo.bar = 'str2';\n *     expect(original(draft.foo)).toEqual({ bar: 'str' });\n *   }\n * );\n * ```\n */\nexport function original<T>(target: T): T {\n  const proxyDraft = getProxyDraft(target);\n  if (!proxyDraft) {\n    throw new Error(\n      `original() is only used for a draft, parameter: ${target}`\n    );\n  }\n  return proxyDraft.original;\n}\n", "import { RAW_RETURN_SYMBOL } from './constant';\n\n/**\n * Use rawReturn() to wrap the return value to skip the draft check and thus improve performance.\n *\n * ## Example\n *\n * ```ts\n * import { create, rawReturn } from '../index';\n *\n * const baseState = { foo: { bar: 'str' }, arr: [] };\n * const state = create(\n *   baseState,\n *   (draft) => {\n *     return rawReturn(baseState);\n *   },\n * );\n * expect(state).toBe(baseState);\n * ```\n */\nexport function rawReturn<T extends object | undefined>(value: T): T {\n  if (arguments.length === 0) {\n    throw new Error('rawReturn() must be called with a value.');\n  }\n  if (arguments.length > 1) {\n    throw new Error('rawReturn() must be called with one argument.');\n  }\n  if (\n    __DEV__ &&\n    value !== undefined &&\n    (typeof value !== 'object' || value === null)\n  ) {\n    console.warn(\n      'rawReturn() must be called with an object(including plain object, arrays, Set, Map, etc.) or `undefined`, other types do not need to be returned via rawReturn().'\n    );\n  }\n  return {\n    [RAW_RETURN_SYMBOL]: [value],\n  } as never;\n}\n", "import { dataTypes } from '../constant';\n\nconst constructorString = Object.prototype.constructor.toString();\n/**\n * Check if the value is a simple object(No prototype chain object or iframe same-origin object),\n * support case: https://github.com/unadlib/mutative/issues/17\n */\nconst isSimpleObject = (value: unknown) => {\n  if (!value || typeof value !== 'object') return false;\n  const prototype = Object.getPrototypeOf(value);\n  if (prototype === null) {\n    return true;\n  }\n  const constructor =\n    Object.hasOwnProperty.call(prototype, 'constructor') &&\n    prototype.constructor;\n\n  if (constructor === Object) return true;\n\n  return (\n    typeof constructor === 'function' &&\n    Function.toString.call(constructor) === constructorString\n  );\n};\n\nexport const markSimpleObject = (value: unknown) => {\n  if (isSimpleObject(value)) {\n    return dataTypes.immutable;\n  }\n  return;\n};\n", "import { Draft, Immutable } from '../interface';\n\n/**\n * Cast a value to an Draft type value.\n */\nexport function castDraft<T>(value: T): Draft<T> {\n  return value as any;\n}\n\n/**\n * Cast a value to an Immutable type value.\n */\nexport function castImmutable<T>(value: T): Immutable<T> {\n  return value as any;\n}\n", "export function areObjectKeysEqual(a, b) {\n  const ak = Object.keys(a);\n  const bk = Object.keys(b);\n  return (\n    ak.length === bk.length && Object.keys(a).every((k) => b.hasOwnProperty(k))\n  );\n}\n\nexport function areObjectsShallowEqual(obj1, obj2) {\n  return (\n    Object.keys(obj1).length === Object.keys(obj2).length &&\n    Object.keys(obj1).every(\n      (key) => obj2.hasOwnProperty(key) && obj1[key] === obj2[key],\n    )\n  );\n}\n\nexport function areObjectsDeepEqual(obj1, obj2) {\n  if (\n    typeof obj1 !== \"object\" ||\n    typeof obj2 !== \"object\" ||\n    obj1 === null ||\n    obj2 === null\n  ) {\n    return obj1 === obj2;\n  }\n\n  if (!areObjectKeysEqual(obj1, obj2)) {\n    return false;\n  }\n\n  return Object.keys(obj1).every((key) =>\n    areObjectsDeepEqual(obj1[key], obj2[key]),\n  );\n}\n\nexport function immutableDeepMerge(target, source) {\n  if (!isObject(target) || !isObject(source)) {\n    return source;\n  }\n\n  const result = {};\n\n  for (const key of Object.keys(target)) {\n    if (source[key] === null) continue;\n\n    result[key] = target[key];\n  }\n\n  for (const key of Object.keys(source)) {\n    if (source[key] === null) continue;\n\n    const areBothObjects = isObject(target[key]) && isObject(source[key]);\n\n    result[key] = areBothObjects\n      ? immutableDeepMerge(target[key], source[key])\n      : source[key];\n  }\n\n  return result;\n}\n\nexport function immutableDeepReplace(target, replaceValue, replacementValue) {\n  if (!isObject(target)) {\n    return target;\n  }\n\n  const result = {};\n\n  for (const [key, value] of Object.entries(target)) {\n    result[key] = isObject(value)\n      ? immutableDeepReplace(value, replaceValue, replacementValue)\n      : value === replaceValue\n        ? replacementValue\n        : value;\n  }\n\n  return result;\n}\n\nexport function isObject(val) {\n  return typeof val === \"object\" && val !== null && !Array.isArray(val);\n}\n", "import { create } from \"mutative\";\nimport { immutableDeepMerge } from \"./utils/object\";\n\nfunction hasEA(attr) {\n  return attr[\"cardinality\"] === \"one\";\n}\n\nfunction isRef(attr) {\n  return attr[\"value-type\"] === \"ref\";\n}\n\nfunction isBlob(attr) {\n  return attr[\"value-type\"] === \"blob\";\n}\n\nfunction getAttr(attrs, attrId) {\n  return attrs[attrId];\n}\n\nfunction getInMap(obj, path) {\n  return path.reduce((acc, key) => acc && acc.get(key), obj);\n}\n\nfunction deleteInMap(m, path) {\n  if (path.length === 0) throw new Error(\"path must have at least one element\");\n  if (path.length === 1) {\n    m.delete(path[0]);\n    return;\n  }\n  const [head, ...tail] = path;\n  if (!m.has(head)) return;\n  deleteInMap(m.get(head), tail);\n}\n\nfunction setInMap(m, path, value) {\n  if (path.length === 0) throw new Error(\"path must have at least one element\");\n  if (path.length === 1) {\n    m.set(path[0], value);\n    return;\n  }\n  const [head, ...tail] = path;\n  let nextM = m.get(head);\n  if (!nextM) {\n    nextM = new Map();\n    m.set(head, nextM);\n  }\n  setInMap(nextM, tail, value);\n}\n\nfunction createIndexMap(attrs, triples) {\n  const eav = new Map();\n  const aev = new Map();\n  const vae = new Map();\n  for (const triple of triples) {\n    const [eid, aid, v, t] = triple;\n    const attr = getAttr(attrs, aid);\n    if (!attr) {\n      console.warn(\"no such attr\", eid, attrs);\n      continue;\n    }\n\n    if (isRef(attr)) {\n      setInMap(vae, [v, aid, eid], triple);\n    }\n\n    setInMap(eav, [eid, aid, v], triple);\n    setInMap(aev, [aid, eid, v], triple);\n  }\n  return { eav, aev, vae };\n}\n\nexport function blobAttrs({ attrs }, etype) {\n  return Object.values(attrs)\n    .filter((attr) => isBlob(attr) && attr['forward-identity'][1] === etype);\n}\n\nexport function getAsObject(store, attrs, e) {\n  const obj = {}; \n  for (const attr of attrs) { \n    const aMap = store.eav.get(e)?.get(attr.id);\n    const vs = allMapValues(aMap, 1);\n    for (const v of vs) {  \n      obj[attr['forward-identity'][2]] = v[2];\n    }\n  }\n  return obj;\n}\n\nexport function toJSON(store) {\n  return {\n    __type: store.__type,\n    attrs: store.attrs,\n    triples: allMapValues(store.eav, 3),\n    cardinalityInference: store.cardinalityInference,\n    linkIndex: store.linkIndex,\n  };\n}\n\nexport function fromJSON(storeJSON) {\n  return createStore(\n    storeJSON.attrs,\n    storeJSON.triples,\n    storeJSON.cardinalityInference,\n    storeJSON.linkIndex,\n  );\n}\n\nexport function createStore(\n  attrs,\n  triples,\n  enableCardinalityInference,\n  linkIndex,\n) {\n  const store = createIndexMap(attrs, triples);\n  store.attrs = attrs;\n  store.cardinalityInference = enableCardinalityInference;\n  store.linkIndex = linkIndex;\n  store.__type = \"store\";\n\n  return store;\n}\n\n// We may have local triples with lookup refs in them,\n// we need to convert those lookup refs to eids to insert them\n// into the store. If we can't find the lookup ref locally,\n// then we drop the triple and have to wait for the server response\n// to see the optimistic updates.\nfunction resolveLookupRefs(store, triple) {\n  let eid;\n\n  // Check if `e` is a lookup ref\n  if (Array.isArray(triple[0])) {\n    const [a, v] = triple[0];\n    const eMaps = store.aev.get(a);\n    if (!eMaps) {\n      // We don't have the attr, so don't try to add the\n      // triple to the store\n      return null;\n    }\n    // This would be a lot more efficient with a ave index\n    const triples = allMapValues(eMaps, 2);\n    eid = triples.find((x) => x[2] === v)?.[0];\n  } else {\n    eid = triple[0];\n  }\n\n  if (!eid) {\n    // We don't know the eid that the ref refers to, so\n    // we can't add the triple to the store.\n    return null;\n  }\n\n  // Check if v is a lookup ref\n  const lookupV = triple[2];\n  if (\n    Array.isArray(lookupV) &&\n    lookupV.length === 2 &&\n    store.aev.get(lookupV[0])\n  ) {\n    const [a, v] = lookupV;\n    const eMaps = store.aev.get(a);\n    if (!eMaps) {\n      // We don't have the attr, so don't try to add the\n      // triple to the store\n      return null;\n    }\n    const triples = allMapValues(eMaps, 2);\n    const value = triples.find((x) => x[2] === v)?.[0];\n    if (!value) {\n      return null;\n    }\n    const [_e, aid, _v, ...rest] = triple;\n    return [eid, aid, value, ...rest];\n  } else {\n    const [_, ...rest] = triple;\n    return [eid, ...rest];\n  }\n}\n\nfunction retractTriple(store, rawTriple) {\n  const triple = resolveLookupRefs(store, rawTriple);\n  if (!triple) {\n    return;\n  }\n  const [eid, aid, v] = triple;\n  const attr = getAttr(store.attrs, aid);\n  if (!attr) {\n    return;\n  }\n\n  deleteInMap(store.eav, [eid, aid, v]);\n  deleteInMap(store.aev, [aid, eid, v]);\n  if (isRef(attr)) {\n    deleteInMap(store.vae, [v, aid, eid]);\n  }\n}\n\nlet _seed = 0;\nfunction getCreatedAt(store, attr, triple) {\n  const [eid, aid, v] = triple;\n  let createdAt;\n  const t = getInMap(store.ea, [eid, aid, v]);\n  if (t) {\n    createdAt = t[3];\n  }\n\n  /**\n   * (XXX)\n   * Two hacks here, for generating a `createdAt`\n   *\n   * 1. We multiply Date.now() by 10, to make sure that\n   *  `createdAt` is always greater than anything the server\n   *   could return\n   *\n   *   We do this because right now we know we _only_ insert\n   *   triples as optimistic updates.\n   *\n   * 2. We increment by `_seed`, to make sure there are no\n   *    two triples with the same `createdAt`. This is\n   *    done to make tests more predictable.\n   *\n   * We may need to rethink this. Because we * 10, we can't\n   * use this value as an _actual_ `createdAt` timestamp.\n   * Eventually we may want too though; For example, we could\n   * use `createdAt` for each triple, to infer a `createdAt` and\n   * `updatedAt` value for each object.\n   */\n  return createdAt || Date.now() * 10 + _seed++;\n}\n\nfunction addTriple(store, rawTriple) {\n  const triple = resolveLookupRefs(store, rawTriple);\n  if (!triple) {\n    return;\n  }\n  const [eid, aid, v] = triple;\n  const attr = getAttr(store.attrs, aid);\n  if (!attr) {\n    // (XXX): Due to the way we're handling attrs, it's\n    // possible to enter a state where we receive a triple without an attr.\n    // See: https://github.com/jsventures/instant-local/pull/132 for details.\n    // For now, if we receive a command without an attr, we no-op.\n    return;\n  }\n\n  const existingTriple = getInMap(store.eav, [eid, aid, v]);\n  // Reuse the created_at for a triple if it's already in the store.\n  // Prevents updates from temporarily pushing an entity to the top\n  // while waiting for the server response.\n  const t = existingTriple?.[3] ?? getCreatedAt(store, attr, triple);\n  const enhancedTriple = [eid, aid, v, t];\n\n  if (hasEA(attr)) {\n    setInMap(store.eav, [eid, aid], new Map([[v, enhancedTriple]]));\n    setInMap(store.aev, [aid, eid], new Map([[v, enhancedTriple]]));\n  } else {\n    setInMap(store.eav, [eid, aid, v], enhancedTriple);\n    setInMap(store.aev, [aid, eid, v], enhancedTriple);\n  }\n\n  if (isRef(attr)) {\n    setInMap(store.vae, [v, aid, eid], enhancedTriple);\n  }\n}\n\nfunction mergeTriple(store, rawTriple) {\n  const triple = resolveLookupRefs(store, rawTriple);\n  if (!triple) {\n    return;\n  }\n\n  const [eid, aid, update] = triple;\n  const attr = getAttr(store.attrs, aid);\n\n  if (!attr) return;\n\n  if (!isBlob(attr))\n    throw new Error(\"merge operation is not supported for links\");\n\n  const eavValuesMap = getInMap(store.eav, [eid, aid]);\n  if (!eavValuesMap) return;\n\n  const currentTriple = eavValuesMap.values().next()?.value;\n  if (!currentTriple) return;\n\n  const currentValue = currentTriple[2];\n  const updatedValue = immutableDeepMerge(currentValue, update);\n  const enhancedTriple = [\n    eid,\n    aid,\n    updatedValue,\n    getCreatedAt(store, attr, currentTriple),\n  ];\n\n  setInMap(store.eav, [eid, aid], new Map([[updatedValue, enhancedTriple]]));\n}\n\nfunction deleteEntity(store, args) {\n  const [lookup, etype] = args;\n  const triple = resolveLookupRefs(store, [lookup]);\n\n  if (!triple) {\n    return;\n  }\n  const [id] = triple;\n\n  // delete forward links and attributes + cardinality one links\n  const eMap = store.eav.get(id);\n  if (eMap) {\n    for (const a of eMap.keys()) {\n      const attr = store.attrs[a];\n      if (\n        // Fall back to deleting everything if we've rehydrated tx-steps from\n        // the store that didn't set `etype` in deleteEntity\n        !etype ||\n        // If we don't know about the attr, let's just get rid of it\n        !attr ||\n        // Make sure it matches the etype\n        attr[\"forward-identity\"]?.[1] === etype\n      ) {\n        deleteInMap(store.aev, [a, id]);\n        deleteInMap(store.eav, [id, a]);\n      }\n    }\n    // Clear out the eav index for `id` if we deleted all of the attributes\n    if (eMap.size === 0) {\n      deleteInMap(store.eav, [id]);\n    }\n  }\n\n  // delete reverse links\n  const vaeTriples = store.vae.get(id) && allMapValues(store.vae.get(id), 2);\n\n  if (vaeTriples) {\n    vaeTriples.forEach((triple) => {\n      const [e, a, v] = triple;\n      const attr = store.attrs[a];\n      if (!etype || !attr || attr[\"reverse-identity\"]?.[1] === etype) {\n        deleteInMap(store.eav, [e, a, v]);\n        deleteInMap(store.aev, [a, e, v]);\n        deleteInMap(store.vae, [v, a, e]);\n      }\n    });\n  }\n  // Clear out vae index for `id` if we deleted all the reverse attributes\n  if (store.vae.get(id)?.size === 0) {\n    deleteInMap(store.vae, [id]);\n  }\n}\n\n// (XXX): Whenever we change/delete attrs,\n// We indiscriminately reset the index map.\n// There are lots of opportunities for optimization:\n// * We _only_ need to run this indexes change. We could detect that\n// * We could batch this reset at the end\n// * We could add an ave index for all triples, so removing the\n//   right triples is easy and fast.\nfunction resetIndexMap(store, newTriples) {\n  const newIndexMap = createIndexMap(store.attrs, newTriples);\n  Object.keys(newIndexMap).forEach((key) => {\n    store[key] = newIndexMap[key];\n  });\n}\n\nfunction addAttr(store, [attr]) {\n  store.attrs[attr.id] = attr;\n}\n\nfunction getAllTriples(store) {\n  return allMapValues(store.eav, 3);\n}\n\nfunction deleteAttr(store, [id]) {\n  if (!store.attrs[id]) return;\n  const newTriples = getAllTriples(store).filter(([_, aid]) => aid !== id);\n  delete store.attrs[id];\n  resetIndexMap(store, newTriples);\n}\n\nfunction updateAttr(store, [partialAttr]) {\n  const attr = store.attrs[partialAttr.id];\n  if (!attr) return;\n  store.attrs[partialAttr.id] = { ...attr, ...partialAttr };\n  resetIndexMap(store, getAllTriples(store));\n}\n\nfunction applyTxStep(store, txStep) {\n  const [action, ...args] = txStep;\n  switch (action) {\n    case \"add-triple\":\n      addTriple(store, args);\n      break;\n    case \"deep-merge-triple\":\n      mergeTriple(store, args);\n      break;\n    case \"retract-triple\":\n      retractTriple(store, args);\n      break;\n    case \"delete-entity\":\n      deleteEntity(store, args);\n      break;\n    case \"add-attr\":\n      addAttr(store, args);\n      break;\n    case \"delete-attr\":\n      deleteAttr(store, args);\n      break;\n    case \"update-attr\":\n      updateAttr(store, args);\n      break;\n    default:\n      throw new Error(`unhandled transaction action: ${action}`);\n  }\n}\n\nexport function allMapValues(m, level, res = []) {\n  if (!m) {\n    return res;\n  }\n  if (level === 0) {\n    return res;\n  }\n  if (level === 1) {\n    for (const v of m.values()) {\n      res.push(v);\n    }\n    return res;\n  }\n  for (const v of m.values()) {\n    allMapValues(v, level - 1, res);\n  }\n\n  return res;\n}\n\nfunction triplesByValue(m, v) {\n  const res = [];\n  const values = v.in ? v.in : [v];\n\n  for (const value of values) {\n    const triple = m.get(value);\n    if (triple) {\n      res.push(triple);\n    }\n  }\n  return res;\n}\n\n// A poor man's pattern matching\n// Returns either eav, ea, ev, av, v, or ''\nfunction whichIdx(e, a, v) {\n  let res = \"\";\n  if (e !== undefined) {\n    res += \"e\";\n  }\n  if (a !== undefined) {\n    res += \"a\";\n  }\n  if (v !== undefined) {\n    res += \"v\";\n  }\n  return res;\n}\n\nexport function getTriples(store, [e, a, v]) {\n  const idx = whichIdx(e, a, v);\n  switch (idx) {\n    case \"e\": {\n      const eMap = store.eav.get(e);\n      return allMapValues(eMap, 2);\n    }\n    case \"ea\": {\n      const aMap = store.eav.get(e)?.get(a);\n      return allMapValues(aMap, 1);\n    }\n    case \"eav\": {\n      const aMap = store.eav.get(e)?.get(a);\n      if (!aMap) {\n        return [];\n      }\n      return triplesByValue(aMap, v);\n    }\n    case \"ev\": {\n      const eMap = store.eav.get(e);\n      if (!eMap) {\n        return [];\n      }\n      const res = [];\n      for (const aMap of eMap.values()) {\n        res.push(...triplesByValue(aMap, v));\n      }\n      return res;\n    }\n    case \"a\": {\n      const aMap = store.aev.get(a)\n      return allMapValues(aMap, 2);\n    }\n    case \"av\": {\n      const aMap = store.aev.get(a);\n      if (!aMap) {\n        return [];\n      }\n      const res = [];\n      for (const eMap of aMap.values()) {\n        res.push(...triplesByValue(eMap, v));\n      }\n      return res;\n    }\n    case \"v\": {\n      const res = [];\n      for (const eMap of store.eav.values()) {\n        for (const aMap of eMap.values()) {\n          res.push(...triplesByValue(aMap, v));\n        }\n      }\n    }\n    default: {\n      return allMapValues(store.eav, 3);\n    }\n  }\n}\n\nexport function transact(store, txSteps) {\n  return create(store, (draft) => {\n    txSteps.forEach((txStep) => {\n      applyTxStep(draft, txStep);\n    });\n  });\n}\n", "// 1. patternMatch\nimport { getTriples } from \"./store.js\";\n\nfunction isVariable(x) {\n  return typeof x === \"string\" && x.startsWith(\"?\");\n}\n\nfunction matchVariable(variable, triplePart, context) {\n  if (context.hasOwnProperty(variable)) {\n    const bound = context[variable];\n    return matchPart(bound, triplePart, context);\n  }\n  return { ...context, [variable]: triplePart };\n}\n\nfunction matchExact(patternPart, triplePart, context) {\n  return patternPart === triplePart ? context : null;\n}\n\nfunction matchWithArgMap(patternPart, triplePart, context) {\n  const { in: inList } = patternPart;\n  if (inList && inList.includes(triplePart)) {\n    return context;\n  }\n  return null;\n}\n\nfunction matcherForPatternPart(patternPart) {\n  switch (typeof patternPart) {\n    case \"string\":\n      return patternPart.startsWith(\"?\") ? matchVariable : matchExact;\n    case \"object\":\n      return matchWithArgMap;\n    default:\n      return matchExact;\n  }\n}\n\nfunction matchPart(patternPart, triplePart, context) {\n  if (!context) return null;\n  const matcher = matcherForPatternPart(patternPart);\n  return matcher(patternPart, triplePart, context);\n}\n\nexport function matchPattern(pattern, triple, context) {\n  return pattern.reduce((context, patternPart, idx) => {\n    const triplePart = triple[idx];\n    return matchPart(patternPart, triplePart, context);\n  }, context);\n}\n\n// 2. querySingle\n\nexport function querySingle(store, pattern, context) {\n  return relevantTriples(store, pattern, context)\n    .map((triple) => matchPattern(pattern, triple, context))\n    .filter((x) => x);\n}\n\n// 3. queryWhere\n\nfunction queryPattern(store, pattern, contexts) {\n  if (pattern.or) {\n    return pattern.or.patterns.flatMap((patterns) => {\n      return queryWhere(store, patterns, contexts);\n    });\n  }\n  if (pattern.and) {\n    return pattern.and.patterns.reduce((contexts, patterns) => {\n      return queryWhere(store, patterns, contexts);\n    }, contexts);\n  }\n  return contexts.flatMap((context) => querySingle(store, pattern, context));\n}\n\nexport function queryWhere(store, patterns, contexts = [{}]) {\n  return patterns.reduce((contexts, pattern) => {\n    return queryPattern(store, pattern, contexts);\n  }, contexts);\n}\n\n// 4. query\n\nfunction actualize(context, find) {\n  if (Array.isArray(find)) {\n    return find.map((findPart) => actualize(context, findPart));\n  }\n  return isVariable(find) ? context[find] : find;\n}\n\nexport function query(store, { find, where }) {\n  const contexts = queryWhere(store, where);\n  return contexts.map((context) => actualize(context, find));\n}\n\n// 5. Index\n\nfunction relevantTriples(store, pattern, context) {\n  return getTriples(store, actualize(context, pattern));\n}\n", "// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}", "export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;", "import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;", "import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;", "import validate from './validate.js';\n\nfunction parse(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  let v;\n  const arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nexport default parse;", "import { unsafeStringify } from './stringify.js';\nimport parse from './parse.js';\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  const bytes = [];\n\n  for (let i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function v35(name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    var _namespace;\n\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = parse(namespace);\n    }\n\n    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    let bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (let i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return unsafeStringify(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}", "/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  const output = [];\n  const length32 = input.length * 32;\n  const hexTab = '0123456789abcdef';\n\n  for (let i = 0; i < length32; i += 8) {\n    const x = input[i >> 5] >>> i % 32 & 0xff;\n    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  let a = 1732584193;\n  let b = -271733879;\n  let c = -1732584194;\n  let d = 271733878;\n\n  for (let i = 0; i < x.length; i += 16) {\n    const olda = a;\n    const oldb = b;\n    const oldc = c;\n    const oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  const length8 = input.length * 8;\n  const output = new Uint32Array(getOutputLength(length8));\n\n  for (let i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  const lsw = (x & 0xffff) + (y & 0xffff);\n  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nexport default md5;", "import v35 from './v35.js';\nimport md5 from './md5.js';\nconst v3 = v35('v3', 0x30, md5);\nexport default v3;", "const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};", "import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;", "// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  const l = bytes.length / 4 + 2;\n  const N = Math.ceil(l / 16);\n  const M = new Array(N);\n\n  for (let i = 0; i < N; ++i) {\n    const arr = new Uint32Array(16);\n\n    for (let j = 0; j < 16; ++j) {\n      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n\n    M[i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (let i = 0; i < N; ++i) {\n    const W = new Uint32Array(80);\n\n    for (let t = 0; t < 16; ++t) {\n      W[t] = M[i][t];\n    }\n\n    for (let t = 16; t < 80; ++t) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n\n    for (let t = 0; t < 80; ++t) {\n      const s = Math.floor(t / 20);\n      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;", "import v35 from './v35.js';\nimport sha1 from './sha1.js';\nconst v5 = v35('v5', 0x50, sha1);\nexport default v5;", "import { v4 } from \"uuid\";\n\nfunction uuidToByteArray(uuid: string) {\n  const hex = uuid.replace(/-/g, \"\");\n  const bytes = [];\n  for (let i = 0; i < hex.length; i += 2) {\n    bytes.push(parseInt(hex.substring(i, i + 2), 16));\n  }\n  return bytes;\n}\n\nfunction compareByteArrays(a, b) {\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] < b[i]) return -1;\n    if (a[i] > b[i]) return 1;\n  }\n  return 0;\n}\n\nexport function uuidCompare(uuid_a: string, uuid_b: string) {\n  return compareByteArrays(uuidToByteArray(uuid_a), uuidToByteArray(uuid_b));\n}\n\nfunction id(): string {\n  return v4();\n}\n\nexport default id;\n", "import type { DataAttrDef, InstantGraph, LinkAttrDef } from \"./schemaTypes\";\n\ntype Action = \"update\" | \"link\" | \"unlink\" | \"delete\" | \"merge\";\ntype EType = string;\ntype Id = string;\ntype Args = any;\ntype LookupRef = [string, any];\ntype Lookup = string;\nexport type Op = [Action, EType, Id | LookupRef, Args];\n\ntype UpdateParams<\n  Schema extends InstantGraph<any, any>,\n  EntityName extends keyof Schema[\"entities\"],\n> = {\n  [AttrName in keyof Schema[\"entities\"][EntityName][\"attrs\"]]?: Schema[\"entities\"][EntityName][\"attrs\"][AttrName] extends DataAttrDef<\n    infer ValueType,\n    infer IsRequired\n  >\n    ? IsRequired extends true\n      ? ValueType\n      : ValueType | null\n    : never;\n} & (Schema extends InstantGraph<any, any>\n  ? {}\n  : {\n      [attribute: string]: any;\n    });\n\ntype LinkParams<\n  Schema extends InstantGraph<any, any>,\n  EntityName extends keyof Schema[\"entities\"],\n> = {\n  [LinkName in keyof Schema[\"entities\"][EntityName][\"links\"]]?: Schema[\"entities\"][EntityName][\"links\"][LinkName] extends LinkAttrDef<\n    infer Cardinality,\n    any\n  >\n    ? Cardinality extends \"one\"\n      ? string\n      : string | string[]\n    : never;\n} & (Schema extends InstantGraph<any, any> ? {} : { [attribute: string]: any });\n\nexport interface TransactionChunk<\n  Schema extends InstantGraph<any, any, any>,\n  EntityName extends keyof Schema[\"entities\"],\n> {\n  __ops: Op[];\n  /**\n   * Create and update objects:\n   *\n   * @example\n   *  const goalId = id();\n   *  tx.goals[goalId].update({title: \"Get fit\", difficulty: 5})\n   */\n  update: (\n    args: UpdateParams<Schema, EntityName>,\n  ) => TransactionChunk<Schema, EntityName>;\n  /**\n   * Link two objects together\n   *\n   * @example\n   * const goalId = id();\n   * const todoId = id();\n   * db.transact([\n   *   tx.goals[goalId].update({title: \"Get fit\"}),\n   *   tx.todos[todoId].update({title: \"Go on a run\"}),\n   *   tx.goals[goalId].link({todos: todoId}),\n   * ])\n   *\n   * // Now, if you query:\n   * useQuery({ goals: { todos: {} } })\n   * // You'll get back:\n   *\n   * // { goals: [{ title: \"Get fit\", todos: [{ title: \"Go on a run\" }]}\n   */\n  link: (\n    args: LinkParams<Schema, EntityName>,\n  ) => TransactionChunk<Schema, EntityName>;\n  /**\n   * Unlink two objects\n   * @example\n   *  // to \"unlink\" a todo from a goal:\n   *  tx.goals[goalId].unlink({todos: todoId})\n   */\n  unlink: (\n    args: LinkParams<Schema, EntityName>,\n  ) => TransactionChunk<Schema, EntityName>;\n  /**\n   * Delete an object, alongside all of its links.\n   *\n   * @example\n   *   tx.goals[goalId].delete()\n   */\n  delete: () => TransactionChunk<Schema, EntityName>;\n\n  /**\n   *\n   * Similar to `update`, but instead of overwriting the current value, it will merge the provided values into the current value.\n   *\n   * This is useful for deeply nested, document-style values, or for updating a single attribute at an arbitrary depth without overwriting the rest of the object.\n   *\n   * For example, if you have a goal with a nested `metrics` object:\n   *\n   * ```js\n   * goal = { name: \"Get fit\", metrics: { progress: 0.3 } }\n   * ```\n   *\n   * You can update the `progress` attribute like so:\n   *\n   * ```js\n   * tx.goals[goalId].merge({ metrics: { progress: 0.5 }, category: \"Fitness\" })\n   * ```\n   *\n   * And the resulting object will be:\n   *\n   * ```js\n   * goal = { name: \"Get fit\", metrics: { progress: 0.5 }, category: \"Fitness\"  }\n   *  ```\n   *\n   * @example\n   *  const goalId = id();\n   *  tx.goals[goalId].merge({title: \"Get fitter\"})\n   */\n  merge: (args: {\n    [attribute: string]: any;\n  }) => TransactionChunk<Schema, EntityName>;\n}\n\nexport interface ETypeChunk<\n  Schema extends InstantGraph<any, any>,\n  EntityName extends keyof Schema[\"entities\"],\n> {\n  [id: Id]: TransactionChunk<Schema, EntityName>;\n}\n\nexport type TxChunk<Schema extends InstantGraph<any, any>> = {\n  [EntityName in keyof Schema[\"entities\"]]: ETypeChunk<Schema, EntityName>;\n};\n\nfunction transactionChunk(\n  etype: EType,\n  id: Id | LookupRef,\n  prevOps: Op[],\n): TransactionChunk<any, any> {\n  return new Proxy({} as TransactionChunk<any, any>, {\n    get: (_target, cmd: keyof TransactionChunk<any, any>) => {\n      if (cmd === \"__ops\") return prevOps;\n      return (args: Args) => {\n        return transactionChunk(etype, id, [\n          ...prevOps,\n          [cmd, etype, id, args],\n        ]);\n      };\n    },\n  });\n}\n\n/**\n * Creates a lookup to use in place of an id in a transaction\n *\n * @example\n * tx.users[lookup('email', 'lyndon@example.com')].update({name: 'Lyndon'})\n */\nexport function lookup(attribute: string, value: any): Lookup {\n  return `lookup__${attribute}__${JSON.stringify(value)}`;\n}\n\nexport function isLookup(k: string): boolean {\n  return k.startsWith(\"lookup__\");\n}\n\nexport function parseLookup(k: string): LookupRef {\n  const [_, attribute, ...vJSON] = k.split(\"__\");\n  return [attribute, JSON.parse(vJSON.join(\"__\"))];\n}\n\nfunction etypeChunk(etype: EType): ETypeChunk<any, EType> {\n  return new Proxy(\n    {},\n    {\n      get(_target, id: Id) {\n        if (isLookup(id)) {\n          return transactionChunk(etype, parseLookup(id), []);\n        }\n        return transactionChunk(etype, id, []);\n      },\n    },\n  );\n}\n\nexport function txInit<\n  Schema extends InstantGraph<any, any>,\n>(): TxChunk<Schema> {\n  return new Proxy(\n    {},\n    {\n      get(_target, ns: EType) {\n        return etypeChunk(ns);\n      },\n    },\n  ) as any;\n}\n\n/**\n * A handy builder for changes.\n *\n * You must start with the `namespace` you want to change:\n *\n * @example\n *   tx.goals[goalId].update({title: \"Get fit\"})\n *   // Note: you don't need to create `goals` ahead of time.\n */\nexport const tx = txInit();\n\nexport function getOps(x: TransactionChunk<any, any>): Op[] {\n  return x.__ops;\n}\n", "import { getOps, isLookup, parseLookup } from \"./instatx\";\nimport { immutableDeepReplace } from \"./utils/object\";\nimport uuid from \"./utils/uuid\";\n\n// Rewrites optimistic attrs with the attrs we get back from the server.\nexport function rewriteStep(attrMapping, txStep) {\n  const { attrIdMap, refSwapAttrIds } = attrMapping;\n  const rewritten = [];\n  for (const part of txStep) {\n    const newValue = attrIdMap[part];\n\n    if (newValue) {\n      // Rewrites attr id\n      rewritten.push(newValue);\n    } else if (Array.isArray(part) && part.length == 2 && attrIdMap[part[0]]) {\n      // Rewrites attr id in lookups\n      const [aid, value] = part;\n      rewritten.push([attrIdMap[aid], value]);\n    } else {\n      rewritten.push(part);\n    }\n  }\n  const [action] = txStep;\n  if (\n    (action === \"add-triple\" || action === \"retract-triple\") &&\n    refSwapAttrIds.has(txStep[2])\n  ) {\n    // Reverse links if the optimistic link attr is backwards\n    const tmp = rewritten[1];\n    rewritten[1] = rewritten[3];\n    rewritten[3] = tmp;\n  }\n  return rewritten;\n}\n\nexport function getAttrByFwdIdentName(attrs, inputEtype, inputIdentName) {\n  return Object.values(attrs).find((attr) => {\n    const [_id, etype, label] = attr[\"forward-identity\"];\n    return etype === inputEtype && label === inputIdentName;\n  });\n}\n\nexport function getAttrByReverseIdentName(attrs, inputEtype, inputIdentName) {\n  return Object.values(attrs).find((attr) => {\n    const revIdent = attr[\"reverse-identity\"];\n    if (!revIdent) return false;\n    const [_id, etype, label] = revIdent;\n    return etype === inputEtype && label === inputIdentName;\n  });\n}\n\nfunction explodeLookupRef(eid) {\n  if (Array.isArray(eid)) {\n    return eid;\n  }\n  const entries = Object.entries(eid);\n  if (entries.length !== 1) {\n    throw new Error(\n      \"lookup must be an object with a single unique attr and value.\",\n    );\n  }\n  return entries[0];\n}\n\nfunction isRefLookupIdent(attrs, etype, identName) {\n  return (\n    identName.indexOf(\".\") !== -1 &&\n    // attr names can have `.` in them, so use the attr we find with a `.`\n    // before assuming it's a ref lookup.\n    !getAttrByFwdIdentName(attrs, etype, identName)\n  );\n}\n\nfunction extractRefLookupFwdName(identName) {\n  const [fwdName, idIdent, ...rest] = identName.split(\".\");\n  if (rest.length > 0 || idIdent !== \"id\") {\n    throw new Error(`${identName} is not a valid lookup attribute.`);\n  }\n\n  return fwdName;\n}\n\nfunction lookupIdentToAttr(attrs, etype, identName) {\n  if (!isRefLookupIdent(attrs, etype, identName)) {\n    return getAttrByFwdIdentName(attrs, etype, identName);\n  }\n\n  const fwdName = extractRefLookupFwdName(identName);\n\n  const refAttr = getAttrByFwdIdentName(attrs, etype, fwdName);\n  if (refAttr && refAttr[\"value-type\"] !== \"ref\") {\n    throw new Error(`${identName} does not reference a valid link attribute.`);\n  }\n  return refAttr;\n}\n\n// Returns [attr, value] for the eid if the eid is a lookup.\n// If it's a regular eid, returns null\nfunction lookupPairOfEid(eid) {\n  if (typeof eid === \"string\" && !isLookup(eid)) {\n    return null;\n  }\n  return typeof eid === \"string\" && isLookup(eid)\n    ? parseLookup(eid)\n    : explodeLookupRef(eid);\n}\n\nfunction extractLookup(attrs, etype, eid) {\n  const lookupPair = lookupPairOfEid(eid);\n\n  if (lookupPair === null) {\n    return eid;\n  }\n\n  const [identName, value] = lookupPair;\n  const attr = lookupIdentToAttr(attrs, etype, identName);\n  if (!attr || !attr[\"unique?\"]) {\n    throw new Error(`${identName} is not a unique attribute.`);\n  }\n  return [attr.id, value];\n}\n\nfunction expandLink(attrs, [etype, eidA, obj]) {\n  const addTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n    const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n    const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n    const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n    return eids.map((eidB) => {\n      const txStep = fwdAttr\n        ? [\n            \"add-triple\",\n            extractLookup(attrs, etype, eidA),\n            fwdAttr.id,\n            extractLookup(attrs, fwdAttr[\"reverse-identity\"][1], eidB),\n          ]\n        : [\n            \"add-triple\",\n            extractLookup(attrs, revAttr[\"forward-identity\"][1], eidB),\n            revAttr.id,\n            extractLookup(attrs, etype, eidA),\n          ];\n      return txStep;\n    });\n  });\n  return addTriples;\n}\n\nfunction expandUnlink(attrs, [etype, eidA, obj]) {\n  const retractTriples = Object.entries(obj).flatMap(([label, eidOrEids]) => {\n    const eids = Array.isArray(eidOrEids) ? eidOrEids : [eidOrEids];\n    const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n    const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n    return eids.map((eidB) => {\n      const txStep = fwdAttr\n        ? [\n            \"retract-triple\",\n            extractLookup(attrs, etype, eidA),\n            fwdAttr.id,\n            extractLookup(attrs, fwdAttr[\"reverse-identity\"][1], eidB),\n          ]\n        : [\n            \"retract-triple\",\n            extractLookup(attrs, revAttr[\"forward-identity\"][1], eidB),\n            revAttr.id,\n            extractLookup(attrs, etype, eidA),\n          ];\n      return txStep;\n    });\n  });\n  return retractTriples;\n}\n\nfunction expandUpdate(attrs, [etype, eid, obj]) {\n  const lookup = extractLookup(attrs, etype, eid);\n  // id first so that we don't clobber updates on the lookup field\n  const attrTuples = [[\"id\", extractLookup(attrs, etype, eid)]]\n    .concat(Object.entries(obj))\n    .map(([identName, value]) => {\n      const attr = getAttrByFwdIdentName(attrs, etype, identName);\n      return [\"add-triple\", lookup, attr.id, value];\n    });\n  return attrTuples;\n}\n\nfunction expandDelete(attrs, [etype, eid]) {\n  const lookup = extractLookup(attrs, etype, eid);\n  return [[\"delete-entity\", lookup, etype]];\n}\n\nfunction expandDeepMerge(attrs, [etype, eid, obj]) {\n  const lookup = extractLookup(attrs, etype, eid);\n  const attrTuples = Object.entries(obj).map(([identName, value]) => {\n    const attr = getAttrByFwdIdentName(attrs, etype, identName);\n    const coercedValue = immutableDeepReplace(value, undefined, null);\n    return [\"deep-merge-triple\", lookup, attr.id, coercedValue];\n  });\n\n  const idTuple = [\n    \"add-triple\",\n    lookup,\n    getAttrByFwdIdentName(attrs, etype, \"id\").id,\n    lookup,\n  ];\n\n  // id first so that we don't clobber updates on the lookup field\n  return [idTuple].concat(attrTuples);\n}\n\nfunction toTxSteps(attrs, [action, ...args]) {\n  switch (action) {\n    case \"merge\":\n      return expandDeepMerge(attrs, args);\n    case \"update\":\n      return expandUpdate(attrs, args);\n    case \"link\":\n      return expandLink(attrs, args);\n    case \"unlink\":\n      return expandUnlink(attrs, args);\n    case \"delete\":\n      return expandDelete(attrs, args);\n    default:\n      throw new Error(`unsupported action ${action}`);\n  }\n}\n\n// ---------\n// transform\n\nfunction createObjectAttr(etype, label, props) {\n  const attrId = uuid();\n  const fwdIdentId = uuid();\n  const fwdIdent = [fwdIdentId, etype, label];\n  return {\n    id: attrId,\n    \"forward-identity\": fwdIdent,\n    \"value-type\": \"blob\",\n    cardinality: \"one\",\n    \"unique?\": false,\n    \"index?\": false,\n    isUnsynced: true,\n    ...(props || {}),\n  };\n}\n\nfunction createRefAttr(etype, label, props) {\n  const attrId = uuid();\n  const fwdIdentId = uuid();\n  const revIdentId = uuid();\n  const fwdIdent = [fwdIdentId, etype, label];\n  const revIdent = [revIdentId, label, etype];\n  return {\n    id: attrId,\n    \"forward-identity\": fwdIdent,\n    \"reverse-identity\": revIdent,\n    \"value-type\": \"ref\",\n    cardinality: \"many\",\n    \"unique?\": false,\n    \"index?\": false,\n    isUnsynced: true,\n    ...(props || {}),\n  };\n}\n\n// Actions that have an object, e.g. not delete\nconst OBJ_ACTIONS = new Set([\"update\", \"merge\", \"link\", \"unlink\"]);\nconst REF_ACTIONS = new Set([\"link\", \"unlink\"]);\nconst UPDATE_ACTIONS = new Set([\"update\", \"merge\"]);\nconst SUPPORTS_LOOKUP_ACTIONS = new Set([\n  \"link\",\n  \"unlink\",\n  \"update\",\n  \"merge\",\n  \"delete\",\n]);\n\nconst lookupProps = { \"unique?\": true, \"index?\": true };\nconst refLookupProps = { ...lookupProps, cardinality: \"one\" };\n\nfunction createMissingAttrs(existingAttrs, ops) {\n  const [addedIds, attrs, addOps] = [new Set(), { ...existingAttrs }, []];\n  function addAttr(attr) {\n    attrs[attr.id] = attr;\n    addOps.push([\"add-attr\", attr]);\n    addedIds.add(attr.id);\n  }\n  function addUnsynced(attr) {\n    if (attr?.isUnsynced && !addedIds.has(attr.id)) {\n      addOps.push([\"add-attr\", attr]);\n      addedIds.add(attr.id);\n    }\n  }\n\n  // Create attrs for lookups if we need to\n  // Do these first because otherwise we might add a non-unique attr\n  // before we get to it\n  for (const op of ops) {\n    const [action, etype, eid, obj] = op;\n    if (SUPPORTS_LOOKUP_ACTIONS.has(action)) {\n      const lookupPair = lookupPairOfEid(eid);\n      if (lookupPair) {\n        const identName = lookupPair[0];\n        if (isRefLookupIdent(attrs, etype, identName)) {\n          const label = extractRefLookupFwdName(identName);\n          const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n          const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n          if (!fwdAttr && !revAttr) {\n            addAttr(createRefAttr(etype, label, refLookupProps));\n          }\n          addUnsynced(fwdAttr);\n          addUnsynced(revAttr);\n        } else {\n          const attr = getAttrByFwdIdentName(attrs, etype, identName);\n          if (!attr) {\n            addAttr(createObjectAttr(etype, identName, lookupProps));\n          }\n          addUnsynced(attr);\n        }\n      }\n    }\n  }\n\n  // Create object and ref attrs\n  for (const op of ops) {\n    const [action, etype, eid, obj] = op;\n    if (OBJ_ACTIONS.has(action)) {\n      const labels = Object.keys(obj);\n      labels.push(\"id\");\n      for (const label of labels) {\n        const fwdAttr = getAttrByFwdIdentName(attrs, etype, label);\n        addUnsynced(fwdAttr);\n        if (UPDATE_ACTIONS.has(action)) {\n          if (!fwdAttr) {\n            addAttr(createObjectAttr(etype, label));\n          }\n        }\n        if (REF_ACTIONS.has(action)) {\n          const revAttr = getAttrByReverseIdentName(attrs, etype, label);\n          if (!fwdAttr && !revAttr) {\n            addAttr(createRefAttr(etype, label));\n          }\n          addUnsynced(revAttr);\n        }\n      }\n    }\n  }\n  return [attrs, addOps];\n}\n\nexport function transform(attrs, inputChunks) {\n  const chunks = Array.isArray(inputChunks) ? inputChunks : [inputChunks];\n  const ops = chunks.flatMap((tx) => getOps(tx));\n  const [newAttrs, addAttrTxSteps] = createMissingAttrs(attrs, ops);\n  const txSteps = ops.flatMap((op) => toTxSteps(newAttrs, op));\n  return [...addAttrTxSteps, ...txSteps];\n}\n", "import { query as datalogQuery } from \"./datalog\";\nimport { uuidCompare } from \"./utils/uuid\";\nimport { getAttrByFwdIdentName, getAttrByReverseIdentName } from \"./instaml\";\nimport * as s from \"./store\"; \n\n// Pattern variables\n// -----------------\n\nlet _seed = 0;\n\nfunction wildcard(friendlyName) {\n  return makeVarImpl(`_${friendlyName}`, _seed++);\n}\n\nfunction makeVarImpl(x, level) {\n  return `?${x}-${level}`;\n}\n\n// Where\n// -----------------\n\nclass AttrNotFoundError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = \"AttrNotFoundError\";\n  }\n}\n\nfunction getPrimaryKeyAttr(store, ns) {\n  const primary = Object.values(store.attrs).find(\n    (a) => a[\"primary?\"] && a[\"forward-identity\"]?.[1] === ns,\n  );\n\n  if (primary) {\n    return primary;\n  }\n  return getAttrByFwdIdentName(store.attrs, ns, \"id\");\n}\n\nfunction idAttr(store, ns) {\n  const attr = getPrimaryKeyAttr(store, ns);\n\n  if (!attr) {\n    throw new AttrNotFoundError(`Could not find id attr for ${ns}`);\n  }\n  return attr;\n}\n\nfunction defaultWhere(makeVar, store, etype, level) {\n  return [eidWhere(makeVar, store, etype, level)];\n}\n\nfunction eidWhere(makeVar, store, etype, level) {\n  return [\n    makeVar(etype, level),\n    idAttr(store, etype).id,\n    makeVar(etype, level),\n    makeVar(\"time\", level),\n  ];\n}\n\nfunction replaceInAttrPat(attrPat, needle, v) {\n  return attrPat.map((x) => (x === needle ? v : x));\n}\n\nfunction refAttrPat(makeVar, store, etype, level, label) {\n  const fwdAttr = getAttrByFwdIdentName(store.attrs, etype, label);\n  const revAttr = getAttrByReverseIdentName(store.attrs, etype, label);\n  const attr = fwdAttr || revAttr;\n\n  if (!attr) {\n    throw new AttrNotFoundError(`Could not find attr for ${[etype, label]}`);\n  }\n\n  if (attr[\"value-type\"] !== \"ref\") {\n    throw new Error(`Attr ${attr.id} is not a ref`);\n  }\n\n  const [_f, fwdEtype] = attr[\"forward-identity\"];\n  const [_r, revEtype] = attr[\"reverse-identity\"];\n  const nextLevel = level + 1;\n  const attrPat = fwdAttr\n    ? [\n      makeVar(fwdEtype, level),\n      attr.id,\n      makeVar(revEtype, nextLevel),\n      wildcard(\"time\"),\n    ]\n    : [\n      makeVar(fwdEtype, nextLevel),\n      attr.id,\n      makeVar(revEtype, level),\n      wildcard(\"time\"),\n    ];\n\n  const nextEtype = fwdAttr ? revEtype : fwdEtype;\n\n  const isForward = Boolean(fwdAttr);\n\n  return [nextEtype, nextLevel, attrPat, attr, isForward];\n}\n\nfunction valueAttrPat(makeVar, store, valueEtype, valueLevel, valueLabel, v) {\n  const attr = getAttrByFwdIdentName(store.attrs, valueEtype, valueLabel);\n\n  if (!attr) {\n    throw new AttrNotFoundError(\n      `No attr for etype = ${valueEtype} label = ${valueLabel} value-label`,\n    );\n  }\n\n  return [makeVar(valueEtype, valueLevel), attr.id, v, wildcard(\"time\")];\n}\n\nfunction refAttrPats(makeVar, store, etype, level, refsPath) {\n  const [lastEtype, lastLevel, attrPats] = refsPath.reduce(\n    (acc, label) => {\n      const [etype, level, attrPats] = acc;\n      const [nextEtype, nextLevel, attrPat] = refAttrPat(\n        makeVar,\n        store,\n        etype,\n        level,\n        label,\n      );\n      return [nextEtype, nextLevel, [...attrPats, attrPat]];\n    },\n    [etype, level, []],\n  );\n\n  return [lastEtype, lastLevel, attrPats];\n}\n\nfunction whereCondAttrPats(makeVar, store, etype, level, path, v) {\n  const refsPath = path.slice(0, path.length - 1);\n  const valueLabel = path[path.length - 1];\n  const [lastEtype, lastLevel, refPats] = refAttrPats(\n    makeVar,\n    store,\n    etype,\n    level,\n    refsPath,\n  );\n  const valuePat = valueAttrPat(\n    makeVar,\n    store,\n    lastEtype,\n    lastLevel,\n    valueLabel,\n    v,\n  );\n\n  return refPats.concat([valuePat]);\n}\n\nfunction withJoin(where, join) {\n  return join ? [join].concat(where) : where;\n}\n\nfunction isOrClauses([k, v]) {\n  return k === \"or\" && Array.isArray(v);\n}\n\nfunction isAndClauses([k, v]) {\n  return k === \"and\" && Array.isArray(v);\n}\n\n// Creates a makeVar that will namespace symbols for or clauses\n// to prevent conflicts, except for the base etype\nfunction genMakeVar(baseMakeVar, etype, orIdx) {\n  return (x, lvl) => {\n    if (x == etype) {\n      return baseMakeVar(x, lvl);\n    }\n    return `${baseMakeVar(x, lvl)}-${orIdx}`;\n  };\n}\n\nfunction parseWhereClauses(\n  makeVar,\n  clauseType /* 'or' | 'and' */,\n  store,\n  etype,\n  level,\n  whereValue,\n) {\n  const patterns = whereValue.map((w, i) => {\n    const makeNamespacedVar = genMakeVar(makeVar, etype, i);\n    return parseWhere(makeNamespacedVar, store, etype, level, w);\n  });\n  const joinSym = makeVar(etype, level);\n  return { [clauseType]: { patterns, joinSym } };\n}\n\nfunction parseWhere(makeVar, store, etype, level, where) {\n  return Object.entries(where).flatMap(([k, v]) => {\n    if (isOrClauses([k, v])) {\n      return parseWhereClauses(makeVar, \"or\", store, etype, level, v);\n    }\n    if (isAndClauses([k, v])) {\n      return parseWhereClauses(makeVar, \"and\", store, etype, level, v);\n    }\n    const path = k.split(\".\");\n    return whereCondAttrPats(makeVar, store, etype, level, path, v);\n  });\n}\n\nfunction makeWhere(store, etype, level, where) {\n  const makeVar = makeVarImpl;\n  if (!where) {\n    return defaultWhere(makeVar, store, etype, level);\n  }\n  const parsedWhere = parseWhere(makeVar, store, etype, level, where);\n  return parsedWhere.concat(defaultWhere(makeVar, store, etype, level));\n}\n\n// Find\n// -----------------\n\nfunction makeFind(makeVar, etype, level) {\n  return [makeVar(etype, level), makeVar(\"time\", level)];\n}\n\n// extendObjects\n// -----------------\n\nfunction makeJoin(makeVar, store, etype, level, label, eid) {\n  const [nextEtype, nextLevel, pat, attr, isForward] = refAttrPat(\n    makeVar,\n    store,\n    etype,\n    level,\n    label,\n  );\n  const actualized = replaceInAttrPat(pat, makeVar(etype, level), eid);\n  return [nextEtype, nextLevel, actualized, attr, isForward];\n}\n\nfunction extendObjects(makeVar, store, { etype, level, form }, objects) {\n  const children = Object.keys(form).filter((c) => c !== \"$\");\n  if (!children.length) {\n    return Object.values(objects);\n  }\n  return Object.entries(objects).map(([eid, parent]) => {\n    const childResults = children.map((label) => {\n      const isSingular = Boolean(\n        store.cardinalityInference &&\n        store.linkIndex?.[etype]?.[label]?.isSingular,\n      );\n\n      try {\n        const [nextEtype, nextLevel, join] = makeJoin(\n          makeVar,\n          store,\n          etype,\n          level,\n          label,\n          eid,\n        );\n\n        const childrenArray = queryOne(store, {\n          etype: nextEtype,\n          level: nextLevel,\n          form: form[label],\n          join,\n        });\n\n        const childOrChildren = isSingular ? childrenArray[0] : childrenArray;\n\n        return { [label]: childOrChildren };\n      } catch (e) {\n        if (e instanceof AttrNotFoundError) {\n          return { [label]: isSingular ? undefined : [] };\n        }\n        throw e;\n      }\n    });\n    return childResults.reduce((parent, child) => {\n      return { ...parent, ...child };\n    }, parent);\n  });\n}\n\n// resolveObjects\n// -----------------\n\nfunction shouldIgnoreAttr(attrs, id) {\n  const attr = attrs[id];\n  return attr[\"value-type\"] === \"ref\" && attr[\"forward-identity\"][2] !== \"id\";\n}\n\nfunction cursorCompare(direction, typ) {\n  switch (direction) {\n    case \"asc\":\n      switch (typ) {\n        case \"number\":\n          return (x, y) => x < y;\n        case \"uuid\":\n          return (x, y) => uuidCompare(x, y) === -1;\n      }\n    case \"desc\":\n      switch (typ) {\n        case \"number\":\n          return (x, y) => x > y;\n        case \"uuid\":\n          return (x, y) => uuidCompare(x, y) === 1;\n      }\n  }\n}\n\nfunction isBefore(startCursor, direction, [e, _a, _v, t]) {\n  return (\n    cursorCompare(direction, \"number\")(t, startCursor[3]) ||\n    (t === startCursor[3] &&\n      cursorCompare(direction, \"uuid\")(e, startCursor[0]))\n  );\n}\n\nfunction runDataloadAndReturnObjects(store, etype, direction, pageInfo, dq) {\n  const aid = idAttr(store, etype).id;\n  const idVecs = datalogQuery(store, dq)\n    .sort(([_, tsA], [__, tsB]) => {\n      return direction === \"desc\" ? tsB - tsA : tsA - tsB;\n    });\n\n  let objects = {}\n  const startCursor = pageInfo?.[\"start-cursor\"];\n  const blobAttrs = s.blobAttrs(store, etype);\n  for (const [id, time] of idVecs) {\n    if (\n      startCursor &&\n      aid === startCursor[1] &&\n      isBefore(startCursor, direction, [id, aid, id, time])\n    ) {\n      continue;\n    }\n    const obj = s.getAsObject(store, blobAttrs, id);\n    if (obj) {\n      objects[id] = obj;\n    }\n  }\n  return objects;\n}\n\nfunction determineOrder(form) {\n  const orderOpts = form.$?.order;\n  if (!orderOpts) {\n    return \"asc\";\n  }\n\n  return orderOpts[Object.keys(orderOpts)[0]] || \"asc\";\n}\n\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *   },\n * };\n *\n * `resolveObjects`, turns where clause: `{ name: \"Joe\" }`\n * into a datalog query. We then run the datalog query,\n * and reduce all the triples into objects.\n */\nfunction resolveObjects(store, { etype, level, form, join, pageInfo }) {\n  const limit = form.$?.limit || form.$?.first || form.$?.last;\n  const offset = form.$?.offset;\n  const before = form.$?.before;\n  const after = form.$?.after;\n\n  // Wait for server to tell us where we start if we don't start from the beginning\n  if ((offset || before || after) && (!pageInfo || !pageInfo[\"start-cursor\"])) {\n    return [];\n  }\n  const where = withJoin(makeWhere(store, etype, level, form.$?.where), join);\n\n  const find = makeFind(makeVarImpl, etype, level);\n\n  const objs = runDataloadAndReturnObjects(\n    store,\n    etype,\n    determineOrder(form),\n    pageInfo,\n    { where, find },\n  );\n\n  if (limit != null) {\n    const entries = Object.entries(objs);\n    if (entries.length <= limit) {\n      return objs;\n    }\n    return Object.fromEntries(entries.slice(0, limit));\n  }\n  return objs;\n}\n\n/**\n * It's possible that we query\n * for an attribute that doesn't exist yet.\n *\n * { users: { $: { where: { nonExistentProperty: \"foo\" } } } }\n *\n * This swallows the missing attr error and returns\n * an empty result instead\n */\nfunction guardedResolveObjects(store, opts) {\n  try {\n    return resolveObjects(store, opts);\n  } catch (e) {\n    if (e instanceof AttrNotFoundError) {\n      return {};\n    }\n    throw e;\n  }\n}\n/**\n * Given a query like:\n *\n * {\n *   users: {\n *     $: { where: { name: \"Joe\" } },\n *     posts: {},\n *   },\n * };\n *\n * `guardResolveObjects` will return the relevant `users` objects\n * `extendObjects` will then extend each `user` object with relevant `posts`.\n */\nfunction queryOne(store, opts) {\n  const objects = guardedResolveObjects(store, opts);\n  return extendObjects(makeVarImpl, store, opts, objects);\n}\n\nfunction formatPageInfo(pageInfo) {\n  const res = {};\n  for (const [k, v] of Object.entries(pageInfo)) {\n    res[k] = {\n      startCursor: v[\"start-cursor\"],\n      endCursor: v[\"end-cursor\"],\n      hasNextPage: v[\"has-next-page?\"],\n      hasPreviousPage: v[\"has-previous-page?\"],\n    };\n  }\n  return res;\n}\n\nexport default function query({ store, pageInfo, aggregate }, q) {\n  const data = Object.keys(q).reduce((res, k) => {\n    if (aggregate?.[k]) {\n      // Aggregate doesn't return any join rows and has no children,\n      // so don't bother querying further\n      return res;\n    }\n    res[k] = queryOne(store, {\n      etype: k,\n      form: q[k],\n      level: 0,\n      pageInfo: pageInfo?.[k],\n    });\n    return res;\n  }, {});\n\n  const result = { data };\n  if (pageInfo) {\n    result.pageInfo = formatPageInfo(pageInfo);\n  }\n\n  if (aggregate) {\n    result.aggregate = aggregate;\n  }\n\n  return result;\n}\n", "export default class IndexedDBStorage {\n  constructor(dbName) {\n    this.dbName = dbName;\n    this._storeName = \"kv\";\n    this._dbPromise = this._init();\n  }\n\n  _init() {\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.dbName, 1);\n\n      request.onerror = (event) => {\n        reject(event);\n      };\n\n      request.onsuccess = (event) => {\n        resolve(event.target.result);\n      };\n\n      request.onupgradeneeded = (event) => {\n        const db = event.target.result;\n        db.createObjectStore(this._storeName);\n      };\n    });\n  }\n\n  async getItem(k) {\n    const db = await this._dbPromise;\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([this._storeName], \"readonly\");\n      const objectStore = transaction.objectStore(this._storeName);\n      const request = objectStore.get(k);\n      request.onerror = (event) => {\n        reject(event);\n      };\n      request.onsuccess = (_event) => {\n        if (request.result) {\n          resolve(request.result);\n        } else {\n          resolve(null);\n        }\n      };\n    });\n  }\n\n  async setItem(k, v) {\n    const db = await this._dbPromise;\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction([this._storeName], \"readwrite\");\n      const objectStore = transaction.objectStore(this._storeName);\n      const request = objectStore.put(v, k);\n\n      request.onerror = (event) => {\n        reject(event);\n      };\n\n      request.onsuccess = (_event) => {\n        resolve();\n      };\n    });\n  }\n}\n", "export default class WindowNetworkListener {\n  static async getIsOnline() {\n    return navigator.onLine;\n  }\n  static listen(f) {\n    const onOnline = () => {\n      f(true);\n    };\n    const onOffline = () => {\n      f(false);\n    };\n    addEventListener(\"online\", onOnline);\n    addEventListener(\"offline\", onOffline);\n    return () => {\n      removeEventListener(\"online\", onOnline);\n      removeEventListener(\"offline\", onOffline);\n    };\n  }\n}\n", "export async function jsonFetch(\n  input: RequestInfo,\n  init: RequestInit | undefined,\n): Promise<any> {\n  const res = await fetch(input, init);\n  const json = await res.json();\n  return res.status === 200\n    ? Promise.resolve(json)\n    : Promise.reject({ status: res.status, body: json });\n}\n", "import { jsonFetch } from \"./utils/fetch\";\n\nexport function sendMagicCode({ apiURI, appId, email }) {\n  return jsonFetch(`${apiURI}/runtime/auth/send_magic_code`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({ \"app-id\": appId, email }),\n  });\n}\n\nexport async function verifyMagicCode({ apiURI, appId, email, code }) {\n  const res = await jsonFetch(`${apiURI}/runtime/auth/verify_magic_code`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({ \"app-id\": appId, email, code }),\n  });\n  return res;\n}\n\nexport async function verifyRefreshToken({ apiURI, appId, refreshToken }) {\n  const res = await jsonFetch(`${apiURI}/runtime/auth/verify_refresh_token`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({\n      \"app-id\": appId,\n      \"refresh-token\": refreshToken,\n    }),\n  });\n  return res;\n}\n\n/**\n * @param {Object} params\n * @param {string} params.apiURI\n * @param {string} params.appId\n * @param {string} params.code\n * @param {string | null | undefined} [params.codeVerifier]\n */\nexport async function exchangeCodeForToken({\n  apiURI,\n  appId,\n  code,\n  codeVerifier,\n}) {\n  const res = await jsonFetch(`${apiURI}/runtime/oauth/token`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({\n      app_id: appId,\n      code: code,\n      code_verifier: codeVerifier,\n    }),\n  });\n  return res;\n}\n\n/**\n * @param {Object} params\n * @param {string} params.apiURI\n * @param {string} params.appId\n * @param {string} params.clientName\n * @param {string} params.idToken\n * @param {string | null | undefined} [params.refreshToken]\n * @param {string | null | undefined} [params.nonce]\n */\nexport async function signInWithIdToken({\n  apiURI,\n  appId,\n  nonce,\n  idToken,\n  clientName,\n  refreshToken,\n}) {\n  const res = await jsonFetch(`${apiURI}/runtime/oauth/id_token`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({\n      app_id: appId,\n      nonce,\n      id_token: idToken,\n      client_name: clientName,\n      refresh_token: refreshToken,\n    }),\n  });\n  return res;\n}\n\n/**\n * @param {Object} params\n * @param {string} params.apiURI\n * @param {string} params.appId\n * @param {string} params.refreshToken\n */\nexport async function signOut({ apiURI, appId, refreshToken }) {\n  const res = await jsonFetch(`${apiURI}/runtime/signout`, {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      app_id: appId,\n      refresh_token: refreshToken,\n    }),\n  });\n  return res;\n}\n", "import { jsonFetch } from \"./utils/fetch\";\n\nexport async function getSignedUploadUrl({\n  apiURI,\n  appId,\n  fileName,\n  refreshToken,\n  metadata = {},\n}: {\n  apiURI: string;\n  appId: string;\n  fileName: string;\n  refreshToken?: string;\n  metadata?: Record<string, any>;\n}) {\n  const { data } = await jsonFetch(`${apiURI}/storage/signed-upload-url`, {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\",\n      authorization: `Bearer ${refreshToken}`,\n    },\n    body: JSON.stringify({\n      app_id: appId,\n      filename: fileName,\n    }),\n  });\n\n  return data;\n}\n\nexport async function upload(presignedUrl, file) {\n  const response = await fetch(presignedUrl, {\n    method: \"PUT\",\n    body: file,\n    headers: {\n      \"Content-Type\": file.type,\n    },\n  });\n\n  return response.ok;\n}\n\nexport async function getDownloadUrl({\n  apiURI,\n  appId,\n  path,\n  refreshToken,\n}: {\n  apiURI: string;\n  appId: string;\n  path: string;\n  refreshToken?: string;\n}) {\n  const { data } = await jsonFetch(\n    `${apiURI}/storage/signed-download-url?app_id=${appId}&filename=${encodeURIComponent(path)}`,\n    {\n      method: \"GET\",\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: `Bearer ${refreshToken}`,\n      },\n    },\n  );\n\n  return data;\n}\n\nexport async function deleteFile({\n  apiURI,\n  appId,\n  path,\n  refreshToken,\n}: {\n  apiURI: string;\n  appId: string;\n  path: string;\n  refreshToken?: string;\n}) {\n  const { data } = await jsonFetch(\n    `${apiURI}/storage/files?app_id=${appId}&filename=${encodeURIComponent(path)}`,\n    {\n      method: \"DELETE\",\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: `Bearer ${refreshToken}`,\n      },\n    },\n  );\n\n  return data;\n}\n", "export function pick(obj, keys) {\n  if (!keys) return obj;\n\n  const ret = {};\n  keys.forEach((key) => {\n    ret[key] = obj[key];\n  });\n  return ret;\n}\n", "import { pick } from \"./utils/pick\";\nimport { areObjectsShallowEqual, areObjectKeysEqual } from \"./utils/object\";\n\nexport type RoomSchemaShape = {\n  [k: string]: {\n    presence?: { [k: string]: any };\n    topics?: {\n      [k: string]: {\n        [k: string]: any;\n      };\n    };\n  };\n};\n\nexport type PresenceOpts<PresenceShape, Keys extends keyof PresenceShape> = {\n  user?: boolean;\n  peers?: string[];\n  keys?: Keys[];\n};\n\ntype PresencePeer<PresenceShape, Keys extends keyof PresenceShape> = Pick<\n  PresenceShape,\n  Keys\n> & {\n  peerId: string;\n};\n\nexport type PresenceSlice<PresenceShape, Keys extends keyof PresenceShape> = {\n  user?: PresencePeer<PresenceShape, Keys>;\n  peers: {\n    [peerId: string]: PresencePeer<PresenceShape, Keys>;\n  };\n};\n\nexport type PresenceResponse<\n  PresenceShape,\n  Keys extends keyof PresenceShape,\n> = PresenceSlice<PresenceShape, Keys> & {\n  isLoading: boolean;\n  error?: string;\n};\n\nexport function buildPresenceSlice<\n  PresenceShape,\n  Keys extends keyof PresenceShape,\n>(\n  data: {\n    user?: PresenceShape;\n    peers: Record<string, PresenceShape>;\n  },\n  opts: PresenceOpts<PresenceShape, Keys>,\n  userPeerId: string,\n): PresenceSlice<PresenceShape, Keys> {\n  const slice: PresenceSlice<PresenceShape, Keys> = {\n    peers: {},\n  };\n\n  const includeUser = opts && \"user\" in opts ? opts.user : true;\n\n  if (includeUser) {\n    const user = pick(data.user ?? {}, opts?.keys);\n    slice.user = { ...user, peerId: userPeerId };\n  }\n\n  for (const id of Object.keys(data.peers ?? {})) {\n    const shouldIncludeAllPeers = opts?.peers === undefined;\n    const isPeerIncluded =\n      Array.isArray(opts?.peers) && opts?.peers.includes(id);\n\n    if (shouldIncludeAllPeers || isPeerIncluded) {\n      const peer = pick(data.peers[id], opts?.keys);\n      slice.peers[id] = { ...peer, peerId: id };\n    }\n  }\n\n  return slice;\n}\n\n/**\n * Compare two presence slices\n * 0. compare isLoading and error\n * 1. shallow compare user\n * 2. compare peers keys\n * 3. shallow compare each peer\n */\nexport function hasPresenceResponseChanged<\n  PresenceShape,\n  Keys extends keyof PresenceShape,\n>(\n  a: PresenceResponse<PresenceShape, Keys>,\n  b: PresenceResponse<PresenceShape, Keys>,\n) {\n  if (a.isLoading !== b.isLoading) return true;\n  if (a.error !== b.error) return true;\n\n  if (a.user || b.user) {\n    if (!a.user || !b.user) return true;\n\n    const same = areObjectsShallowEqual(a.user, b.user);\n\n    if (!same) return true;\n  }\n\n  const sameKeys = areObjectKeysEqual(a.peers, b.peers);\n\n  if (!sameKeys) return true;\n\n  for (const id of Object.keys(a.peers)) {\n    const same = areObjectsShallowEqual(a.peers[id], b.peers[id]);\n\n    if (!same) return true;\n  }\n\n  return false;\n}\n", "export class Deferred {\n  promise;\n  _resolve;\n  _reject;\n\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  resolve(value) {\n    this._resolve(value);\n  }\n\n  reject(reason) {\n    this._reject(reason);\n  }\n}\n", "// PersistedObjects save data outside of memory.\n//\n// When we load a persisted object, it's possible we call `set`\n// before we finish loading. To address we handle set in two ways:\n//\n// 1. Before load\n// We simply update currentValue in memory\n//\n// 2. After load\n// We update currentValue in memory and in storage\n//\n// Each PersistedObject provides it's own `onMerge`\n// function to handle the merge of data from storage and memory\n// on load\nexport class PersistedObject {\n  constructor(\n    persister,\n    key,\n    defaultValue,\n    onMerge,\n    toJSON = (x) => {\n      return JSON.stringify(x);\n    },\n    fromJSON = (x) => {\n      return JSON.parse(x);\n    },\n    saveThrottleMs = 100,\n  ) {\n    this._persister = persister;\n    this._key = key;\n\n    this._onMerge = onMerge;\n\n    this._loadedCbs = [];\n    this._isLoading = true;\n    this.currentValue = defaultValue;\n    this.toJSON = toJSON;\n    this.fromJSON = fromJSON;\n    this._saveThrottleMs = saveThrottleMs;\n    this._pendingSaveCbs = [];\n    this._version = 0; \n\n    this._load();\n  }\n\n  async _load() {\n    const fromStorage = this.fromJSON(await this._persister.getItem(this._key));\n    this._isLoading = false;\n\n    this._onMerge(fromStorage, this.currentValue);\n    for (const cb of this._loadedCbs) {\n      cb();\n    }\n  }\n\n  async waitForLoaded() {\n    if (!this._isLoading) {\n      return;\n    }\n    const loadedPromise = new Promise((resolve) => {\n      this._loadedCbs.push(resolve);\n    });\n    await loadedPromise;\n  }\n\n  isLoading() {\n    return this._isLoading;\n  }\n  \n  version() { \n    return this._version;\n  }\n\n  async waitForSync() {\n    if (!this._nextSave) {\n      return;\n    }\n    const syncedPromise = new Promise((resolve) => {\n      this._pendingSaveCbs.push(resolve);\n    });\n    await syncedPromise;\n  }\n\n  _writeToStorage() {\n    this._persister.setItem(this._key, this.toJSON(this.currentValue));\n    for (const cb of this._pendingSaveCbs) {\n      cb();\n    }\n    this._pendingSaveCbs.length = 0;\n  }\n\n  async flush() {\n    if (!this._nextSave) {\n      return;\n    }\n    clearTimeout(this._nextSave);\n    this._writeToStorage();\n  }\n\n  _enqueuePersist(cb) {\n    if (this._nextSave) {\n      if (cb) {\n        this._pendingSaveCbs.push(cb);\n      }\n      return;\n    }\n    this._nextSave = setTimeout(() => {\n      this._nextSave = null;\n      this._writeToStorage();\n    }, this._saveThrottleMs);\n  }\n\n  set(f, cb) {\n    this._version++;\n    this.currentValue = f(this.currentValue);\n    if (this._isLoading) {\n      this._loadedCbs.push(() => this._enqueuePersist(cb));\n    } else {\n      this._enqueuePersist(cb);\n    }\n  }\n}\n", "function _extractTriplesHelper(idNodes, acc = []) {\n  idNodes.forEach((idNode) => {\n    const { data } = idNode;\n    const { \"datalog-result\": datalogResult } = data;\n    const { \"join-rows\": joinRows } = datalogResult;\n    for (const rows of joinRows) {\n      for (const triple of rows) {\n        acc.push(triple);\n      }\n    }\n    _extractTriplesHelper(idNode[\"child-nodes\"], acc);\n  });\n}\n\n/**\n * Marshall instaql-result into list of triples. Instaql-result may have\n * multiple datalog-results, each datalog-result may have multiple join-rows\n * and each join-row may have triples.The union of these triples may have\n * duplicates, so we dedup them.\n */\nexport function extractTriples(idNodes) {\n  const triples = [];\n  _extractTriplesHelper(idNodes, triples);\n  return triples;\n}\n", "import type { InstantGraph, LinkDef, LinksDef } from \"../schemaTypes\";\n\nexport type LinkIndex = Record<\n  string,\n  Record<\n    string,\n    {\n      isForward: boolean;\n      isSingular: boolean;\n      link: LinkDef<any, any, any, any, any, any, any>;\n    }\n  >\n>;\n\nexport function createLinkIndex(schema: InstantGraph<any, LinksDef<{}>>) {\n  return Object.values(schema.links).reduce((linkIndex, link) => {\n    linkIndex[link.forward.on] ??= {};\n    linkIndex[link.forward.on][link.forward.label] = {\n      isForward: true,\n      isSingular: link.forward.has === \"one\",\n      link,\n    };\n\n    linkIndex[link.reverse.on] ??= {};\n    linkIndex[link.reverse.on][link.reverse.label] = {\n      isForward: false,\n      isSingular: link.reverse.has === \"one\",\n      link,\n    };\n\n    return linkIndex;\n  }, {} as LinkIndex);\n}\n", "// @ts-check\nimport log from \"./utils/log\";\nimport weakHash from \"./utils/weakHash\";\nimport instaql from \"./instaql\";\nimport * as instaml from \"./instaml\";\nimport * as s from \"./store\";\nimport uuid from \"./utils/uuid\";\nimport IndexedDBStorage from \"./IndexedDBStorage\";\nimport WindowNetworkListener from \"./WindowNetworkListener\";\nimport * as authAPI from \"./authAPI\";\nimport * as StorageApi from \"./StorageAPI\";\nimport { buildPresenceSlice, hasPresenceResponseChanged } from \"./presence\";\nimport { Deferred } from \"./utils/Deferred\";\nimport { PersistedObject } from \"./utils/PersistedObject\";\nimport { extractTriples } from \"./model/instaqlResult\";\nimport { areObjectsDeepEqual } from \"./utils/object\";\nimport { createLinkIndex } from \"./utils/linkIndex\";\n\nconst STATUS = {\n  CONNECTING: \"connecting\",\n  OPENED: \"opened\",\n  AUTHENTICATED: \"authenticated\",\n  CLOSED: \"closed\",\n  ERRORED: \"errored\",\n};\n\nconst QUERY_ONCE_TIMEOUT = 10_000;\n\nconst WS_OPEN_STATUS = 1;\n\nconst defaultConfig = {\n  apiURI: \"https://api.instantdb.com\",\n  websocketURI: \"wss://api.instantdb.com/runtime/session\",\n};\n\n// Param that the backend adds if this is an oauth redirect\nconst OAUTH_REDIRECT_PARAM = \"_instant_oauth_redirect\";\n\nconst currentUserKey = `currentUser`;\n\nfunction isClient() {\n  const hasWindow = typeof window !== \"undefined\";\n  // this checks if we are running in a chrome extension\n  // @ts-expect-error\n  const isChrome = typeof chrome !== \"undefined\";\n\n  return hasWindow || isChrome;\n}\n\nfunction querySubsFromJSON(str) {\n  const parsed = JSON.parse(str);\n  for (const key in parsed) {\n    const v = parsed[key];\n    if (v?.result?.store) {\n      v.result.store = s.fromJSON(v.result.store);\n    }\n  }\n  return parsed;\n}\n\nfunction querySubsToJSON(querySubs) {\n  const jsonSubs = {};\n  for (const key in querySubs) {\n    const sub = querySubs[key];\n    const jsonSub = { ...sub };\n    if (sub.result?.store) {\n      jsonSub.result = {\n        ...sub.result,\n        store: s.toJSON(sub.result.store),\n      };\n    }\n    jsonSubs[key] = jsonSub;\n  }\n  return JSON.stringify(jsonSubs);\n}\n\n/**\n * @template {import('./presence').RoomSchemaShape} [RoomSchema = {}]\n */\nexport default class Reactor {\n  attrs;\n  _isOnline = true;\n  _isShutdown = false;\n  status = STATUS.CONNECTING;\n\n  /** @type {PersistedObject} */\n  querySubs;\n  /** @type {PersistedObject} */\n  pendingMutations;\n\n  /** @type {Record<string, Array<{ q: any, cb: (data: any) => any }>>} */\n  queryCbs = {};\n  /** @type {Record<string, Array<{ q: any, eventId: string, dfd: Deferred }>>} */\n  queryOnceDfds = {};\n  authCbs = [];\n  attrsCbs = [];\n  mutationErrorCbs = [];\n  config;\n  _persister;\n  mutationDeferredStore = new Map();\n  _reconnectTimeoutId = null;\n  _reconnectTimeoutMs = 0;\n  _ws;\n  _localIdPromises = {};\n  _errorMessage = null;\n  /** @type {Promise<null | {error: {message: string}}>}**/\n  _oauthCallbackResponse = null;\n\n  /** @type {null | import('./utils/linkIndex').LinkIndex}} */\n  _linkIndex = null;\n\n  /** @type BroadcastChannel | undefined */\n  _broadcastChannel;\n\n  /** @type {Record<string, {isConnected: boolean; error: any}>} */\n  _rooms = {};\n  /** @type {Record<string, boolean>} */\n  _roomsPendingLeave = {};\n  _presence = {};\n  _broadcastQueue = [];\n  _broadcastSubs = {};\n  _currentUserCached = { isLoading: true, error: undefined, user: undefined };\n  _beforeUnloadCbs = [];\n  _dataForQueryCache = {};\n\n  constructor(\n    config,\n    Storage = IndexedDBStorage,\n    NetworkListener = WindowNetworkListener,\n  ) {\n    this.config = { ...defaultConfig, ...config };\n\n    if (this.config.schema) {\n      this._linkIndex = createLinkIndex(this.config.schema);\n    }\n\n    // This is to protect us against running\n    // server-side.\n    if (!isClient()) {\n      return;\n    }\n    if (typeof BroadcastChannel === \"function\") {\n      this._broadcastChannel = new BroadcastChannel(\"@instantdb\");\n      this._broadcastChannel.addEventListener(\"message\", async (e) => {\n        if (e.data?.type === \"auth\") {\n          const res = await this.getCurrentUser();\n          this.updateUser(res.user);\n        }\n      });\n    }\n\n    this._oauthCallbackResponse = this._oauthLoginInit();\n\n    this._initStorage(Storage);\n\n    // kick off a request to cache it\n    this.getCurrentUser();\n\n    NetworkListener.getIsOnline().then((isOnline) => {\n      this._isOnline = isOnline;\n      this._startSocket();\n      NetworkListener.listen((isOnline) => {\n        // We do this because react native's NetInfo\n        // fires multiple online events.\n        // We only want to handle one state change\n        if (isOnline === this._isOnline) {\n          return;\n        }\n        this._isOnline = isOnline;\n        if (this._isOnline) {\n          this._startSocket();\n        }\n      });\n    });\n\n    if (typeof addEventListener !== \"undefined\") {\n      this._beforeUnload = this._beforeUnload.bind(this);\n      addEventListener(\"beforeunload\", this._beforeUnload);\n    }\n  }\n\n  _initStorage(Storage) {\n    this._persister = new Storage(`instant_${this.config.appId}_5`);\n    this.querySubs = new PersistedObject(\n      this._persister,\n      \"querySubs\",\n      {},\n      this._onMergeQuerySubs,\n      querySubsToJSON,\n      querySubsFromJSON,\n    );\n    this.pendingMutations = new PersistedObject(\n      this._persister,\n      \"pendingMutations\",\n      new Map(),\n      this._onMergePendingMutations,\n      (x) => {\n        return JSON.stringify([...x.entries()]);\n      },\n      (x) => {\n        return new Map(JSON.parse(x));\n      },\n    );\n    this._beforeUnloadCbs.push(() => {\n      this.pendingMutations.flush();\n      this.querySubs.flush();\n    });\n  }\n\n  _beforeUnload() {\n    for (const cb of this._beforeUnloadCbs) {\n      cb();\n    }\n  }\n\n  /**\n   * @param {'enqueued' | 'pending' | 'synced' | 'timeout' |  'error' } status\n   * @param string clientId\n   * @param {{message?: string, hint?: string, error?: Error}} [errDetails]\n   */\n  _finishTransaction(status, clientId, errDetails) {\n    const dfd = this.mutationDeferredStore.get(clientId);\n    this.mutationDeferredStore.delete(clientId);\n    const ok = status !== \"error\" && status !== \"timeout\";\n\n    if (!dfd && !ok) {\n      // console.erroring here, as there are no listeners to let know\n      console.error(\"Mutation failed\", { status, clientId, ...errDetails });\n    }\n    if (!dfd) {\n      return;\n    }\n    if (ok) {\n      dfd.resolve({ status, clientId });\n    } else {\n      dfd.reject({ status, clientId, ...errDetails });\n    }\n  }\n\n  _setStatus(status, err) {\n    this.status = status;\n    this._errorMessage = err;\n  }\n\n  /**\n   *  merge querySubs from storage and in memory. Has the following side\n   *  effects:\n   *  - We notify all queryCbs because results may been added during merge\n   */\n  _onMergeQuerySubs = (_storageSubs, inMemorySubs) => {\n    const storageSubs = _storageSubs || {};\n    const ret = { ...inMemorySubs };\n\n    // Consider an inMemorySub with no result;\n    // If we have a result from storageSubs, let's add it\n    Object.entries(inMemorySubs).forEach(([hash, querySub]) => {\n      const storageResult = storageSubs?.[hash]?.result;\n      const memoryResult = querySub.result;\n      if (storageResult && !memoryResult) {\n        ret[hash].result = storageResult;\n      }\n    });\n\n    // Consider a storageSub with no corresponding inMemorySub\n    // This means that at least at this point,\n    // the user has not asked to subscribe to the query.\n    // We may _still_ want to add it, because in just a\n    // few milliseconds, the user will ask to subscribe to the\n    // query.\n    // For now, we can't really tell if the user will ask to subscribe\n    // or not. So for now let's just add the first 10 queries from storage.\n    // Eventually, we could be smarter about this. For example,\n    // we can keep usage information about which queries are popular.\n    const storageKsToAdd = Object.keys(storageSubs)\n      .filter((k) => !inMemorySubs[k])\n      .slice(0, 10);\n\n    storageKsToAdd.forEach((k) => {\n      ret[k] = storageSubs[k];\n    });\n\n    // Okay, now we have merged our querySubs\n    this.querySubs.set((_) => ret);\n\n    this.loadedNotifyAll();\n  };\n\n  /**\n   * merge pendingMutations from storage and in memory. Has a side effect of\n   * sending mutations that were stored but not acked\n   */\n  _onMergePendingMutations = (storageMuts, inMemoryMuts) => {\n    const ret = new Map([...storageMuts.entries(), ...inMemoryMuts.entries()]);\n    this.pendingMutations.set((_) => ret);\n    this.loadedNotifyAll();\n    const rewrittenStorageMuts = this._rewriteMutations(\n      this.attrs,\n      storageMuts,\n    );\n    rewrittenStorageMuts.forEach((mut, k) => {\n      if (!inMemoryMuts.has(k) && !mut[\"tx-id\"]) {\n        this._sendMutation(k, mut);\n      }\n    });\n  };\n\n  /**\n   * On refresh we clear out pending mutations that we know have been applied\n   * by the server and thus those mutations are applied in the instaql result\n   * returned by the server\n   */\n  _cleanPendingMutations(txId) {\n    this.pendingMutations.set((prev) => {\n      const copy = new Map(prev);\n      [...prev.entries()].forEach(([eventId, mut]) => {\n        if (mut[\"tx-id\"] <= txId) {\n          copy.delete(eventId);\n        }\n      });\n      return copy;\n    });\n  }\n\n  _flushEnqueuedRoomData(roomId) {\n    const enqueuedUserPresence = this._presence[roomId]?.result?.user;\n    const enqueuedBroadcasts = this._broadcastQueue[roomId];\n\n    this._broadcastQueue[roomId] = [];\n\n    if (enqueuedUserPresence) {\n      this._trySetPresence(roomId, enqueuedUserPresence);\n    }\n\n    if (enqueuedBroadcasts) {\n      for (const item of enqueuedBroadcasts) {\n        const { topic, roomType, data } = item;\n        this._tryBroadcast(roomId, roomType, topic, data);\n      }\n    }\n  }\n\n  _handleReceive(msg) {\n    // opt-out, enabled by default if schema\n    const enableCardinalityInference =\n      Boolean(this.config.schema) &&\n      (\"cardinalityInference\" in this.config\n        ? Boolean(this.config.cardinalityInference)\n        : true);\n\n    switch (msg.op) {\n      case \"init-ok\":\n        this._setStatus(STATUS.AUTHENTICATED);\n        this._reconnectTimeoutMs = 0;\n        this._setAttrs(msg.attrs);\n        this._flushPendingMessages();\n        // (EPH): set session-id, so we know\n        // which item is us\n        this._sessionId = msg[\"session-id\"];\n\n        for (const roomId of Object.keys(this._rooms)) {\n          this._tryJoinRoom(roomId);\n        }\n        break;\n      case \"add-query-exists\":\n        this.notifyOneQueryOnce(weakHash(msg.q));\n        break;\n      case \"add-query-ok\":\n        const { q, result, \"processed-tx-id\": addQueryTxId } = msg;\n        this._cleanPendingMutations(addQueryTxId);\n        const hash = weakHash(q);\n        const pageInfo = result?.[0]?.data?.[\"page-info\"];\n        const aggregate = result?.[0]?.data?.[\"aggregate\"];\n        const triples = extractTriples(result);\n        const store = s.createStore(\n          this.attrs,\n          triples,\n          enableCardinalityInference,\n          this._linkIndex,\n        );\n        this.querySubs.set((prev) => {\n          prev[hash].result = { store, pageInfo, aggregate };\n          return prev;\n        });\n        this.notifyOne(hash);\n        this.notifyOneQueryOnce(hash);\n        break;\n      case \"refresh-ok\":\n        const { computations, attrs, \"processed-tx-id\": refreshOkTxId } = msg;\n        this._cleanPendingMutations(refreshOkTxId);\n        this._setAttrs(attrs);\n        const updates = computations.map((x) => {\n          const q = x[\"instaql-query\"];\n          const result = x[\"instaql-result\"];\n          const hash = weakHash(q);\n          const triples = extractTriples(result);\n          const store = s.createStore(\n            this.attrs,\n            triples,\n            enableCardinalityInference,\n            this._linkIndex,\n          );\n          const pageInfo = result?.[0]?.data?.[\"page-info\"];\n          const aggregate = result?.[0]?.data?.[\"aggregate\"];\n          return { hash, store, pageInfo, aggregate };\n        });\n        updates.forEach(({ hash, store, pageInfo, aggregate }) => {\n          this.querySubs.set((prev) => {\n            prev[hash].result = { store, pageInfo, aggregate };\n            return prev;\n          });\n        });\n        updates.forEach(({ hash }) => {\n          this.notifyOne(hash);\n        });\n        break;\n      case \"transact-ok\":\n        const { \"client-event-id\": eventId, \"tx-id\": txId } = msg;\n        const muts = this._rewriteMutations(\n          this.attrs,\n          this.pendingMutations.currentValue,\n        );\n        const prevMutation = muts.get(eventId);\n        if (!prevMutation) {\n          break;\n        }\n\n        const mut = { ...prevMutation, \"tx-id\": txId };\n\n        this.pendingMutations.set((prev) => {\n          prev.set(eventId, mut);\n          return prev;\n        });\n\n        this._finishTransaction(\"synced\", eventId);\n\n        const newAttrs = prevMutation[\"tx-steps\"]\n          .filter(([action, ..._args]) => action === \"add-attr\")\n          .map(([_action, attr]) => attr)\n          .concat(Object.values(this.attrs));\n        this._setAttrs(newAttrs);\n        break;\n      case \"refresh-presence\":\n        const roomId = msg[\"room-id\"];\n        this._setPresencePeers(roomId, msg.data);\n        this._notifyPresenceSubs(roomId);\n        break;\n      case \"server-broadcast\":\n        const room = msg[\"room-id\"];\n        const topic = msg.topic;\n        this._notifyBroadcastSubs(room, topic, msg);\n        break;\n      case \"join-room-ok\":\n        const loadingRoomId = msg[\"room-id\"];\n        const joinedRoom = this._rooms[loadingRoomId];\n\n        if (!joinedRoom) {\n          if (this._roomsPendingLeave[roomId]) {\n            this._tryLeaveRoom(loadingRoomId);\n            delete this._roomsPendingLeave[roomId];\n          }\n\n          break;\n        }\n\n        joinedRoom.isConnected = true;\n        this._notifyPresenceSubs(loadingRoomId);\n        this._flushEnqueuedRoomData(loadingRoomId);\n        break;\n      case \"join-room-error\":\n        const errorRoomId = msg[\"room-id\"];\n        const errorRoom = this._rooms[errorRoomId];\n        if (errorRoom) {\n          errorRoom.error = msg[\"error\"];\n        }\n        this._notifyPresenceSubs(errorRoomId);\n        break;\n      case \"error\":\n        this._handleReceiveError(msg);\n        break;\n      default:\n        break;\n    }\n  }\n\n  /**\n   * @param {'timeout' | 'error'} status\n   * @param {string} eventId\n   * @param {{message?: string, hint?: string, error?: Error}} errDetails\n   */\n  _handleMutationError(status, eventId, errDetails) {\n    const mut = this.pendingMutations.currentValue.get(eventId);\n\n    if (mut && (status !== \"timeout\" || !mut[\"tx-id\"])) {\n      this.pendingMutations.set((prev) => {\n        prev.delete(eventId);\n        return prev;\n      });\n      this.notifyAll();\n      this.notifyAttrsSubs();\n      this.notifyMutationErrorSubs(errDetails);\n      this._finishTransaction(status, eventId, errDetails);\n    }\n  }\n\n  _handleReceiveError(msg) {\n    const eventId = msg[\"client-event-id\"];\n    const prevMutation = this.pendingMutations.currentValue.get(eventId);\n    const errorMessage = {\n      message: msg.message || \"Uh-oh, something went wrong. Ping Joe & Stopa.\",\n    };\n\n    if (prevMutation) {\n      // This must be a transaction error\n      const errDetails = {\n        message: msg.message,\n        hint: msg.hint,\n      };\n      this._handleMutationError(\"error\", eventId, errDetails);\n      return;\n    }\n\n    const q = msg.q || msg[\"original-event\"]?.q;\n    if (q) {\n      const hash = weakHash(q);\n\n      // This must be a query error\n      this.querySubs.set((prev) => {\n        delete prev[hash];\n        return prev;\n      });\n      this.notifyQueryError(weakHash(q), errorMessage);\n      this.notifyQueryOnceError(hash, eventId, errorMessage);\n      return;\n    }\n\n    const isInitError = msg[\"original-event\"]?.op === \"init\";\n    if (isInitError) {\n      if (\n        msg.type === \"record-not-found\" &&\n        msg.hint?.[\"record-type\"] === \"app-user\"\n      ) {\n        // User has been logged out\n        this.changeCurrentUser(null);\n        return;\n      }\n\n      // We failed to init\n\n      this._setStatus(STATUS.ERRORED, errorMessage);\n      this.notifyAll();\n      return;\n    }\n    // We've caught some error which has no corresponding listener.\n    // Let's console.error to let the user know.\n    const errorObj = { ...msg };\n    delete errorObj.message;\n    delete errorObj.hint;\n    console.error(msg.message, errorObj);\n    if (msg.hint) {\n      console.error(\n        \"This error comes with some debugging information. Here it is: \\n\",\n        msg.hint,\n      );\n    }\n  }\n\n  notifyQueryOnceError(hash, eventId, e) {\n    const r = this.queryOnceDfds[hash]?.find((r) => r.eventId === eventId);\n    if (!r) return;\n    r.dfd.reject(e);\n  }\n\n  _setAttrs(attrs) {\n    this.attrs = attrs.reduce((acc, attr) => {\n      acc[attr.id] = attr;\n      return acc;\n    }, {});\n\n    this.notifyAttrsSubs();\n  }\n\n  // ---------------------------\n  // Queries\n\n  getPreviousResult = (q) => {\n    const hash = weakHash(q);\n    return this.dataForQuery(hash);\n  };\n\n  _startQuerySub(q, hash) {\n    const eventId = uuid();\n    this.querySubs.set((prev) => {\n      prev[hash] = prev[hash] || { q, result: null, eventId };\n      return prev;\n    });\n    this._trySendAuthed(eventId, { op: \"add-query\", q });\n\n    return eventId;\n  }\n\n  /**\n   *  When a user subscribes to a query the following side effects occur:\n   *\n   *  - We update querySubs to include the new query\n   *  - We update queryCbs to include the new cb\n   *  - If we already have a result for the query we call cb immediately\n   *  - We send the server an `add-query` message\n   *\n   *  Returns an unsubscribe function\n   */\n  subscribeQuery(q, cb) {\n    const hash = weakHash(q);\n\n    const prevResult = this.getPreviousResult(q);\n    if (prevResult) {\n      cb(prevResult);\n    }\n\n    this.queryCbs[hash] = this.queryCbs[hash] ?? [];\n    this.queryCbs[hash].push({ q, cb });\n\n    this._startQuerySub(q, hash);\n\n    return () => {\n      this._unsubQuery(q, hash, cb);\n    };\n  }\n\n  async queryOnce(q) {\n    if (!this._isOnline) {\n      throw new Error(\n        \"Offline: Cannot execute query because the device is offline.\",\n      );\n    }\n\n    const hash = weakHash(q);\n    const dfd = new Deferred();\n\n    const eventId = this._startQuerySub(q, hash);\n\n    this.queryOnceDfds[hash] = this.queryOnceDfds[hash] ?? [];\n    this.queryOnceDfds[hash].push({ q, dfd, eventId });\n\n    setTimeout(\n      () => dfd.reject(new Error(\"Query timed out\")),\n      QUERY_ONCE_TIMEOUT,\n    );\n\n    return dfd.promise;\n  }\n\n  _completeQueryOnce(q, hash, dfd) {\n    if (!this.queryOnceDfds[hash]) return;\n\n    this.queryOnceDfds[hash] = this.queryOnceDfds[hash].filter(\n      (r) => r.dfd !== dfd,\n    );\n\n    this._cleanupQuery(q, hash);\n  }\n\n  _unsubQuery(q, hash, cb) {\n    if (!this.queryCbs[hash]) return;\n\n    this.queryCbs[hash] = this.queryCbs[hash].filter((r) => r.cb !== cb);\n\n    this._cleanupQuery(q, hash);\n  }\n\n  _cleanupQuery(q, hash) {\n    const hasListeners =\n      this.queryCbs[hash]?.length || this.queryOnceDfds[hash]?.length;\n\n    if (hasListeners) return;\n\n    delete this.queryCbs[hash];\n    delete this.queryOnceDfds[hash];\n\n    this._trySendAuthed(uuid(), { op: \"remove-query\", q });\n  }\n\n  // When we `pushTx`, it's possible that we don't yet have `this.attrs`\n  // This means that `tx-steps` in `pendingMutations` will include `add-attr`\n  // commands for attrs that already exist.\n  //\n  // This will also affect `add-triple` and `retract-triple` which\n  // reference attr-ids that do not match the server.\n  //\n  // We fix this by rewriting `tx-steps` in each `pendingMutation`.\n  // We remove `add-attr` commands for attrs that already exist.\n  // We update `add-triple` and `retract-triple` commands to use the\n  // server attr-ids.\n  _rewriteMutations(attrs, muts) {\n    if (!attrs) return muts;\n    const findExistingAttr = (attr) => {\n      const [_, etype, label] = attr[\"forward-identity\"];\n      const existing = instaml.getAttrByFwdIdentName(attrs, etype, label);\n      return existing;\n    };\n    const findReverseAttr = (attr) => {\n      const [_, etype, label] = attr[\"forward-identity\"];\n      const revAttr = instaml.getAttrByReverseIdentName(attrs, etype, label);\n      return revAttr;\n    };\n    const mapping = { attrIdMap: {}, refSwapAttrIds: new Set() };\n    const rewriteTxSteps = (txSteps) => {\n      const retTxSteps = [];\n      for (const txStep of txSteps) {\n        const [action] = txStep;\n\n        // Handles add-attr\n        // If existing, we drop it, and track it\n        // to update add/retract triples\n        if (action === \"add-attr\") {\n          const [_action, attr] = txStep;\n          const existing = findExistingAttr(attr);\n          if (existing) {\n            mapping.attrIdMap[attr.id] = existing.id;\n            continue;\n          }\n          if (attr[\"value-type\"] === \"ref\") {\n            const revAttr = findReverseAttr(attr);\n            if (revAttr) {\n              mapping.attrIdMap[attr.id] = revAttr.id;\n              mapping.refSwapAttrIds.add(attr.id);\n              continue;\n            }\n          }\n        }\n\n        // Handles add-triple|retract-triple\n        // If in mapping, we update the attr-id\n        const newTxStep = instaml.rewriteStep(mapping, txStep);\n\n        retTxSteps.push(newTxStep);\n      }\n      return retTxSteps;\n    };\n    const rewritten = new Map();\n    for (const [k, mut] of muts.entries()) {\n      rewritten.set(k, { ...mut, \"tx-steps\": rewriteTxSteps(mut[\"tx-steps\"]) });\n    }\n    return rewritten;\n  }\n\n  // ---------------------------\n  // Transact\n\n  optimisticAttrs() {\n    const pendingMutationSteps = [\n      ...this.pendingMutations.currentValue.values(),\n    ] // hack due to Map()\n      .flatMap((x) => x[\"tx-steps\"]);\n\n    const deletedAttrIds = new Set(\n      pendingMutationSteps\n        .filter(([action, _attr]) => action === \"delete-attr\")\n        .map(([_action, id]) => id),\n    );\n\n    const pendingAttrs = [];\n    for (const [_action, attr] of pendingMutationSteps) {\n      if (_action === \"add-attr\") {\n        pendingAttrs.push(attr);\n      } else if (\n        _action === \"update-attr\" &&\n        attr.id &&\n        this.attrs?.[attr.id]\n      ) {\n        const fullAttr = { ...this.attrs[attr.id], ...attr };\n        pendingAttrs.push(fullAttr);\n      }\n    }\n\n    const attrsWithoutDeleted = [\n      ...Object.values(this.attrs || {}),\n      ...pendingAttrs,\n    ].filter((a) => !deletedAttrIds.has(a.id));\n\n    const attrsRecord = Object.fromEntries(\n      attrsWithoutDeleted.map((a) => [a.id, a]),\n    );\n\n    return attrsRecord;\n  }\n\n  /** Runs instaql on a query and a store */\n  dataForQuery(hash) {\n    const errorMessage = this._errorMessage;\n    if (errorMessage) {\n      return { error: errorMessage };\n    }\n    if (!this.querySubs) return;\n    if (!this.pendingMutations) return;\n    const querySubVersion = this.querySubs.version();\n    const querySubs = this.querySubs.currentValue;\n    const pendingMutationsVersion = this.pendingMutations.version();\n    const pendingMutations = this.pendingMutations.currentValue;\n\n    const { q, result } = querySubs[hash] || {};\n    if (!result) return;\n\n    const cached = this._dataForQueryCache[hash];\n    if (\n      cached &&\n      querySubVersion === cached.querySubVersion &&\n      pendingMutationsVersion === cached.pendingMutationsVersion\n    ) {\n      return cached.data;\n    }\n\n    const { store, pageInfo, aggregate } = result;\n    const muts = this._rewriteMutations(store.attrs, pendingMutations);\n\n    const txSteps = [...muts.values()].flatMap((x) => x[\"tx-steps\"]);\n    const newStore = s.transact(store, txSteps);\n    const resp = instaql({ store: newStore, pageInfo, aggregate }, q);\n\n    this._dataForQueryCache[hash] = {\n      querySubVersion,\n      pendingMutationsVersion,\n      data: resp,\n    };\n\n    return resp;\n  }\n\n  /** Re-run instaql and call all callbacks with new data */\n  notifyOne = (hash) => {\n    const cbs = this.queryCbs[hash] ?? [];\n    const prevData = this._dataForQueryCache[hash]?.data;\n    const data = this.dataForQuery(hash);\n\n    if (!data) return;\n    if (areObjectsDeepEqual(data, prevData)) return;\n\n    cbs.forEach((r) => r.cb(data));\n  };\n\n  notifyOneQueryOnce = (hash) => {\n    const dfds = this.queryOnceDfds[hash] ?? [];\n    const data = this.dataForQuery(hash);\n\n    dfds.forEach((r) => {\n      this._completeQueryOnce(r.q, hash, r.dfd);\n      r.dfd.resolve(data);\n    });\n  };\n\n  notifyQueryError = (hash, error) => {\n    const cbs = this.queryCbs[hash] || [];\n    cbs.forEach((r) => r.cb({ error }));\n  };\n\n  /** Re-compute all subscriptions */\n  notifyAll() {\n    Object.keys(this.queryCbs).forEach((hash) => {\n      this.notifyOne(hash);\n    });\n  }\n\n  loadedNotifyAll() {\n    if (this.pendingMutations.isLoading() || this.querySubs.isLoading()) return;\n    this.notifyAll();\n  }\n\n  /** Applies transactions locally and sends transact message to server */\n  pushTx = (chunks) => {\n    try {\n      const txSteps = instaml.transform(this.optimisticAttrs(), chunks);\n      return this.pushOps(txSteps);\n    } catch (e) {\n      return this.pushOps([], e);\n    }\n  };\n\n  /**\n   * @param {*} txSteps\n   * @param {*} [error]\n   * @returns\n   */\n  pushOps = (txSteps, error) => {\n    const eventId = uuid();\n    const mutation = {\n      op: \"transact\",\n      \"tx-steps\": txSteps,\n      error,\n    };\n    this.pendingMutations.set((prev) => {\n      prev.set(eventId, mutation);\n      return prev;\n    });\n\n    const dfd = new Deferred();\n    this.mutationDeferredStore.set(eventId, dfd);\n    this._sendMutation(eventId, mutation);\n\n    this.notifyAll();\n\n    return dfd.promise;\n  };\n\n  shutdown() {\n    this._isShutdown = true;\n    this._ws.close();\n  }\n\n  /**\n   * Sends mutation to server and schedules a timeout to cancel it if\n   * we don't hear back in time.\n   * Note: If we're offline we don't schedule a timeout, we'll schedule it\n   * later once we're back online and send the mutation again\n   *\n   */\n  _sendMutation(eventId, mutation) {\n    if (mutation.error) {\n      this._handleMutationError(\"error\", eventId, {\n        error: mutation.error,\n        message: mutation.error.message,\n      });\n      return;\n    }\n    if (this.status !== STATUS.AUTHENTICATED) {\n      this._finishTransaction(\"enqueued\", eventId);\n      return;\n    }\n    const timeoutMs = Math.max(\n      5000,\n      this.pendingMutations.currentValue.size * 5000,\n    );\n\n    if (!this._isOnline) {\n      this._finishTransaction(\"enqueued\", eventId);\n    } else {\n      this._trySend(eventId, mutation);\n\n      // If a transaction is pending for over 3 seconds,\n      // we want to unblock the UX, so mark it as pending\n      // and keep trying to process the transaction in the background\n      setTimeout(() => {\n        this._finishTransaction(\"pending\", eventId);\n      }, 3_000);\n\n      setTimeout(() => {\n        if (!this._isOnline) {\n          return;\n        }\n        // If we are here, this means that we have sent this mutation, we are online\n        // but we have not received a response. If it's this long, something must be wrong,\n        // so we error with a timeout.\n        this._handleMutationError(\"timeout\", eventId, {\n          message: \"transaction timed out\",\n        });\n      }, timeoutMs);\n    }\n  }\n\n  // ---------------------------\n  // Websocket\n\n  /** Send messages we accumulated while we were connecting */\n  _flushPendingMessages() {\n    const subs = Object.keys(this.queryCbs).map((hash) => {\n      return this.querySubs.currentValue[hash];\n    });\n    // Note: we should not have any nulls in subs, but we're\n    // doing this defensively just in case.\n    const safeSubs = subs.filter((x) => x);\n    safeSubs.forEach(({ eventId, q }) => {\n      this._trySendAuthed(eventId, { op: \"add-query\", q });\n    });\n\n    Object.values(this.queryOnceDfds)\n      .flat()\n      .forEach(({ eventId, q }) => {\n        this._trySendAuthed(eventId, { op: \"add-query\", q });\n      });\n\n    const muts = this._rewriteMutations(\n      this.attrs,\n      this.pendingMutations.currentValue,\n    );\n    muts.forEach((mut, eventId) => {\n      if (!mut[\"tx-id\"]) {\n        this._sendMutation(eventId, mut);\n      }\n    });\n  }\n\n  _trySendAuthed(eventId, msg) {\n    if (this.status !== STATUS.AUTHENTICATED) {\n      return;\n    }\n    this._trySend(eventId, msg);\n  }\n\n  _trySend(eventId, msg) {\n    if (this._ws.readyState !== WS_OPEN_STATUS) {\n      return;\n    }\n    this._ws.send(JSON.stringify({ \"client-event-id\": eventId, ...msg }));\n  }\n\n  _wsOnOpen = () => {\n    log.info(\"[socket] connected\");\n    this._setStatus(STATUS.OPENED);\n    this.getCurrentUser().then((resp) => {\n      this._trySend(uuid(), {\n        op: \"init\",\n        \"app-id\": this.config.appId,\n        \"refresh-token\": resp.user?.[\"refresh_token\"],\n        // If an admin token is provided for an app, we will\n        // skip all permission checks. This is an advanced feature,\n        // to let users write internal tools\n        // This option is not exposed in `Config`, as it's\n        // not ready for prme time\n        \"__admin-token\": this.config.__adminToken,\n      });\n    });\n  };\n\n  _wsOnMessage = (e) => {\n    this._handleReceive(JSON.parse(e.data.toString()));\n  };\n\n  _wsOnError = (e) => {\n    log.error(\"[socket] error: \", e);\n  };\n\n  _wsOnClose = () => {\n    this._setStatus(STATUS.CLOSED);\n\n    for (const room of Object.values(this._rooms)) {\n      room.isConnected = false;\n    }\n\n    if (this._isShutdown) {\n      log.info(\n        \"[socket-close] socket has been shut down and will not reconnect\",\n      );\n      return;\n    }\n    if (this._isManualClose) {\n      this._isManualClose = false;\n      log.info(\"[socket-close] manual close, will not reconnect\");\n      return;\n    }\n\n    log.info(\"[socket-close] scheduling reconnect\", this._reconnectTimeoutMs);\n    setTimeout(() => {\n      this._reconnectTimeoutMs = Math.min(\n        this._reconnectTimeoutMs + 1000,\n        10000,\n      );\n      if (!this._isOnline) {\n        log.info(\"[socket-close] we are offline, no need to start socket\");\n        return;\n      }\n      this._startSocket();\n    }, this._reconnectTimeoutMs);\n  };\n\n  _ensurePreviousSocketClosed() {\n    if (this._ws && this._ws.readyState === WS_OPEN_STATUS) {\n      this._isManualClose = true;\n      this._ws.close();\n    }\n  }\n\n  _startSocket() {\n    this._ensurePreviousSocketClosed();\n    this._ws = new WebSocket(\n      `${this.config.websocketURI}?app_id=${this.config.appId}`,\n    );\n    this._ws.onopen = this._wsOnOpen;\n    this._ws.onmessage = this._wsOnMessage;\n    this._ws.onclose = this._wsOnClose;\n  }\n\n  /**\n   * Given a key, returns a stable local id, unique to this device and app.\n   *\n   * This can be useful if you want to create guest ids for example.\n   *\n   * Note: If the user deletes their local storage, this id will change.\n   *\n   * We use this._localIdPromises to ensure that we only generate a local\n   * id once, even if multiple callers call this function concurrently.\n   */\n  async getLocalId(name) {\n    const k = `localToken_${name}`;\n    const id = await this._persister.getItem(k);\n    if (id) return id;\n    if (this._localIdPromises[k]) {\n      return this._localIdPromises[k];\n    }\n    const newId = uuid();\n    this._localIdPromises[k] = this._persister\n      .setItem(k, newId)\n      .then(() => newId);\n    return this._localIdPromises[k];\n  }\n\n  // ----\n  // Auth\n  _replaceUrlAfterOAuth() {\n    if (typeof URL === \"undefined\") {\n      return;\n    }\n    const url = new URL(window.location.href);\n    if (url.searchParams.get(OAUTH_REDIRECT_PARAM)) {\n      const startUrl = url.toString();\n      url.searchParams.delete(OAUTH_REDIRECT_PARAM);\n      url.searchParams.delete(\"code\");\n      url.searchParams.delete(\"error\");\n      const newPath =\n        url.pathname +\n        (url.searchParams.size ? \"?\" + url.searchParams : \"\") +\n        url.hash;\n      // Note: In next.js, this will revert to the old state if user navigates\n      //       back. We would need to allow framework specific routing to work\n      //       around that problem.\n      history.replaceState(history.state, \"\", newPath);\n\n      // navigation is part of the HTML spec, but not supported by Safari\n      // or Firefox yet:\n      // https://developer.mozilla.org/en-US/docs/Web/API/Navigation_API#browser_compatibility\n      if (\n        // @ts-ignore (waiting for ts support)\n        typeof navigation === \"object\" &&\n        // @ts-ignore (waiting for ts support)\n        typeof navigation.addEventListener === \"function\" &&\n        // @ts-ignore (waiting for ts support)\n        typeof navigation.removeEventListener === \"function\"\n      ) {\n        let ran = false;\n\n        // The next.js app router will reset the URL when the router loads.\n        // This puts it back after the router loads.\n        const listener = (e) => {\n          if (!ran) {\n            ran = true;\n            // @ts-ignore (waiting for ts support)\n            navigation.removeEventListener(\"navigate\", listener);\n            if (\n              !e.userInitiated &&\n              e.navigationType === \"replace\" &&\n              e.destination?.url === startUrl\n            ) {\n              history.replaceState(history.state, \"\", newPath);\n            }\n          }\n        };\n        // @ts-ignore (waiting for ts support)\n        navigation.addEventListener(\"navigate\", listener);\n      }\n    }\n  }\n\n  /**\n   *\n   * @returns Promise<null | {error: {message: string}}>\n   */\n  async _oauthLoginInit() {\n    if (\n      typeof window === \"undefined\" ||\n      typeof window.location === \"undefined\" ||\n      typeof URLSearchParams === \"undefined\"\n    ) {\n      return null;\n    }\n    const params = new URLSearchParams(window.location.search);\n    if (!params.get(OAUTH_REDIRECT_PARAM)) {\n      return null;\n    }\n\n    const error = params.get(\"error\");\n    if (error) {\n      this._replaceUrlAfterOAuth();\n      return { error: { message: error } };\n    }\n    const code = params.get(\"code\");\n    if (!code) {\n      return null;\n    }\n    this._replaceUrlAfterOAuth();\n    try {\n      const { user } = await authAPI.exchangeCodeForToken({\n        apiURI: this.config.apiURI,\n        appId: this.config.appId,\n        code,\n      });\n      this.setCurrentUser(user);\n      return null;\n    } catch (e) {\n      if (\n        e?.body?.type === \"record-not-found\" &&\n        e?.body?.hint?.[\"record-type\"] === \"app-oauth-code\" &&\n        (await this._hasCurrentUser())\n      ) {\n        // We probably just weren't able to clean up the URL, so\n        // let's just ignore this error\n        return null;\n      }\n      const message = e?.body?.message || \"Error logging in.\";\n      return { error: { message } };\n    }\n  }\n\n  async _waitForOAuthCallbackResponse() {\n    return await this._oauthCallbackResponse;\n  }\n\n  __subscribeMutationErrors(cb) {\n    this.mutationErrorCbs.push(cb);\n\n    return () => {\n      this.mutationErrorCbs = this.mutationErrorCbs.filter((x) => x !== cb);\n    };\n  }\n\n  subscribeAuth(cb) {\n    this.authCbs.push(cb);\n    const currUserCached = this._currentUserCached;\n    if (!currUserCached.isLoading) {\n      cb(this._currentUserCached);\n    }\n    let unsubbed = false;\n    this.getCurrentUser().then((resp) => {\n      if (unsubbed) return;\n      if (areObjectsDeepEqual(resp, currUserCached)) return;\n      cb(resp);\n    });\n    return () => {\n      unsubbed = true;\n      this.authCbs = this.authCbs.filter((x) => x !== cb);\n    };\n  }\n\n  subscribeAttrs(cb) {\n    this.attrsCbs.push(cb);\n\n    if (this.attrs) {\n      cb(this.attrs);\n    }\n\n    return () => {\n      this.attrsCbs = this.attrsCbs.filter((x) => x !== cb);\n    };\n  }\n\n  notifyAuthSubs(user) {\n    this.authCbs.forEach((cb) => cb(user));\n  }\n\n  notifyMutationErrorSubs(error) {\n    this.mutationErrorCbs.forEach((cb) => cb(error));\n  }\n\n  notifyAttrsSubs() {\n    if (!this.attrs) return;\n    const oas = this.optimisticAttrs();\n    this.attrsCbs.forEach((cb) => cb(oas));\n  }\n\n  async setCurrentUser(user) {\n    await this._persister.setItem(currentUserKey, JSON.stringify(user));\n  }\n\n  getCurrentUserCached() {\n    return this._currentUserCached;\n  }\n\n  async getCurrentUser() {\n    const oauthResp = await this._waitForOAuthCallbackResponse();\n    if (oauthResp?.error) {\n      const errorV = { error: oauthResp.error, user: undefined };\n      this._currentUserCached = { isLoading: false, ...errorV };\n      return errorV;\n    }\n    const user = await this._persister.getItem(currentUserKey);\n    const userV = { user: JSON.parse(user), error: undefined };\n    this._currentUserCached = {\n      isLoading: false,\n      ...userV,\n    };\n    return userV;\n  }\n\n  async _hasCurrentUser() {\n    const user = await this._persister.getItem(currentUserKey);\n    return JSON.parse(user) != null;\n  }\n\n  async changeCurrentUser(newUser) {\n    const { user: oldUser } = await this.getCurrentUser();\n    if (areObjectsDeepEqual(oldUser, newUser)) {\n      // We were already logged in as the newUser, don't\n      // bother updating\n      return;\n    }\n    await this.setCurrentUser(newUser);\n    // We need to remove all `result` from querySubs,\n    // as they are no longer valid for the new user\n    this.updateUser(newUser);\n\n    try {\n      this._broadcastChannel?.postMessage({ type: \"auth\" });\n    } catch (error) {\n      console.error(\"Error posting message to broadcast channel\", error);\n    }\n  }\n\n  updateUser(newUser) {\n    const newV = { error: undefined, user: newUser };\n    this._currentUserCached = { isLoading: false, ...newV };\n    this.querySubs.set((prev) => {\n      Object.keys(prev).forEach((k) => {\n        delete prev[k].result;\n      });\n      return prev;\n    });\n    this._reconnectTimeoutMs = 0;\n    this._ws.close();\n    this._oauthCallbackResponse = null;\n    this.notifyAuthSubs(newV);\n  }\n\n  sendMagicCode({ email }) {\n    return authAPI.sendMagicCode({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      email: email,\n    });\n  }\n\n  async signInWithMagicCode({ email, code }) {\n    const res = await authAPI.verifyMagicCode({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      email,\n      code,\n    });\n    this.changeCurrentUser(res.user);\n    return res;\n  }\n\n  async signInWithCustomToken(authToken) {\n    const res = await authAPI.verifyRefreshToken({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      refreshToken: authToken,\n    });\n    this.changeCurrentUser(res.user);\n  }\n\n  async signOut() {\n    const currentUser = await this.getCurrentUser();\n    const refreshToken = currentUser?.user?.refresh_token;\n    if (refreshToken) {\n      try {\n        await authAPI.signOut({\n          apiURI: this.config.apiURI,\n          appId: this.config.appId,\n          refreshToken,\n        });\n      } catch (e) {}\n    }\n\n    this.changeCurrentUser(null);\n  }\n\n  /**\n   * Creates an OAuth authorization URL.\n   * @param {Object} params - The parameters to create the authorization URL.\n   * @param {string} params.clientName - The name of the client requesting authorization.\n   * @param {string} params.redirectURL - The URL to redirect users to after authorization.\n   * @returns {string} The created authorization URL.\n   */\n  createAuthorizationURL({ clientName, redirectURL }) {\n    const { apiURI, appId } = this.config;\n    return `${apiURI}/runtime/oauth/start?app_id=${appId}&client_name=${clientName}&redirect_uri=${redirectURL}`;\n  }\n\n  async exchangeCodeForToken({ code, codeVerifier }) {\n    const res = await authAPI.exchangeCodeForToken({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      code: code,\n      codeVerifier,\n    });\n    this.changeCurrentUser(res.user);\n    return res;\n  }\n\n  issuerURI() {\n    const { apiURI, appId } = this.config;\n    return `${apiURI}/runtime/${appId}`;\n  }\n\n  /**\n   * @param {Object} params\n   * @param {string} params.clientName - The name of the client requesting authorization.\n   * @param {string} params.idToken - The id_token from the external service\n   * @param {string | null | undefined} [params.nonce] - The nonce used when requesting the id_token from the external service\n   */\n  async signInWithIdToken({ idToken, clientName, nonce }) {\n    const currentUser = await this.getCurrentUser();\n    const refreshToken = currentUser?.user?.refresh_token;\n\n    const res = await authAPI.signInWithIdToken({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      idToken,\n      clientName,\n      nonce,\n      refreshToken,\n    });\n    this.changeCurrentUser(res.user);\n    return res;\n  }\n\n  // --------\n  // Rooms\n\n  joinRoom(roomId) {\n    if (!this._rooms[roomId]) {\n      this._rooms[roomId] = {\n        isConnected: false,\n        error: undefined,\n      };\n    }\n\n    this._tryJoinRoom(roomId);\n\n    return () => {\n      this._cleanupRoom(roomId);\n    };\n  }\n\n  _cleanupRoom(roomId) {\n    if (\n      !this._presence[roomId]?.handlers?.length &&\n      !Object.keys(this._broadcastSubs[roomId] ?? {}).length\n    ) {\n      const isConnected = this._rooms[roomId]?.isConnected;\n\n      delete this._rooms[roomId];\n      delete this._presence[roomId];\n      delete this._broadcastSubs[roomId];\n\n      if (isConnected) {\n        this._tryLeaveRoom(roomId);\n      } else {\n        this._roomsPendingLeave[roomId] = true;\n      }\n    }\n  }\n\n  // --------\n  // Presence\n\n  /**\n   * @template {keyof RoomSchema} RoomType\n   * @template {keyof RoomSchema[RoomType]['presence']} Keys\n   * @param {RoomType} roomType\n   * @param {string | number} roomId\n   * @param {import('./presence').PresenceOpts<RoomSchema[RoomType]['presence'], Keys>} opts\n   * @returns {import('./presence').PresenceResponse<RoomSchema[RoomType]['presence'], Keys>}\n   */\n  getPresence(roomType, roomId, opts = {}) {\n    const room = this._rooms[roomId];\n    const presence = this._presence[roomId];\n    if (!room || !presence || !presence.result) return null;\n\n    return {\n      ...buildPresenceSlice(presence.result, opts, this._sessionId),\n      isLoading: !room.isConnected,\n      error: room.error,\n    };\n  }\n\n  /**\n   * @template {keyof RoomSchema} RoomType\n   * @param {RoomType} roomType\n   * @param {string | number} roomId\n   * @param {Partial<RoomSchema[RoomType]['presence']>} partialData\n   */\n  publishPresence(roomType, roomId, partialData) {\n    const room = this._rooms[roomId];\n    const presence = this._presence[roomId];\n\n    if (!room || !presence) {\n      return;\n    }\n\n    presence.result = presence.result || {};\n    const data = {\n      ...presence.result.user,\n      ...partialData,\n    };\n\n    presence.result.user = data;\n\n    if (!room.isConnected) {\n      return;\n    }\n\n    this._trySetPresence(roomId, data);\n    this._notifyPresenceSubs(roomId);\n  }\n\n  _trySetPresence(roomId, data) {\n    this._trySendAuthed(uuid(), {\n      op: \"set-presence\",\n      \"room-id\": roomId,\n      data,\n    });\n  }\n\n  _tryJoinRoom(roomId) {\n    this._trySendAuthed(uuid(), { op: \"join-room\", \"room-id\": roomId });\n    delete this._roomsPendingLeave[roomId];\n  }\n\n  _tryLeaveRoom(roomId) {\n    this._trySendAuthed(uuid(), { op: \"leave-room\", \"room-id\": roomId });\n  }\n\n  /**\n   * @template {keyof RoomSchema} RoomType\n   * @template {keyof RoomSchema[RoomType]['presence']} Keys\n   * @param {RoomType} roomType\n   * @param {string | number} roomId\n   * @param {import('./presence').PresenceOpts<RoomSchema[RoomType]['presence'], Keys>} opts\n   * @param {(slice: import('./presence').PresenceResponse<RoomSchema[RoomType]['presence'], Keys>) => void} cb\n   * @returns {() => void}\n   */\n  subscribePresence(roomType, roomId, opts, cb) {\n    const leaveRoom = this.joinRoom(roomId);\n\n    const handler = { ...opts, roomId, cb, prev: null };\n\n    this._presence[roomId] = this._presence[roomId] || {};\n    this._presence[roomId].handlers = this._presence[roomId].handlers || [];\n    this._presence[roomId].handlers.push(handler);\n\n    this._notifyPresenceSub(roomId, handler);\n\n    return () => {\n      this._presence[roomId].handlers =\n        this._presence[roomId]?.handlers?.filter((x) => x !== handler) ?? [];\n\n      leaveRoom();\n    };\n  }\n\n  _notifyPresenceSubs(roomId) {\n    this._presence[roomId]?.handlers?.forEach((handler) => {\n      this._notifyPresenceSub(roomId, handler);\n    });\n  }\n\n  _notifyPresenceSub(roomId, handler) {\n    const slice = this.getPresence(\"\", roomId, handler);\n\n    if (!slice) {\n      return;\n    }\n\n    if (handler.prev && !hasPresenceResponseChanged(slice, handler.prev)) {\n      return;\n    }\n\n    handler.prev = slice;\n    handler.cb(slice);\n  }\n\n  _setPresencePeers(roomId, data) {\n    const sessions = { ...data };\n    // no need to keep track of `user`\n    delete sessions[this._sessionId];\n    const peers = Object.fromEntries(\n      Object.entries(sessions).map(([k, v]) => [k, v.data]),\n    );\n\n    this._presence[roomId] = this._presence[roomId] || {};\n    this._presence[roomId].result = this._presence[roomId].result || {};\n    this._presence[roomId].result.peers = peers;\n  }\n\n  // --------\n  // Broadcast\n\n  publishTopic({ roomType, roomId, topic, data }) {\n    const room = this._rooms[roomId];\n\n    if (!room) {\n      return;\n    }\n\n    if (!room.isConnected) {\n      this._broadcastQueue[roomId] = this._broadcastQueue[roomId] ?? [];\n      this._broadcastQueue[roomId].push({ topic, roomType, data });\n\n      return;\n    }\n\n    this._tryBroadcast(roomId, roomType, topic, data);\n  }\n\n  _tryBroadcast(roomId, roomType, topic, data) {\n    this._trySendAuthed(uuid(), {\n      op: \"client-broadcast\",\n      \"room-id\": roomId,\n      roomType,\n      topic,\n      data,\n    });\n  }\n\n  subscribeTopic(roomId, topic, cb) {\n    const leaveRoom = this.joinRoom(roomId);\n\n    this._broadcastSubs[roomId] = this._broadcastSubs[roomId] || {};\n    this._broadcastSubs[roomId][topic] =\n      this._broadcastSubs[roomId][topic] || [];\n    this._broadcastSubs[roomId][topic].push(cb);\n    this._presence[roomId] = this._presence[roomId] || {};\n\n    return () => {\n      this._broadcastSubs[roomId][topic] = this._broadcastSubs[roomId][\n        topic\n      ].filter((x) => x !== cb);\n\n      if (!this._broadcastSubs[roomId][topic].length) {\n        delete this._broadcastSubs[roomId][topic];\n      }\n\n      leaveRoom();\n    };\n  }\n\n  _notifyBroadcastSubs(room, topic, msg) {\n    this._broadcastSubs?.[room]?.[topic]?.forEach((cb) => {\n      const data = msg.data?.data;\n\n      const peer =\n        msg.data[\"peer-id\"] === this._sessionId\n          ? this._presence[room]?.result?.user\n          : this._presence[room]?.result?.peers?.[msg.data[\"peer-id\"]];\n\n      return cb(data, peer);\n    });\n  }\n\n  // --------\n  // Storage\n\n  async upload(path, file) {\n    const currentUser = await this.getCurrentUser();\n    const refreshToken = currentUser?.user?.refresh_token;\n    const fileName = path || file.name;\n    const url = await StorageApi.getSignedUploadUrl({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      fileName: fileName,\n      refreshToken: refreshToken,\n    });\n    const isSuccess = await StorageApi.upload(url, file);\n\n    return isSuccess;\n  }\n\n  async getDownloadUrl(path) {\n    const currentUser = await this.getCurrentUser();\n    const refreshToken = currentUser?.user?.refresh_token;\n    const url = await StorageApi.getDownloadUrl({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      path: path,\n      refreshToken: refreshToken,\n    });\n\n    return url;\n  }\n\n  async deleteFile(path) {\n    const currentUser = await this.getCurrentUser();\n    const refreshToken = currentUser?.user?.refresh_token;\n    const result = await StorageApi.deleteFile({\n      apiURI: this.config.apiURI,\n      appId: this.config.appId,\n      path: path,\n      refreshToken: refreshToken,\n    });\n\n    return result;\n  }\n}\n", "import type { RoomSchemaShape } from \"./presence\";\n\nexport class LinkAttrDef<\n  Cardinality extends CardinalityKind,\n  EntityName extends string,\n> {\n  constructor(\n    public entityName: EntityName,\n    public cardinality: Cardinality,\n  ) {}\n}\n\nexport class DataAttrDef<ValueType, IsRequired extends boolean> {\n  constructor(\n    public valueType: ValueTypes,\n    public required: IsRequired,\n    public config: {\n      indexed: boolean;\n      unique: boolean;\n      // clientValidator?: (value: ValueType) => boolean;\n    } = { indexed: false, unique: false },\n  ) {}\n\n  optional() {\n    return new DataAttrDef<ValueType, false>(this.valueType, false);\n  }\n\n  unique() {\n    return new DataAttrDef<ValueType, IsRequired>(\n      this.valueType,\n      this.required,\n      {\n        ...this.config,\n        unique: true,\n      },\n    );\n  }\n\n  indexed() {\n    return new DataAttrDef<ValueType, IsRequired>(\n      this.valueType,\n      this.required,\n      {\n        ...this.config,\n        indexed: true,\n      },\n    );\n  }\n\n  // clientValidate(clientValidator: (value: ValueType) => boolean) {\n  //   return new DataAttrDef(this.valueType, this.required, {\n  //     ...this.config,\n  //     clientValidator,\n  //   });\n  // }\n}\n\nexport class InstantGraph<\n  Entities extends EntitiesDef,\n  Links extends LinksDef<Entities>,\n  RoomSchema extends RoomSchemaShape = {},\n> {\n  constructor(\n    public entities: Entities,\n    public links: Links,\n  ) {}\n\n  withRoomSchema<_RoomSchema extends RoomSchemaShape>() {\n    return new InstantGraph<Entities, Links, _RoomSchema>(\n      this.entities,\n      this.links,\n    );\n  }\n}\n\n// ==========\n// base types\n\nexport type ValueTypes = \"string\" | \"number\" | \"boolean\" | \"json\";\n\nexport type CardinalityKind = \"one\" | \"many\";\n\nexport type AttrsDefs = Record<string, DataAttrDef<any, any>>;\n\nexport class EntityDef<\n  Attrs extends AttrsDefs,\n  Links extends Record<string, LinkAttrDef<any, any>>,\n  AsType,\n> {\n  constructor(\n    public attrs: Attrs,\n    public links: Links,\n  ) {}\n\n  asType<\n    _AsType extends Partial<{\n      [AttrName in keyof Attrs]: Attrs[AttrName] extends DataAttrDef<\n        infer ValueType,\n        infer IsRequired\n      >\n        ? IsRequired extends true\n          ? ValueType\n          : ValueType | undefined\n        : never;\n    }>,\n  >() {\n    return new EntityDef<Attrs, Links, _AsType>(this.attrs, this.links);\n  }\n}\n\nexport type EntitiesDef = Record<string, EntityDef<any, any, any>>;\n\nexport type LinksDef<Entities extends EntitiesDef> = Record<\n  string,\n  LinkDef<\n    Entities,\n    keyof Entities,\n    string,\n    CardinalityKind,\n    keyof Entities,\n    string,\n    CardinalityKind\n  >\n>;\n\nexport type LinkDef<\n  Entities extends EntitiesDef,\n  FwdEntity extends keyof Entities,\n  FwdAttr extends string,\n  FwdCardinality extends CardinalityKind,\n  RevEntity extends keyof Entities,\n  RevAttr extends string,\n  RevCardinality extends CardinalityKind,\n> = {\n  forward: {\n    on: FwdEntity;\n    label: FwdAttr;\n    has: FwdCardinality;\n  };\n  reverse: {\n    on: RevEntity;\n    label: RevAttr;\n    has: RevCardinality;\n  };\n};\n\n// ==========\n// derived types\n\nexport type EntitiesWithLinks<\n  Entities extends EntitiesDef,\n  Links extends LinksDef<Entities>,\n> = {\n  [EntityName in keyof Entities]: EntityDef<\n    Entities[EntityName][\"attrs\"],\n    EntityForwardLinksMap<EntityName, Entities, Links> &\n      EntityReverseLinksMap<EntityName, Entities, Links>,\n    Entities[EntityName] extends EntityDef<any, any, infer O>\n      ? O extends void\n        ? void\n        : O\n      : void\n  >;\n};\n\ntype EntityForwardLinksMap<\n  EntityName extends keyof Entities,\n  Entities extends EntitiesDef,\n  Links extends LinksDef<Entities>,\n  LinkIndexFwd = LinksIndexedByEntity<Entities, Links, \"reverse\">,\n> = EntityName extends keyof LinkIndexFwd\n  ? {\n      [LinkName in keyof LinkIndexFwd[EntityName]]: LinkIndexFwd[EntityName][LinkName] extends LinkDef<\n        Entities,\n        infer RelatedEntityName,\n        any,\n        any,\n        any,\n        any,\n        infer Cardinality\n      >\n        ? {\n            entityName: RelatedEntityName;\n            cardinality: Cardinality;\n          }\n        : never;\n    }\n  : {};\n\ntype EntityReverseLinksMap<\n  EntityName extends keyof Entities,\n  Entities extends EntitiesDef,\n  Links extends LinksDef<Entities>,\n  RevLinkIndex = LinksIndexedByEntity<Entities, Links, \"forward\">,\n> = EntityName extends keyof RevLinkIndex\n  ? {\n      [LinkName in keyof RevLinkIndex[EntityName]]: RevLinkIndex[EntityName][LinkName] extends LinkDef<\n        Entities,\n        any,\n        any,\n        infer Cardinality,\n        infer RelatedEntityName,\n        any,\n        any\n      >\n        ? {\n            entityName: RelatedEntityName;\n            cardinality: Cardinality;\n          }\n        : never;\n    }\n  : {};\n\ntype LinksIndexedByEntity<\n  Entities extends EntitiesDef,\n  Links extends LinksDef<Entities>,\n  Direction extends \"forward\" | \"reverse\",\n> = {\n  [FwdEntity in keyof Entities]: {\n    [LinkName in keyof Links as Links[LinkName][Direction][\"on\"] extends FwdEntity\n      ? Links[LinkName][Direction][\"label\"]\n      : never]: Links[LinkName] extends LinkDef<\n      Entities,\n      infer FwdEntity,\n      infer FwdAttr,\n      infer FwdCardinality,\n      infer RevEntity,\n      infer RevAttr,\n      infer RevCardinality\n    >\n      ? LinkDef<\n          Entities,\n          FwdEntity,\n          FwdAttr,\n          FwdCardinality,\n          RevEntity,\n          RevAttr,\n          RevCardinality\n        >\n      : never;\n  };\n};\n\nexport type ResolveAttrs<\n  Entities extends EntitiesDef,\n  EntityName extends keyof Entities,\n  ResolvedAttrs = {\n    [AttrName in keyof Entities[EntityName][\"attrs\"]]: Entities[EntityName][\"attrs\"][AttrName] extends DataAttrDef<\n      infer ValueType,\n      infer IsRequired\n    >\n      ? IsRequired extends true\n        ? ValueType\n        : ValueType | undefined\n      : never;\n  },\n> =\n  Entities[EntityName] extends EntityDef<any, any, infer AsType>\n    ? AsType extends void\n      ? ResolvedAttrs\n      : Omit<ResolvedAttrs, keyof AsType> & AsType\n    : ResolvedAttrs;\n", "import {\n  EntityDef,\n  DataAttrDef,\n  InstantGraph,\n  type EntitiesDef,\n  type AttrsDefs,\n  type EntitiesWithLinks,\n  type LinksDef,\n} from \"./schemaTypes\";\n\n// ==========\n// API\n\n/**\n * Accepts entities and links and merges them into a single graph definition.\n *\n * @see https://instantdb.com/docs/schema#defining-entities\n * @example\n *   export default i.graph(\n *     {\n *       posts: i.entity({\n *         title: i.string(),\n *         body: i.string(),\n *       }),\n *       comments: i.entity({\n *         body: i.string(),\n *       }),\n *     },\n *     {\n *       postsComments: {\n *         forward: {\n *           on: \"posts\",\n *           has: \"many\",\n *           label: \"comments\",\n *         },\n *         reverse: {\n *           on: \"comments\",\n *           has: \"one\",\n *           label: \"post\",\n *         },\n *       },\n *     },\n *   );\n */\nfunction graph<\n  EntitiesWithoutLinks extends EntitiesDef,\n  const Links extends LinksDef<EntitiesWithoutLinks>,\n>(entities: EntitiesWithoutLinks, links: Links) {\n  return new InstantGraph(\n    enrichEntitiesWithLinks<EntitiesWithoutLinks, Links>(entities, links),\n    // (XXX): LinksDef<any> stems from TypeScript’s inability to reconcile the\n    // type EntitiesWithLinks<EntitiesWithoutLinks, Links> with\n    // EntitiesWithoutLinks. TypeScript is strict about ensuring that types are\n    // correctly aligned and does not allow for substituting a type that might\n    // be broader or have additional properties.\n    links as LinksDef<any>,\n  );\n}\n\n/**\n * Creates an entity definition, to be used in conjunction with `i.graph`.\n *\n * @see https://instantdb.com/docs/schema\n * @example\n *   {\n *     posts: i.entity({\n *       title: i.string(),\n *       body: i.string(),\n *     }),\n *     comments: i.entity({\n *       body: i.string(),\n *     })\n *   }\n */\nfunction entity<Attrs extends AttrsDefs>(\n  attrs: Attrs,\n): EntityDef<Attrs, {}, void> {\n  return new EntityDef(attrs, {});\n}\n\nfunction string<StringEnum extends string = string>(): DataAttrDef<\n  StringEnum,\n  true\n> {\n  return new DataAttrDef(\"string\", true);\n}\n\nfunction number(): DataAttrDef<number, true> {\n  return new DataAttrDef(\"number\", true);\n}\n\nfunction boolean(): DataAttrDef<boolean, true> {\n  return new DataAttrDef(\"boolean\", true);\n}\n\nfunction json<T = any>(): DataAttrDef<T, true> {\n  return new DataAttrDef(\"json\", true);\n}\n\nfunction any(): DataAttrDef<any, true> {\n  return new DataAttrDef(\"json\", true);\n}\n\n// ==========\n// internal\n\nfunction enrichEntitiesWithLinks<\n  EntitiesWithoutLinks extends EntitiesDef,\n  Links extends LinksDef<any>,\n  EnrichedEntities = EntitiesWithLinks<EntitiesWithoutLinks, Links>,\n>(entities: EntitiesWithoutLinks, links: Links): EnrichedEntities {\n  const linksIndex: LinksIndex = { fwd: {}, rev: {} };\n\n  for (const linkDef of Object.values(links)) {\n    linksIndex.fwd[linkDef.forward.on as string] ||= {};\n    linksIndex.rev[linkDef.reverse.on as string] ||= {};\n\n    linksIndex.fwd[linkDef.forward.on as string][linkDef.forward.label] = {\n      entityName: linkDef.reverse.on as string,\n      cardinality: linkDef.forward.has,\n    };\n\n    linksIndex.rev[linkDef.reverse.on as string][linkDef.reverse.label] = {\n      entityName: linkDef.forward.on as string,\n      cardinality: linkDef.reverse.has,\n    };\n  }\n\n  const enrichedEntities = Object.fromEntries(\n    Object.entries(entities).map(([name, def]) => [\n      name,\n      new EntityDef(def.attrs, {\n        ...linksIndex.fwd[name],\n        ...linksIndex.rev[name],\n      }),\n    ]),\n  );\n\n  return enrichedEntities as EnrichedEntities;\n}\n\ntype LinksIndex = Record<\n  \"fwd\" | \"rev\",\n  Record<string, Record<string, { entityName: string; cardinality: string }>>\n>;\n\nexport const i = {\n  // constructs\n  graph,\n  entity,\n  // value types\n  string,\n  number,\n  boolean,\n  json,\n  any,\n};\n", "type Devtool = { dispose: () => void };\n\nlet currentDevtool: Devtool | undefined;\n\nexport function createDevtool(appId: string) {\n  currentDevtool?.dispose();\n\n  const container = createContainer();\n  const toggler = createToggler(toggleView);\n  const iframe = createIframe(getSrc(appId));\n\n  function onPostMessage(event: MessageEvent) {\n    if (event.source !== iframe.element.contentWindow) return;\n\n    if (event.data?.type === \"close\" && container.isVisible()) {\n      toggleView();\n    }\n  }\n\n  function onKeyDown(event: KeyboardEvent) {\n    const isToggleShortcut =\n      event.shiftKey && event.ctrlKey && event.key === \"0\";\n    const isEsc = event.key === \"Escape\" || event.key === \"Esc\";\n\n    if (isToggleShortcut || isEsc) {\n      toggleView();\n    }\n  }\n\n  function toggleView() {\n    if (container.isVisible()) {\n      container.element.style.display = \"none\";\n    } else {\n      container.element.style.display = \"block\";\n\n      // lazily render iframe on first open\n      if (!container.element.contains(iframe.element)) {\n        container.element.appendChild(iframe.element);\n      }\n    }\n  }\n\n  function dispose() {\n    container.element.remove();\n    toggler.element.remove();\n    removeEventListener(\"keydown\", onKeyDown);\n    removeEventListener(\"message\", onPostMessage);\n  }\n\n  function create() {\n    document.body.appendChild(container.element);\n    document.body.appendChild(toggler.element);\n    addEventListener(\"keydown\", onKeyDown);\n    addEventListener(\"message\", onPostMessage);\n\n    currentDevtool = {\n      dispose,\n    };\n  }\n\n  return create();\n}\n\nfunction getSrc(appId: string) {\n  const isDev = (window as any).DEV_DEVTOOL;\n\n  const src = `${isDev ? \"http://localhost:3000\" : \"https://instantdb.com\"}/_devtool?appId=${appId}`;\n  return src;\n}\n\nfunction createIframe(src: string) {\n  const element = document.createElement(\"iframe\");\n\n  element.src = src;\n  Object.assign(element.style, {\n    width: \"100%\",\n    height: \"100%\",\n    borderRadius: \"4px\",\n    backgroundColor: \"white\",\n    border: \"none\",\n  } as Partial<CSSStyleDeclaration>);\n  return { element };\n}\n\nfunction createToggler(onClick) {\n  const logoSVG = `\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 512 512\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <rect width=\"512\" height=\"512\" fill=\"black\"/>\n      <rect x=\"97.0973\" y=\"91.3297\" width=\"140\" height=\"330\" fill=\"white\"/>\n    </svg>\n  `;\n  const element = document.createElement(\"button\");\n  element.innerHTML = logoSVG;\n  Object.assign(element.style, {\n    // pos\n    position: \"fixed\",\n    bottom: \"24px\",\n    left: \"24px\",\n    height: \"32px\",\n    width: \"32px\",\n    // layout\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    // look\n    padding: \"0\",\n    margin: \"0\",\n    border: \"none\",\n    cursor: \"pointer\",\n  } as Partial<CSSStyleDeclaration>);\n  element.addEventListener(\"click\", onClick);\n  return { element };\n}\n\nfunction createContainer() {\n  const element = document.createElement(\"div\");\n  Object.assign(element.style, {\n    position: \"fixed\",\n    bottom: \"24px\",\n    right: \"24px\",\n    left: \"60px\",\n    top: \"72px\",\n    display: \"block\",\n    borderRadius: \"4px\",\n    border: \"1px #ccc solid\",\n    boxShadow: \"0px 0px 8px #00000044\",\n    backgroundColor: \"#eee\",\n    zIndex: \"999990\",\n  } as Partial<CSSStyleDeclaration>);\n  element.style.display = \"none\";\n  function isVisible() {\n    return element.style.display !== \"none\";\n  }\n  return { element, isVisible };\n}\n", "import Reactor from \"./Reactor\";\nimport {\n  tx,\n  txInit,\n  lookup,\n  getOps,\n  type TxChunk,\n  type TransactionChunk,\n} from \"./instatx\";\nimport weakHash from \"./utils/weakHash\";\nimport id from \"./utils/uuid\";\nimport IndexedDBStorage from \"./IndexedDBStorage\";\nimport WindowNetworkListener from \"./WindowNetworkListener\";\nimport { i } from \"./schema\";\nimport { createDevtool } from \"./devtool\";\n\nimport type {\n  PresenceOpts,\n  PresenceResponse,\n  PresenceSlice,\n  RoomSchemaShape,\n} from \"./presence\";\nimport type { IDatabase } from \"./coreTypes\";\nimport type {\n  Query,\n  QueryResponse,\n  PageInfoResponse,\n  Exactly,\n  InstantObject,\n  InstaQLQueryParams,\n} from \"./queryTypes\";\nimport type { AuthState, User, AuthResult } from \"./clientTypes\";\nimport type {\n  InstantQuery,\n  InstantQueryResult,\n  InstantSchema,\n  InstantEntity,\n  InstantSchemaDatabase,\n} from \"./helperTypes\";\nimport type {\n  AttrsDefs,\n  CardinalityKind,\n  DataAttrDef,\n  EntitiesDef,\n  EntitiesWithLinks,\n  EntityDef,\n  InstantGraph,\n  LinkAttrDef,\n  LinkDef,\n  LinksDef,\n  ResolveAttrs,\n  ValueTypes,\n} from \"./schemaTypes\";\n\nconst defaultOpenDevtool = true;\n\n// types\n\nexport type Config = {\n  appId: string;\n  websocketURI?: string;\n  apiURI?: string;\n  devtool?: boolean;\n};\n\nexport type ConfigWithSchema<S extends InstantGraph<any, any>> = Config & {\n  schema: S;\n};\n\nexport type TransactionResult = {\n  status: \"synced\" | \"enqueued\";\n  clientId: string;\n};\n\nexport type RoomHandle<PresenceShape, TopicsByKey> = {\n  leaveRoom: () => void;\n  publishTopic: <Key extends keyof TopicsByKey>(\n    topic: Key,\n    data: TopicsByKey[Key],\n  ) => void;\n  subscribeTopic: <Key extends keyof TopicsByKey>(\n    topic: Key,\n    onEvent: (event: TopicsByKey[Key], peer: PresenceShape) => void,\n  ) => () => void;\n  publishPresence: (data: Partial<PresenceShape>) => void;\n  getPresence: <Keys extends keyof PresenceShape>(\n    opts: PresenceOpts<PresenceShape, Keys>,\n  ) => PresenceResponse<PresenceShape, Keys>;\n  subscribePresence: <Keys extends keyof PresenceShape>(\n    opts: PresenceOpts<PresenceShape, Keys>,\n    onChange: (slice: PresenceResponse<PresenceShape, Keys>) => void,\n  ) => () => void;\n};\n\ntype AuthToken = string;\n\ntype SubscriptionState<Q, Schema, WithCardinalityInference extends boolean> =\n  | { error: { message: string }; data: undefined; pageInfo: undefined }\n  | {\n      error: undefined;\n      data: QueryResponse<Q, Schema, WithCardinalityInference>;\n      pageInfo: PageInfoResponse<Q>;\n    };\n\ntype LifecycleSubscriptionState<\n  Q,\n  Schema,\n  WithCardinalityInference extends boolean,\n> = SubscriptionState<Q, Schema, WithCardinalityInference> & {\n  isLoading: boolean;\n};\n\ntype UnsubscribeFn = () => void;\n\n// consts\n\nconst defaultConfig = {\n  apiURI: \"https://api.instantdb.com\",\n  websocketURI: \"wss://api.instantdb.com/runtime/session\",\n};\n\n// hmr\nfunction initGlobalInstantCoreStore(): Record<\n  string,\n  InstantCore<any, any, any>\n> {\n  globalThis.__instantDbStore = globalThis.__instantDbStore ?? {};\n  return globalThis.__instantDbStore;\n}\n\nconst globalInstantCoreStore = initGlobalInstantCoreStore();\n\nfunction init_experimental<\n  Schema extends InstantGraph<any, any, any>,\n  WithCardinalityInference extends boolean = true,\n>(\n  config: Config & {\n    schema: Schema;\n    cardinalityInference?: WithCardinalityInference;\n  },\n  Storage?: any,\n  NetworkListener?: any,\n): InstantCore<\n  Schema,\n  Schema extends InstantGraph<any, infer RoomSchema, any> ? RoomSchema : never,\n  WithCardinalityInference\n> {\n  return _init_internal<\n    Schema,\n    Schema extends InstantGraph<any, infer RoomSchema, any>\n      ? RoomSchema\n      : never,\n    WithCardinalityInference\n  >(config, Storage, NetworkListener);\n}\n\n// main\n\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  const db = init({ appId: \"my-app-id\" })\n *\n * // You can also provide a schema for type safety and editor autocomplete!\n *\n *  type Schema = {\n *    goals: {\n *      title: string\n *    }\n *  }\n *\n *  const db = init<Schema>({ appId: \"my-app-id\" })\n *\n */\nfunction init<Schema extends {} = {}, RoomSchema extends RoomSchemaShape = {}>(\n  config: Config,\n  Storage?: any,\n  NetworkListener?: any,\n): InstantCore<Schema, RoomSchema> {\n  return _init_internal(config, Storage, NetworkListener);\n}\n\nfunction _init_internal<\n  Schema extends {} | InstantGraph<any, any, any>,\n  RoomSchema extends RoomSchemaShape,\n  WithCardinalityInference extends boolean = false,\n>(\n  config: Config,\n  Storage?: any,\n  NetworkListener?: any,\n): InstantCore<Schema, RoomSchema, WithCardinalityInference> {\n  const existingClient = globalInstantCoreStore[config.appId] as InstantCore<\n    any,\n    RoomSchema,\n    WithCardinalityInference\n  >;\n\n  if (existingClient) {\n    return existingClient;\n  }\n\n  const reactor = new Reactor<RoomSchema>(\n    {\n      ...defaultConfig,\n      ...config,\n    },\n    Storage || IndexedDBStorage,\n    NetworkListener || WindowNetworkListener,\n  );\n\n  const client = new InstantCore<any, RoomSchema, WithCardinalityInference>(\n    reactor,\n  );\n  globalInstantCoreStore[config.appId] = client;\n\n  if (typeof window !== \"undefined\" && typeof window.location !== \"undefined\") {\n    const showDevtool =\n      // show widget by default?\n      (\"devtool\" in config ? Boolean(config.devtool) : defaultOpenDevtool) &&\n      // only run on localhost (dev env)\n      window.location.hostname === \"localhost\" &&\n      // used by dash and other internal consumers\n      !Boolean((globalThis as any)._nodevtool);\n\n    if (showDevtool) {\n      createDevtool(config.appId);\n    }\n  }\n\n  return client;\n}\n\nclass InstantCore<\n  Schema extends InstantGraph<any, any> | {} = {},\n  RoomSchema extends RoomSchemaShape = {},\n  WithCardinalityInference extends boolean = false,\n> implements IDatabase<Schema, RoomSchema, WithCardinalityInference>\n{\n  public withCardinalityInference?: WithCardinalityInference;\n  public _reactor: Reactor<RoomSchema>;\n  public auth: Auth;\n  public storage: Storage;\n\n  public tx =\n    txInit<\n      Schema extends InstantGraph<any, any> ? Schema : InstantGraph<any, any>\n    >();\n\n  constructor(reactor: Reactor<RoomSchema>) {\n    this._reactor = reactor;\n    this.auth = new Auth(this._reactor);\n    this.storage = new Storage(this._reactor);\n  }\n\n  /**\n   * Use this to write data! You can create, update, delete, and link objects\n   *\n   * @see https://instantdb.com/docs/instaml\n   *\n   * @example\n   *   // Create a new object in the `goals` namespace\n   *   const goalId = id();\n   *   db.transact(tx.goals[goalId].update({title: \"Get fit\"}))\n   *\n   *   // Update the title\n   *   db.transact(tx.goals[goalId].update({title: \"Get super fit\"}))\n   *\n   *   // Delete it\n   *   db.transact(tx.goals[goalId].delete())\n   *\n   *   // Or create an association:\n   *   todoId = id();\n   *   db.transact([\n   *    tx.todos[todoId].update({ title: 'Go on a run' }),\n   *    tx.goals[goalId].link({todos: todoId}),\n   *  ])\n   */\n  transact(\n    chunks: TransactionChunk<any, any> | TransactionChunk<any, any>[],\n  ): Promise<TransactionResult> {\n    return this._reactor.pushTx(chunks);\n  }\n\n  getLocalId(name: string): Promise<string> {\n    return this._reactor.getLocalId(name);\n  }\n\n  /**\n   * Use this to query your data!\n   *\n   * @see https://instantdb.com/docs/instaql\n   *\n   * @example\n   *  // listen to all goals\n   *  db.subscribeQuery({ goals: {} }, (resp) => {\n   *    console.log(resp.data.goals)\n   *  })\n   *\n   *  // goals where the title is \"Get Fit\"\n   *  db.subscribeQuery(\n   *    { goals: { $: { where: { title: \"Get Fit\" } } } },\n   *    (resp) => {\n   *      console.log(resp.data.goals)\n   *    }\n   *  )\n   *\n   *  // all goals, _alongside_ their todos\n   *  db.subscribeQuery({ goals: { todos: {} } }, (resp) => {\n   *    console.log(resp.data.goals)\n   *  });\n   */\n  subscribeQuery<\n    Q extends Schema extends InstantGraph<any, any>\n      ? InstaQLQueryParams<Schema>\n      : Exactly<Query, Q>,\n  >(\n    query: Q,\n    cb: (resp: SubscriptionState<Q, Schema, WithCardinalityInference>) => void,\n  ) {\n    return this._reactor.subscribeQuery(query, cb);\n  }\n\n  /**\n   * Listen for the logged in state. This is useful\n   * for deciding when to show a login screen.\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *   const unsub = db.subscribeAuth((auth) => {\n   *     if (auth.user) {\n   *     console.log('logged in as', auth.user.email)\n   *    } else {\n   *      console.log('logged out')\n   *    }\n   *  })\n   */\n  subscribeAuth(cb: (auth: AuthResult) => void): UnsubscribeFn {\n    return this._reactor.subscribeAuth(cb);\n  }\n\n  /**\n   * Join a room to publish and subscribe to topics and presence.\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   * // init\n   * const db = init();\n   * const room = db.joinRoom(roomType, roomId);\n   * // usage\n   * const unsubscribeTopic = room.subscribeTopic(\"foo\", console.log);\n   * const unsubscribePresence = room.subscribePresence({}, console.log);\n   * room.publishTopic(\"hello\", { message: \"hello world!\" });\n   * room.publishPresence({ name: \"joe\" });\n   * // later\n   * unsubscribePresence();\n   * unsubscribeTopic();\n   * room.leaveRoom();\n   */\n  joinRoom<RoomType extends keyof RoomSchema>(\n    roomType: RoomType = \"_defaultRoomType\" as RoomType,\n    roomId: string = \"_defaultRoomId\",\n  ): RoomHandle<\n    RoomSchema[RoomType][\"presence\"],\n    RoomSchema[RoomType][\"topics\"]\n  > {\n    const leaveRoom = this._reactor.joinRoom(roomId);\n\n    return {\n      leaveRoom,\n      subscribeTopic: (topic, onEvent) =>\n        this._reactor.subscribeTopic(roomId, topic, onEvent),\n      subscribePresence: (opts, onChange) =>\n        this._reactor.subscribePresence(roomType, roomId, opts, onChange),\n      publishTopic: (topic, data) =>\n        this._reactor.publishTopic({ roomType, roomId, topic, data }),\n      publishPresence: (data) =>\n        this._reactor.publishPresence(roomType, roomId, data),\n      getPresence: (opts) => this._reactor.getPresence(roomType, roomId, opts),\n    };\n  }\n\n  shutdown() {\n    delete globalInstantCoreStore[this._reactor.config.appId];\n    this._reactor.shutdown();\n  }\n\n  /**\n   * Use this for one-off queries.\n   * Returns local data if available, otherwise fetches from the server.\n   * Because we want to avoid stale data, this method will throw an error\n   * if the user is offline or there is no active connection to the server.\n   *\n   * @see https://instantdb.com/docs/instaql\n   *\n   * @example\n   *\n   *  const resp = await db.queryOnce({ goals: {} });\n   *  console.log(resp.data.goals)\n   */\n  queryOnce<\n    Q extends Schema extends InstantGraph<any, any>\n      ? InstaQLQueryParams<Schema>\n      : Exactly<Query, Q>,\n  >(\n    query: Q,\n  ): Promise<{\n    data: QueryResponse<Q, Schema, WithCardinalityInference>;\n    pageInfo: PageInfoResponse<Q>;\n  }> {\n    return this._reactor.queryOnce(query);\n  }\n}\n\n/**\n * Functions to log users in and out.\n *\n * @see https://instantdb.com/docs/auth\n */\nclass Auth {\n  constructor(private db: Reactor) {}\n\n  /**\n   * Sends a magic code to the user's email address.\n   *\n   * Once you send the magic code, see {@link auth.signInWithMagicCode} to let the\n   * user verify.\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *  db.auth.sendMagicCode({email: \"example@gmail.com\"})\n   *    .catch((err) => console.error(err.body?.message))\n   */\n  sendMagicCode = (params: { email: string }) => {\n    return this.db.sendMagicCode(params);\n  };\n  /**\n   * Verify a magic code that was sent to the user's email address.\n   *\n   * @see https://instantdb.com/docs/auth\n   *\n   * @example\n   *  db.auth.signInWithMagicCode({email: \"example@gmail.com\", code: \"123456\"})\n   *       .catch((err) => console.error(err.body?.message))\n   */\n  signInWithMagicCode = (params: { email: string; code: string }) => {\n    return this.db.signInWithMagicCode(params);\n  };\n\n  /**\n   * Sign in a user with a refresh toke\n   *\n   * @see https://instantdb.com/docs/backend#frontend-auth-sign-in-with-token\n   *\n   * @example\n   *   // Get the token from your backend\n   *   const token = await fetch('/signin', ...);\n   *   //Sign in\n   *   db.auth.signInWithToken(token);\n   */\n  signInWithToken = (token: AuthToken) => {\n    return this.db.signInWithCustomToken(token);\n  };\n\n  /**\n   * Create an authorization url to sign in with an external provider\n   *\n   * @see https://instantdb.com/docs/auth\n   *\n   * @example\n   *   // Get the authorization url from your backend\n   *   const url = db.auth.createAuthorizationUrl({\n   *     clientName: \"google\",\n   *     redirectURL: window.location.href,\n   *   });\n   *\n   *   // Put it in a sign in link\n   *   <a href={url}>Log in with Google</a>\n   */\n  createAuthorizationURL = (params: { clientName: string; redirectURL }) => {\n    return this.db.createAuthorizationURL(params);\n  };\n\n  /**\n   * Sign in with the id_token from an external provider like Google\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *   db.auth\n   *  .signInWithIdToken({\n   *    // Token from external service\n   *    idToken: id_token,\n   *    // The name you gave the client when you registered it with Instant\n   *    clientName: \"google\",\n   *    // The nonce, if any, that you used when you initiated the auth flow\n   *    // with the external service.\n   *    nonce: your_nonce\n   *  })\n   *  .catch((err) => console.error(err.body?.message));\n   *\n   */\n  signInWithIdToken = (params: {\n    idToken: string;\n    clientName: string;\n    nonce?: string | undefined | null;\n  }) => {\n    return this.db.signInWithIdToken(params);\n  };\n\n  /**\n   * Sign in with the id_token from an external provider like Google\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *   db.auth\n   *  .exchangeOAuthCode({\n   *    // code received in redirect from OAuth callback\n   *    code: code\n   *    // The PKCE code_verifier, if any, that you used when you\n   *    // initiated the auth flow\n   *    codeVerifier: your_code_verifier\n   *  })\n   *  .catch((err) => console.error(err.body?.message));\n   *\n   */\n  exchangeOAuthCode = (params: {\n    code: string;\n    codeVerifier: string | undefined | null;\n  }) => {\n    return this.db.exchangeCodeForToken(params);\n  };\n\n  /**\n   * OpenID Discovery path for use with tools like\n   * expo-auth-session that use auto-discovery of\n   * OAuth parameters.\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *   const discovery = useAutoDiscovery(\n   *     db.auth.issuerURI()\n   *   );\n   */\n  issuerURI = () => {\n    return this.db.issuerURI();\n  };\n\n  /**\n   * Sign out the current user\n   */\n  signOut = () => {\n    return this.db.signOut();\n  };\n}\n\n/**\n * Functions to manage file storage.\n */\nclass Storage {\n  constructor(private db: Reactor) {}\n\n  /**\n   * Uploads file at the provided path.\n   *\n   * @see https://instantdb.com/docs/storage\n   * @example\n   *   const [file] = e.target.files; // result of file input\n   *   const isSuccess = await db.storage.upload('photos/demo.png', file);\n   */\n  upload = (pathname: string, file: File) => {\n    return this.db.upload(pathname, file);\n  };\n\n  /**\n   * @deprecated Use `db.storage.upload` instead\n   */\n  put = this.upload;\n\n  /**\n   * Retrieves a download URL for the provided path.\n   *\n   * @see https://instantdb.com/docs/storage\n   * @example\n   *   const url = await db.storage.getDownloadUrl('photos/demo.png');\n   */\n  getDownloadUrl = (pathname: string) => {\n    return this.db.getDownloadUrl(pathname);\n  };\n\n  /**\n   * Deletes a file by path name.\n   *\n   * @see https://instantdb.com/docs/storage\n   * @example\n   *   await db.storage.delete('photos/demo.png');\n   */\n  delete = (pathname: string) => {\n    return this.db.deleteFile(pathname);\n  };\n}\n\n// util\n\nfunction coerceQuery(o: any) {\n  // stringify and parse to remove undefined values\n  return JSON.parse(JSON.stringify(o));\n}\n\n// dev\n\nexport {\n  // bada bing bada boom\n  init,\n  init_experimental,\n  _init_internal,\n  id,\n  tx,\n  txInit,\n  lookup,\n\n  // cli\n  i,\n\n  // util\n  getOps,\n  coerceQuery,\n  weakHash,\n  IndexedDBStorage,\n  WindowNetworkListener,\n  InstantCore as InstantClient,\n  Auth,\n  Storage,\n\n  // og types\n  type IDatabase,\n  type RoomSchemaShape,\n  type Query,\n  type QueryResponse,\n  type PageInfoResponse,\n  type InstantObject,\n  type Exactly,\n  type TransactionChunk,\n  type AuthState,\n  type User,\n  type AuthToken,\n  type TxChunk,\n  type SubscriptionState,\n  type LifecycleSubscriptionState,\n\n  // presence types\n  type PresenceOpts,\n  type PresenceSlice,\n  type PresenceResponse,\n\n  // new query types\n  type InstaQLQueryParams,\n  type InstantQuery,\n  type InstantQueryResult,\n  type InstantSchema,\n  type InstantEntity,\n  type InstantSchemaDatabase,\n\n  // schema types\n  type AttrsDefs,\n  type CardinalityKind,\n  type DataAttrDef,\n  type EntitiesDef,\n  type EntitiesWithLinks,\n  type EntityDef,\n  type InstantGraph,\n  type LinkAttrDef,\n  type LinkDef,\n  type LinksDef,\n  type ResolveAttrs,\n  type ValueTypes,\n};\n", "import {\n  // types\n  InstantClient,\n  Auth,\n  Storage,\n  txInit,\n  _init_internal,\n  i,\n  type AuthState,\n  type Config,\n  type Query,\n  type Exactly,\n  type TransactionChunk,\n  type LifecycleSubscriptionState,\n  type PresenceOpts,\n  type PresenceResponse,\n  type RoomSchemaShape,\n  type InstaQLQueryParams,\n  type ConfigWithSchema,\n  type IDatabase,\n  type InstantGraph,\n  type QueryResponse,\n  type PageInfoResponse,\n} from \"@instantdb/core\";\nimport {\n  KeyboardEvent,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  useSyncExternalStore,\n} from \"react\";\nimport { useQuery } from \"./useQuery\";\nimport { useTimeout } from \"./useTimeout\";\n\nexport type PresenceHandle<\n  PresenceShape,\n  Keys extends keyof PresenceShape,\n> = PresenceResponse<PresenceShape, Keys> & {\n  publishPresence: (data: Partial<PresenceShape>) => void;\n};\n\nexport type TypingIndicatorOpts = {\n  timeout?: number | null;\n  stopOnEnter?: boolean;\n  // Perf opt - `active` will always be an empty array\n  writeOnly?: boolean;\n};\n\nexport type TypingIndicatorHandle<PresenceShape> = {\n  active: PresenceShape[];\n  setActive(active: boolean): void;\n  inputProps: {\n    onKeyDown: (e: KeyboardEvent) => void;\n    onBlur: () => void;\n  };\n};\n\nexport const defaultActivityStopTimeout = 1_000;\n\nexport class InstantReactRoom<\n  Schema extends InstantGraph<any, any> | {},\n  RoomSchema extends RoomSchemaShape,\n  RoomType extends keyof RoomSchema,\n> {\n  _core: InstantClient<Schema, RoomSchema>;\n  type: RoomType;\n  id: string;\n\n  constructor(\n    _core: InstantClient<Schema, RoomSchema, any>,\n    type: RoomType,\n    id: string,\n  ) {\n    this._core = _core;\n    this.type = type;\n    this.id = id;\n  }\n\n  /**\n   * Listen for broadcasted events given a room and topic.\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   *  function App({ roomId }) {\n   *    db.room(roomType, roomId).useTopicEffect(\"chat\", (message, peer) => {\n   *      console.log(\"New message\", message, 'from', peer.name);\n   *    });\n   *\n   *    // ...\n   *  }\n   */\n  useTopicEffect = <TopicType extends keyof RoomSchema[RoomType][\"topics\"]>(\n    topic: TopicType,\n    onEvent: (\n      event: RoomSchema[RoomType][\"topics\"][TopicType],\n      peer: RoomSchema[RoomType][\"presence\"],\n    ) => any,\n  ): void => {\n    useEffect(() => {\n      const unsub = this._core._reactor.subscribeTopic(\n        this.id,\n        topic,\n        (event, peer) => {\n          onEvent(event, peer);\n        },\n      );\n\n      return unsub;\n    }, [this.id, topic]);\n  };\n\n  /**\n   * Broadcast an event to a room.\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   * function App({ roomId }) {\n   *   const publishTopic = db.room(roomType, roomId).usePublishTopic(\"clicks\");\n   *\n   *   return (\n   *     <button onClick={() => publishTopic({ ts: Date.now() })}>Click me</button>\n   *   );\n   * }\n   *\n   */\n  usePublishTopic = <Topic extends keyof RoomSchema[RoomType][\"topics\"]>(\n    topic: Topic,\n  ): ((data: RoomSchema[RoomType][\"topics\"][Topic]) => void) => {\n    useEffect(() => this._core._reactor.joinRoom(this.id), [this.id]);\n\n    const publishTopic = useCallback(\n      (data) => {\n        this._core._reactor.publishTopic({\n          roomType: this.type,\n          roomId: this.id,\n          topic,\n          data,\n        });\n      },\n      [this.id, topic],\n    );\n\n    return publishTopic;\n  };\n\n  /**\n   * Listen for peer's presence data in a room, and publish the current user's presence.\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   *  function App({ roomId }) {\n   *    const {\n   *      peers,\n   *      publishPresence\n   *    } = db.room(roomType, roomId).usePresence({ keys: [\"name\", \"avatar\"] });\n   *\n   *    // ...\n   *  }\n   */\n  usePresence = <Keys extends keyof RoomSchema[RoomType][\"presence\"]>(\n    opts: PresenceOpts<RoomSchema[RoomType][\"presence\"], Keys> = {},\n  ): PresenceHandle<RoomSchema[RoomType][\"presence\"], Keys> => {\n    const [state, setState] = useState<\n      PresenceResponse<RoomSchema[RoomType][\"presence\"], Keys>\n    >(() => {\n      return (\n        this._core._reactor.getPresence(this.type, this.id, opts) ?? {\n          peers: {},\n          isLoading: true,\n        }\n      );\n    });\n\n    useEffect(() => {\n      const unsub = this._core._reactor.subscribePresence(\n        this.type,\n        this.id,\n        opts,\n        (data) => {\n          setState(data);\n        },\n      );\n\n      return unsub;\n    }, [this.id, opts.user, opts.peers?.join(), opts.keys?.join()]);\n\n    return {\n      ...state,\n      publishPresence: (data) => {\n        this._core._reactor.publishPresence(this.type, this.id, data);\n      },\n    };\n  };\n\n  /**\n   * Publishes presence data to a room\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   *  function App({ roomId }) {\n   *    db.room(roomType, roomId).useSyncPresence({ name, avatar, color });\n   *\n   *    // ...\n   *  }\n   */\n  useSyncPresence = (\n    data: Partial<RoomSchema[RoomType][\"presence\"]>,\n    deps?: any[],\n  ): void => {\n    useEffect(() => this._core._reactor.joinRoom(this.id), [this.id]);\n    useEffect(() => {\n      return this._core._reactor.publishPresence(this.type, this.id, data);\n    }, [this.type, this.id, deps ?? JSON.stringify(data)]);\n  };\n\n  /**\n   * Manage typing indicator state\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   * @example\n   *  function App({ roomId }) {\n   *    const {\n   *      active,\n   *      setActive,\n   *      inputProps,\n   *    } = db.room(roomType, roomId).useTypingIndicator(\"chat-input\", opts);\n   *\n   *    return <input {...inputProps} />;\n   *  }\n   */\n  useTypingIndicator = (\n    inputName: string,\n    opts: TypingIndicatorOpts = {},\n  ): TypingIndicatorHandle<RoomSchema[RoomType][\"presence\"]> => {\n    const timeout = useTimeout();\n\n    const onservedPresence = this.usePresence({\n      keys: [inputName],\n    });\n\n    const active = useMemo(() => {\n      const presenceSnapshot = this._core._reactor.getPresence(\n        this.type,\n        this.id,\n      );\n\n      return opts?.writeOnly\n        ? []\n        : Object.values(presenceSnapshot?.peers ?? {}).filter(\n            (p) => p[inputName] === true,\n          );\n    }, [opts?.writeOnly, onservedPresence]);\n\n    const setActive = (isActive: boolean) => {\n      this._core._reactor.publishPresence(this.type, this.id, {\n        [inputName]: isActive,\n      } as unknown as Partial<RoomSchema[RoomType]>);\n\n      if (!isActive) return;\n\n      if (opts?.timeout === null || opts?.timeout === 0) return;\n\n      timeout.set(opts?.timeout ?? defaultActivityStopTimeout, () => {\n        this._core._reactor.publishPresence(this.type, this.id, {\n          [inputName]: null,\n        } as Partial<RoomSchema[RoomType]>);\n      });\n    };\n\n    return {\n      active,\n      setActive: (a: boolean) => {\n        setActive(a);\n      },\n      inputProps: {\n        onKeyDown: (e: KeyboardEvent) => {\n          const isEnter = opts?.stopOnEnter && e.key === \"Enter\";\n          const isActive = !isEnter;\n\n          setActive(isActive);\n        },\n        onBlur: () => {\n          setActive(false);\n        },\n      },\n    };\n  };\n}\n\nconst defaultAuthState = {\n  isLoading: true,\n  user: undefined,\n  error: undefined,\n};\n\nexport abstract class InstantReact<\n  Schema extends InstantGraph<any, any> | {} = {},\n  RoomSchema extends RoomSchemaShape = {},\n  WithCardinalityInference extends boolean = false,\n> implements IDatabase<Schema, RoomSchema, WithCardinalityInference>\n{\n  public withCardinalityInference?: WithCardinalityInference;\n  public tx =\n    txInit<\n      Schema extends InstantGraph<any, any> ? Schema : InstantGraph<any, any>\n    >();\n\n  public auth: Auth;\n  public storage: Storage;\n  public _core: InstantClient<Schema, RoomSchema, WithCardinalityInference>;\n\n  static Storage?: any;\n  static NetworkListener?: any;\n\n  constructor(config: Config | ConfigWithSchema<any>) {\n    this._core = _init_internal<Schema, RoomSchema, WithCardinalityInference>(\n      config,\n      // @ts-expect-error because TS can't resolve subclass statics\n      this.constructor.Storage,\n      // @ts-expect-error because TS can't resolve subclass statics\n      this.constructor.NetworkListener,\n    );\n    this.auth = this._core.auth;\n    this.storage = this._core.storage;\n  }\n\n  getLocalId = (name: string) => {\n    return this._core.getLocalId(name);\n  };\n\n  /**\n   * Obtain a handle to a room, which allows you to listen to topics and presence data\n   *\n   * If you don't provide a `type` or `id`, Instant will default to `_defaultRoomType` and `_defaultRoomId`\n   * as the room type and id, respectively.\n   *\n   * @see https://instantdb.com/docs/presence-and-topics\n   *\n   * @example\n   *  const {\n   *   useTopicEffect,\n   *   usePublishTopic,\n   *   useSyncPresence,\n   *   useTypingIndicator,\n   * } = db.room(roomType, roomId);\n   */\n  room<RoomType extends keyof RoomSchema>(\n    type: RoomType = \"_defaultRoomType\" as RoomType,\n    id: string = \"_defaultRoomId\",\n  ) {\n    return new InstantReactRoom<Schema, RoomSchema, RoomType>(\n      this._core,\n      type,\n      id,\n    );\n  }\n\n  /**\n   * Use this to write data! You can create, update, delete, and link objects\n   *\n   * @see https://instantdb.com/docs/instaml\n   *\n   * @example\n   *   // Create a new object in the `goals` namespace\n   *   const goalId = id();\n   *   db.transact(tx.goals[goalId].update({title: \"Get fit\"}))\n   *\n   *   // Update the title\n   *   db.transact(tx.goals[goalId].update({title: \"Get super fit\"}))\n   *\n   *   // Delete it\n   *   db.transact(tx.goals[goalId].delete())\n   *\n   *   // Or create an association:\n   *   todoId = id();\n   *   db.transact([\n   *    tx.todos[todoId].update({ title: 'Go on a run' }),\n   *    tx.goals[goalId].link({todos: todoId}),\n   *  ])\n   */\n  transact = (\n    chunks: TransactionChunk<any, any> | TransactionChunk<any, any>[],\n  ) => {\n    return this._core.transact(chunks);\n  };\n\n  /**\n   * Use this to query your data!\n   *\n   * @see https://instantdb.com/docs/instaql\n   *\n   * @example\n   *  // listen to all goals\n   *  db.useQuery({ goals: {} })\n   *\n   *  // goals where the title is \"Get Fit\"\n   *  db.useQuery({ goals: { $: { where: { title: \"Get Fit\" } } } })\n   *\n   *  // all goals, _alongside_ their todos\n   *  db.useQuery({ goals: { todos: {} } })\n   *\n   *  // skip if `user` is not logged in\n   *  db.useQuery(auth.user ? { goals: {} } : null)\n   */\n  useQuery = <\n    Q extends Schema extends InstantGraph<any, any>\n      ? InstaQLQueryParams<Schema>\n      : Exactly<Query, Q>,\n  >(\n    query: null | Q,\n  ): LifecycleSubscriptionState<Q, Schema, WithCardinalityInference> => {\n    return useQuery(this._core, query).state;\n  };\n\n  /**\n   * Listen for the logged in state. This is useful\n   * for deciding when to show a login screen.\n   *\n   * Check out the docs for an example `Login` component too!\n   *\n   * @see https://instantdb.com/docs/auth\n   * @example\n   *  function App() {\n   *    const { isLoading, user, error } = db.useAuth()\n   *    if (isLoading) {\n   *      return <div>Loading...</div>\n   *    }\n   *    if (error) {\n   *      return <div>Uh oh! {error.message}</div>\n   *    }\n   *    if (user) {\n   *      return <Main user={user} />\n   *    }\n   *    return <Login />\n   *  }\n   *\n   */\n  useAuth = (): AuthState => {\n    // We use a ref to store the result of the query.\n    // This is becuase `useSyncExternalStore` uses `Object.is`\n    // to compare the previous and next state.\n    // If we don't use a ref, the state will always be considered different, so\n    // the component will always re-render.\n    const resultCacheRef = useRef<AuthState>(\n      this._core._reactor._currentUserCached,\n    );\n\n    // Similar to `resultCacheRef`, `useSyncExternalStore` will unsubscribe\n    // if `subscribe` changes, so we use `useCallback` to memoize the function.\n    const subscribe = useCallback((cb: Function) => {\n      const unsubscribe = this._core.subscribeAuth((auth) => {\n        resultCacheRef.current = { isLoading: false, ...auth };\n        cb();\n      });\n\n      return unsubscribe;\n    }, []);\n\n    const state = useSyncExternalStore<AuthState>(\n      subscribe,\n      () => resultCacheRef.current,\n      () => defaultAuthState,\n    );\n    return state;\n  };\n\n  /**\n   * Use this for one-off queries.\n   * Returns local data if available, otherwise fetches from the server.\n   * Because we want to avoid stale data, this method will throw an error\n   * if the user is offline or there is no active connection to the server.\n   *\n   * @see https://instantdb.com/docs/instaql\n   *\n   * @example\n   *\n   *  const resp = await db.queryOnce({ goals: {} });\n   *  console.log(resp.data.goals)\n   */\n  queryOnce = <\n    Q extends Schema extends InstantGraph<any, any>\n      ? InstaQLQueryParams<Schema>\n      : Exactly<Query, Q>,\n  >(\n    query: Q,\n  ): Promise<{\n    data: QueryResponse<Q, Schema, WithCardinalityInference>;\n    pageInfo: PageInfoResponse<Q>;\n  }> => {\n    return this._core.queryOnce(query);\n  };\n}\n", "import {\n  weakHash,\n  coerceQuery,\n  type Query,\n  type Exactly,\n  type InstantClient,\n  type LifecycleSubscriptionState,\n  type InstaQLQueryParams,\n  type InstantGraph,\n} from \"@instantdb/core\";\nimport { useCallback, useRef, useSyncExternalStore } from \"react\";\n\nconst defaultState = {\n  isLoading: true,\n  data: undefined,\n  pageInfo: undefined,\n  error: undefined,\n};\n\nfunction stateForResult(result: any) {\n  return {\n    isLoading: !Boolean(result),\n    data: undefined,\n    pageInfo: undefined,\n    error: undefined,\n    ...(result ? result : {}),\n  };\n}\n\nexport function useQuery<\n  Q extends Schema extends InstantGraph<any, any>\n    ? InstaQLQueryParams<Schema>\n    : Exactly<Query, Q>,\n  Schema extends InstantGraph<any, any, any> | {},\n  WithCardinalityInference extends boolean,\n>(\n  _core: InstantClient<Schema, any, WithCardinalityInference>,\n  _query: null | Q,\n): {\n  state: LifecycleSubscriptionState<Q, Schema, WithCardinalityInference>;\n  query: any;\n} {\n  const query = _query ? coerceQuery(_query) : null;\n  const queryHash = weakHash(query);\n\n  // We use a ref to store the result of the query.\n  // This is becuase `useSyncExternalStore` uses `Object.is`\n  // to compare the previous and next state.\n  // If we don't use a ref, the state will always be considered different, so\n  // the component will always re-render.\n  const resultCacheRef = useRef<\n    LifecycleSubscriptionState<Q, Schema, WithCardinalityInference>\n  >(stateForResult(_core._reactor.getPreviousResult(query)));\n\n  // Similar to `resultCacheRef`, `useSyncExternalStore` will unsubscribe\n  // if `subscribe` changes, so we use `useCallback` to memoize the function.\n  const subscribe = useCallback(\n    (cb) => {\n      // Don't subscribe if query is null\n      if (!query) {\n        const unsubscribe = () => {};\n        return unsubscribe;\n      }\n\n      const unsubscribe = _core.subscribeQuery<Q>(query, (result) => {\n        resultCacheRef.current = {\n          isLoading: !Boolean(result),\n          data: undefined,\n          pageInfo: undefined,\n          error: undefined,\n          ...result,\n        };\n\n        cb();\n      });\n\n      return unsubscribe;\n    },\n    // Build a new subscribe function if the query changes\n    [queryHash],\n  );\n\n  const state = useSyncExternalStore<\n    LifecycleSubscriptionState<Q, Schema, WithCardinalityInference>\n  >(\n    subscribe,\n    () => resultCacheRef.current,\n    () => defaultState,\n  );\n  return { state, query };\n}\n", "import { useEffect, useRef } from \"react\";\n\nexport function useTimeout() {\n  const timeoutRef = useRef(null);\n\n  useEffect(() => {\n    clear();\n  }, []);\n\n  function set(delay: number, fn: () => void) {\n    clearTimeout(timeoutRef.current);\n    timeoutRef.current = setTimeout(fn, delay);\n  }\n\n  function clear() {\n    clearTimeout(timeoutRef.current);\n  }\n\n  return { set, clear };\n}\n", "import type { InstantGraph, RoomSchemaShape } from \"@instantdb/core\";\nimport { InstantReact } from \"./InstantReact\";\n\nexport class InstantReactWeb<\n  Schema extends InstantGraph<any, any> | {} = {},\n  RoomSchema extends RoomSchemaShape = {},\n  WithCardinalityInference extends boolean = false,\n> extends InstantReact<Schema, RoomSchema, WithCardinalityInference> {}\n", "import type {\n  // types\n  Config,\n  InstantGraph,\n  RoomSchemaShape,\n} from \"@instantdb/core\";\nimport { InstantReactWeb } from \"./InstantReactWeb\";\n\n/**\n *\n * The first step: init your application!\n *\n * Visit https://instantdb.com/dash to get your `appId` :)\n *\n * @example\n *  const db = init({ appId: \"my-app-id\" })\n *\n * // You can also provide a schema for type safety and editor autocomplete!\n *\n *  type Schema = {\n *    goals: {\n *      title: string\n *    }\n *  }\n *\n *  const db = init<Schema>({ appId: \"my-app-id\" })\n *\n */\nexport function init<\n  Schema extends {} = {},\n  RoomSchema extends RoomSchemaShape = {},\n>(config: Config) {\n  return new InstantReactWeb<Schema, RoomSchema>(config);\n}\n\nexport function init_experimental<\n  Schema extends InstantGraph<any, any, any>,\n  WithCardinalityInference extends boolean = true,\n>(\n  config: Config & {\n    schema: Schema;\n    cardinalityInference?: WithCardinalityInference;\n  },\n) {\n  return new InstantReactWeb<\n    Schema,\n    Schema extends InstantGraph<any, any, infer RoomSchema>\n      ? RoomSchema\n      : never,\n    WithCardinalityInference\n  >(config);\n}\n", "import {\n  createElement,\n  type ReactNode,\n  type MouseEvent,\n  type CSSProperties,\n} from \"react\";\nimport type { InstantReactRoom } from \"./InstantReact\";\nimport type { RoomSchemaShape } from \"@instantdb/core\";\n\nexport function Cursors<\n  RoomSchema extends RoomSchemaShape,\n  RoomType extends keyof RoomSchema,\n>({\n  as = \"div\",\n  spaceId: _spaceId,\n  room,\n  className,\n  style,\n  userCursorColor,\n  children,\n  renderCursor,\n  propagate,\n  zIndex,\n}: {\n  spaceId?: string;\n  room: InstantReactRoom<any, RoomSchema, RoomType>;\n  style?: React.CSSProperties;\n  userCursorColor?: string;\n  as?: any;\n  className?: string;\n  children?: ReactNode;\n  renderCursor?: (props: {\n    color: string;\n    presence: RoomSchema[RoomType][\"presence\"];\n  }) => ReactNode;\n  propagate?: boolean;\n  zIndex?: number;\n}) {\n  const spaceId =\n    _spaceId || `cursors-space-default--${String(room.type)}-${room.id}`;\n\n  const cursorsPresence = room.usePresence({\n    keys: [spaceId],\n  });\n\n  const fullPresence = room._core._reactor.getPresence(room.type, room.id);\n\n  function onMouseMove(e: MouseEvent) {\n    if (!propagate) {\n      e.stopPropagation();\n    }\n\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX;\n    const y = e.clientY;\n    const xPercent = ((x - rect.left) / rect.width) * 100;\n    const yPercent = ((y - rect.top) / rect.height) * 100;\n    cursorsPresence.publishPresence({\n      [spaceId]: {\n        x,\n        y,\n        xPercent,\n        yPercent,\n        color: userCursorColor,\n      },\n    } as RoomSchema[RoomType][\"presence\"]);\n  }\n\n  function onMouseOut(e: MouseEvent) {\n    cursorsPresence.publishPresence({\n      [spaceId]: undefined,\n    } as RoomSchema[RoomType][\"presence\"]);\n  }\n\n  return createElement(\n    as,\n    {\n      onMouseMove,\n      onMouseOut,\n      className,\n      style: {\n        position: \"relative\",\n        ...style,\n      },\n    },\n    [\n      children,\n      <div\n        key={spaceId}\n        style={{\n          ...absStyles,\n          ...inertStyles,\n          zIndex: zIndex !== undefined ? zIndex : defaultZ,\n        }}\n      >\n        {Object.entries(cursorsPresence.peers).map(([id, presence]) => {\n          const cursor = presence[spaceId];\n          if (!cursor) return null;\n\n          return (\n            <div\n              key={id}\n              style={{\n                ...absStyles,\n                transform: `translate(${cursor.xPercent}%, ${cursor.yPercent}%)`,\n                transformOrigin: \"0 0\",\n                transition: \"transform 100ms\",\n              }}\n            >\n              {renderCursor ? (\n                renderCursor({\n                  color: cursor.color,\n                  presence: fullPresence.peers[id],\n                })\n              ) : (\n                <Cursor {...cursor} />\n              )}\n            </div>\n          );\n        })}\n      </div>,\n    ],\n  );\n}\n\nfunction Cursor({ color }: { color: string }) {\n  const size = 35;\n  const fill = color || \"black\";\n\n  return (\n    <svg\n      style={{ height: size, width: size }}\n      viewBox={`0 0 ${size} ${size}`}\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <g\n        fill=\"rgba(0,0,0,.2)\"\n        transform=\"matrix(1, 0, 0, 1, -11.999999046325684, -8.406899452209473)\"\n      >\n        <path d=\"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z\" />\n        <path d=\"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z\" />\n      </g>\n      <g\n        fill=\"white\"\n        transform=\"matrix(1, 0, 0, 1, -11.999999046325684, -8.406899452209473)\"\n      >\n        <path d=\"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z\" />\n        <path d=\"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z\" />\n      </g>\n      <g\n        fill={fill}\n        transform=\"matrix(1, 0, 0, 1, -11.999999046325684, -8.406899452209473)\"\n      >\n        <path d=\"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z\" />\n        <path d=\"m13 10.814v11.188l2.969-2.866.428-.139h4.768z\" />\n      </g>\n    </svg>\n  );\n}\n\nconst absStyles: CSSProperties = {\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  bottom: 0,\n  right: 0,\n};\n\nconst inertStyles: CSSProperties = {\n  overflow: \"hidden\",\n  pointerEvents: \"none\",\n  userSelect: \"none\",\n};\n\nconst defaultZ = 99999;\n"],
  "mappings": "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",
  "names": ["i", "e", "t", "n", "f", "r", "o", "u", "a", "s", "l", "c", "d", "index", "set", "generatePatches", "current", "value", "proxyDraft", "ensureShallowCopy", "create", "base", "draft", "mark", "result", "lookup", "id", "triple", "_a", "context", "contexts", "i", "i", "URL", "i", "i", "i", "i", "id", "lookup", "addAttr", "tx", "_seed", "etype", "level", "attrPats", "i", "parent", "blobAttrs", "id", "query", "f", "init", "json", "id", "toJSON", "fromJSON", "f", "Storage", "__awaiter", "isOnline", "roomId", "q", "result", "hash", "triples", "store", "pageInfo", "_b", "_a", "aggregate", "_d", "_c", "r", "id", "query", "create", "defaultConfig", "Storage", "defaultConfig", "query", "import_react", "query", "unsubscribe", "import_react", "set", "id", "_a", "query", "import_react", "_jsx", "id", "_jsxs"]
}
